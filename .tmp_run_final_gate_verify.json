{
  "finalContent": "## System Vision\n\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries\n\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand\n\n## Domain Model\n\n- Kern-Entitaeten: Nutzer/Besucher, Feature, Anforderung und Iteration.\n- Beziehungen: Eine Anforderung aggregiert Features; jede Iteration verfeinert bestehende Features und kann neue ueber ein strukturiertes Delta hinzufuegen.\n- Datenkonsistenz: Feature-IDs bleiben ueber Iterationen stabil und gelten als unveraenderliche Kennungen.\n- Quellkontext (Iteration 1): Erstelle eine kompakte Landingpage fuer ein lokales Yogastudio mit Hero, Leistungen, Kursplan und Kontaktformular.\n\n## Global Business Rules\n\n- Bestehende Features duerfen waehrend der iterativen Verfeinerung nicht entfernt werden.\n- Neue Features werden nur ueber validiertes Feature-Delta-JSON akzeptiert.\n- Doppelte Features (gleiche Intention/Bezeichnung) werden deterministisch verworfen.\n- Akzeptanzkriterien aller Features muessen testbar und beobachtbar bleiben.\n\n## Functional Feature Catalogue\n\n- Zuverlaessigkeit: Ein iterativer Lauf muss ohne Verlust bereits akzeptierter Features abschliessen.\n- Determinismus: Freeze-Baseline und Feature-IDs bleiben ueber Iterationen stabil.\n- Performance: In Freeze-Mode wird Section-Patching gegenueber Vollregeneration bevorzugt.\n- Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen.\n\n### F-01: Responsive Layout\n\n**1. Purpose**\n\nResponsive Layout liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n**2. Actors**\n\nPrimär: Endnutzer. Sekundär: Systemkomponenten zur Verarbeitung.\n\n**3. Trigger**\n\nWird ausgelöst, wenn der Nutzer die zugehörige Aktion in der Oberfläche startet.\n\n**4. Preconditions**\n\nAnwendung ist verfügbar, notwendige Datenquellen sind erreichbar, Nutzerkontext ist geladen.\n\n**5. Main Flow**\n\n1. 1. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n2. 2. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n3. 3. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n4. 4. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n\n**6. Alternate Flows**\n\n1. Fehlerfall: Bei ungültiger Eingabe zeigt das System eine klare Validierungsmeldung und behält den Eingabekontext.\n\n**7. Postconditions**\n\nNach Abschluss ist der Feature-Zustand konsistent gespeichert und für Folgeprozesse verfügbar.\n\n**8. Data Impact**\n\nRelevante Entitäten werden gelesen/geschrieben; Änderungen sind nachvollziehbar und konsistent.\n\n**9. UI Impact**\n\nUI stellt den Status transparent dar und bietet klare Rückmeldungen für Erfolg und Fehler.\n\n**10. Acceptance Criteria**\n\n1. 1. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n2. 2. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n3. 3. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n\n### F-02: Sticky Navigation Menu\n\nSticky Navigation Menu liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-03: Hamburger Menu for Mobile\n\nHamburger Menu for Mobile liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-04: Hero Section with Background Image\n\nHero Section with Background Image liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-05: Hero Call‑to‑Action Button\n\nHero Call‑to‑Action Button liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-06: Services Overview Section\n\nServices Overview Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-07: Individual Service Card Component\n\nIndividual Service Card Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-08: Course Schedule Section\n\nCourse Schedule Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-09: Course Detail Modal\n\nCourse Detail Modal liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-10: Contact Form Component\n\nContact Form Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-11: Form Validation Logic\n\nForm Validation Logic liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-12: Form Submission Handling (Email Notification)\n\nForm Submission Handling (Email Notification) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-13: CAPTCHA Integration for Contact Form\n\nCAPTCHA Integration for Contact Form liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-14: Footer with Address, Hours, and Copyright\n\nFooter with Address, Hours, and Copyright liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-15: Social Media Icon Links\n\nSocial Media Icon Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-16: Google Maps Embed\n\nGoogle Maps Embed liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-17: SEO Meta Tags (Title & Description)\n\nSEO Meta Tags (Title & Description) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-18: Open Graph Tags for Social Sharing\n\nOpen Graph Tags for Social Sharing liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-19: Google Analytics Tracking Script\n\nGoogle Analytics Tracking Script liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-20: Smooth Scroll to Anchor Links\n\nSmooth Scroll to Anchor Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-21: Image Lazy Loading\n\nImage Lazy Loading liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-22: ARIA Labels for Accessibility\n\nARIA Labels for Accessibility liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-23: HTTPS Redirection\n\nHTTPS Redirection liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-24: Newsletter Signup Field\n\nTo collect email addresses from website visitors who voluntarily opt-in to receive the yoga studio's newsletter and promotional communications, building a marketing contact list.\n\n*   **Primary Actor:** Website Visitor (potential customer).\n*   **Secondary Actor:** Studio Staff/Marketing Team (indirectly, as recipients of the collected data).\n\nThe visitor scrolls to or navigates to the section of the landing page containing the newsletter signup form and decides to subscribe.\n\n*   The landing page is fully loaded and rendered in the user's browser.\n*   The newsletter signup field component is visible and interactive on the page (e.g., in the footer or a dedicated section).\n*   The backend API endpoint for handling newsletter subscriptions is available and responsive.\n\n1. The visitor views the landing page and locates the newsletter signup field, which includes a text input for an email address, a \"Subscribe\" button, and a link to the privacy policy.\n2. The visitor enters a valid email address into the input field.\n3. The visitor clicks the \"Subscribe\" button.\n4. The frontend performs immediate client-side validation to ensure the input is a syntactically valid email address (e.g., contains '@' and a domain).\n5. Upon passing client-side validation, the frontend sends an asynchronous HTTP POST request to the backend subscription endpoint (`/api/subscribe`) containing the email address and an implicit or explicit consent flag.\n6. The backend receives the request, validates the email format server-side, and checks against the existing subscriber database to prevent duplicates (based on normalized email address).\n7. If the email is valid and new, the backend creates a new subscriber record with the email, a timestamp (`subscribed_at`), a `source` field set to \"landingpage\", and a `consent_given` flag set to `true` (based on the act of submission). The record status is set to `active`.\n8. The backend returns a successful HTTP response (e.g., `200 OK` or `201 Created`).\n9. The frontend receives the successful response and updates the UI to display a success confirmation message (e.g., \"Thank you for subscribing!\") and disables or resets the input field and button.\n\n1. **A1: Invalid Email Format (Client-Side):** In step 4, the client-side validation fails. The UI displays an inline error message (e.g., \"Please enter a valid email address\") next to the input field. The form is not submitted.\n2. **A2: Invalid Email Format (Server-Side):** In step 6, server-side validation fails (e.g., malformed email passed client-side). The backend returns an error response (e.g., `400 Bad Request`). The frontend displays a generic error message (e.g., \"Invalid email address. Please try again.\").\n3. **A3: Email Already Subscribed:** In step 6, the email is found in the database with an `active` status. The backend returns a specific response (e.g., `409 Conflict`). The frontend displays a message (e.g., \"This email is already on our list.\"). The subscriber's `subscribed_at` timestamp is not updated.\n4. **A4: Backend Unavailable:** In step 5, the network request fails (timeout, 5xx error). The frontend displays a generic failure message (e.g., \"Subscription failed. Please check your connection and try again.\") and re-enables the submit button.\n\n*   A new subscriber record exists in the database with the provided email, timestamp, source, and active status, OR an existing active record is left unchanged.\n*   The user interface reflects the outcome (success message, error message, or field reset).\n*   The system has logged the subscription attempt (success or failure) for audit purposes.\n\n*   **New Data Created:** A `subscribers` table record with fields: `id` (PK), `email` (unique, indexed), `subscribed_at` (datetime), `source` (varchar), `consent_given` (boolean), `status` (varchar, e.g., 'active').\n*   **Data Updated:** No existing data is updated for a new subscription. For an already-subscribed email, no update occurs.\n*   **GDPR/Privacy:** The `consent_given` flag and `subscribed_at` timestamp must be stored to prove opt-in. The privacy policy link must be present.\n\n*   A form component is added to the landing page layout, typically in the footer or a pre-footer section.\n*   The component consists of: a label (\"Subscribe to our newsletter\"), a single-line text input (`type=\"email\"`), a primary action button (\"Subscribe\"), and a small text link to the Privacy Policy.\n*   The UI must provide clear, accessible validation feedback (ARIA live regions for errors/success).\n*   On success, the input and button are replaced by or accompanied by a persistent success message.\n*   The component is responsive and styled consistently with the studio's brand.\n\n1. **AC1:** Entering a syntactically invalid email (e.g., \"test@\") and clicking Subscribe displays an immediate, clear client-side error message and does not send a network request.\n2. **AC2:** Entering a valid, *new* email address and clicking Subscribe results in a `200`/`201` API response, the UI shows a success confirmation, and a new record with `status='active'` and `consent_given=true` is created in the database.\n3. **AC3:** Entering a valid, *already subscribed* email address and clicking Subscribe results in a `409` API response (or similar), the UI shows an appropriate \"already subscribed\" message, and no new database record is created.\n4. **AC4:** If the API is unreachable or returns a 5xx error, the UI shows a generic failure message and the user can retry.\n5. **AC5:** The subscription form is accessible via keyboard navigation and screen readers. The privacy policy link is clearly visible and navigable.\n6. **AC6:** The input field clears or is disabled after a successful subscription, preventing duplicate immediate submissions. ## Non-Functional Requirements\n10. Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen. ## Error Handling & Recovery\n11. Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n12. Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n13. Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n14. Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert. ## Deployment & Infrastructure\n15. Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n16. Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n17. Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n18. Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert. ## Definition of Done\n19. Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n20. Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n21. Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n22. Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n\n## Non-Functional Requirements\n\n## Error Handling & Recovery\n\n- Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n- Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n- Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n- Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert.\n\n## Deployment & Infrastructure\n\n- Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n- Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n- Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n- Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert.\n\n## Definition of Done\n\n- Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n- Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n- Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n- Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n",
  "iterationLog": "# Iteration Protocol\n\nGenerated: 2026-02-17T14:19:44.443Z\nTotal Iterations: 2\n\n---\n\n## Iteration 1\n\n### Questions Identified\n\n1. Welche konkreten Bild‑ und Text‑Assets (Hero‑Bild, Icons, Kurs‑Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen sollen sie bereitgestellt werden?\n2. Soll das Kontaktformular zusätzlich zu E‑Mail‑Versand eine Integration in ein CRM‑System (z. B. HubSpot, Mailchimp) erhalten, und falls ja, welche Felder sind dafür erforderlich?\n3. Welche konkreten Preis‑ und Kursdetails (z. B. Preis pro Einheit, Paket‑Preise, Trainer‑Infos) sollen im Leistungs‑ und Kursplan‑Abschnitt angezeigt werden?\n4. Gibt es Vorgaben für die Barrierefreiheit (WCAG‑Level) oder spezielle Performance‑Ziele (z. B. LCP < 2 s) für die Landingpage?\n5. Welche Erfolgskriterien (KPIs) sollen nach dem Launch gemessen werden (z. B. Besucher‑Conversion‑Rate, Formular‑Abschlussrate, durchschnittliche Sitzungsdauer)?\n\n### Best Practice Recommendations\n\n**Question 1: Welche konkreten Bild- und Text-Assets (Hero-Bild, Icons, Kurs-Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen sollen sie bereitgestellt werden?**\n\nAnswer:\nFür eine professionelle Darstellung sollten folgende Bild- und Text-Assets bereitgestellt werden:\n- Hero-Bild: 1920x1080 Pixel, JPEG oder WebP, max. 500 KB\n- Icons: SVG oder PNG, 32x32 Pixel, für verschiedene Kursarten und Social-Media-Links\n- Kurs-Bilder: 800x600 Pixel, JPEG oder WebP, max. 200 KB pro Bild\n- Schriftarten: Open-Source-Schriften wie Open Sans oder Montserrat, für eine einheitliche Typografie\n- Text-Assets: Alle Texte sollten in einem einheitlichen Format wie Markdown oder JSON vorliegen, um eine einfache Integration in die Landingpage zu ermöglichen.\n\nReasoning:\nDie Bereitstellung von Bild- und Text-Assets in geeigneten Formaten und Größen ist entscheidend für eine schnelle Ladezeit und eine professionelle Darstellung der Landingpage. Die Verwendung von Open-Source-Schriften und einheitlichen Text-Assets erleichtert die Wartung und Aktualisierung der Inhalte.\n\nConcrete Implementation:\nIm Abschnitt \"System Boundaries & Operating Model\" sollte ein Unterpunkt \"Bild- und Text-Assets\" hinzugefügt werden, der die Anforderungen an die Assets auflistet. Beispiel:\n\"System Boundaries & Operating Model\n- ...\n- Bild- und Text-Assets:\n  - Hero-Bild: 1920x1080 Pixel, JPEG oder WebP, max. 500 KB\n  - Icons: SVG oder PNG, 32x32 Pixel\n  - Kurs-Bilder: 800x600 Pixel, JPEG oder WebP, max. 200 KB pro Bild\n  - Schriftarten: Open-Source-Schriften wie Open Sans oder Montserrat\n  - Text-Assets: Markdown oder JSON\"\n\n**Question 2: Soll das Kontaktformular zusätzlich zu E-Mail-Versand eine Integration in ein CRM-System (z. B. HubSpot, Mailchimp) erhalten, und falls ja, welche Felder sind dafür erforderlich?**\n\nAnswer:\nJa, eine Integration in ein CRM-System wie HubSpot oder Mailchimp ist empfehlenswert, um die Kontaktdaten der Besucher zu speichern und für zukünftige Marketing-Kampagnen zu nutzen. Die folgenden Felder sollten für die Integration erforderlich sein:\n- Name\n- E-Mail-Adresse\n- Telefonnummer (optional)\n- Nachrichtentext\n- Checkbox für den Newsletter-Bezug\n\nReasoning:\nDie Integration in ein CRM-System ermöglicht eine zentrale Verwaltung der Kontaktdaten und eine einfache Auswertung der Besucher-Interaktionen. Die Erfassung von Telefonnummern und Nachrichtentexten kann für die Nachverfolgung von Anfragen und die Verbesserung des Kundenservices hilfreich sein.\n\nConcrete Implementation:\nIm Abschnitt \"Functional Feature Catalogue\" sollte das Feature \"Kontaktformular\" um die Integration in ein CRM-System erweitert werden. Beispiel:\n\"F-04 – Kontaktformular\n- ...\n- Integration in ein CRM-System (z. B. HubSpot, Mailchimp)\n  - Erforderliche Felder: Name, E-Mail-Adresse, Telefonnummer (optional), Nachrichtentext, Checkbox für den Newsletter-Bezug\"\n\n**Question 3: Welche konkreten Preis- und Kursdetails (z. B. Preis pro Einheit, Paket-Preise, Trainer-Infos) sollen im Leistungs- und Kursplan-Abschnitt angezeigt werden?**\n\nAnswer:\nFolgende Preis- und Kursdetails sollten im Leistungs- und Kursplan-Abschnitt angezeigt werden:\n- Preis pro Einheit (z. B. 10 € pro Stunde)\n- Paket-Preise (z. B. 50 € pro Monat für 4 Einheiten)\n- Trainer-Infos (z. B. Name, Bild, Beschreibung)\n- Kursbeschreibung und -ziele\n- Kursdauer und -frequenz\n\nReasoning:\nDie Anzeige von Preis- und Kursdetails ermöglicht es den Besuchern, sich schnell und einfach über die Angebote des Yogastudios zu informieren und eine fundierte Entscheidung über eine Buchung zu treffen.\n\nConcrete Implementation:\nIm Abschnitt \"Functional Feature Catalogue\" sollten die Features \"Leistungen-Section\" und \"Kursplan-Anzeige\" um die Anzeige von Preis- und Kursdetails erweitert werden. Beispiel:\n\"F-02 – Leistungen-Section\n- ...\n- Preis- und Kursdetails:\n  - Preis pro Einheit\n  - Paket-Preise\n  - Trainer-Infos\n  - Kursbeschreibung und -ziele\n  - Kursdauer und -frequenz\nF-03 – Kursplan-Anzeige\n- ...\n- Preis- und Kursdetails:\n  - Preis pro Einheit\n  - Paket-Preise\n  - Trainer-Infos\n  - Kursbeschreibung und -ziele\n  - Kursdauer und -frequenz\"\n\n**Question 4: Gibt es Vorgaben für die Barrierefreiheit (WCAG-Level) oder spezielle Performance-Ziele (z. B. LCP < 2 s) für die Landingpage?**\n\nAnswer:\nJa, die Landingpage sollte den WCAG-Level AA erfüllen, um eine gute Barrierefreiheit zu gewährleisten. Darüber hinaus sollten folgende Performance-Ziele angestrebt werden:\n- LCP (Largest Contentful Paint) < 2 s\n- FID (First Input Delay) < 100 ms\n- CLS (Cumulative Layout Shift) < 0,1\n\nReasoning:\nDie Erfüllung der WCAG-Level AA und die Einhaltung der Performance-Ziele gewährleisten eine gute Nutzererfahrung und eine hohe Zugänglichkeit der Landingpage.\n\nConcrete Implementation:\nIm Abschnitt \"Non-Functional Requirements\" sollten die Anforderungen an die Barrierefreiheit und Performance hinzugefügt werden. Beispiel:\n\"Non-Functional Requirements\n- ...\n- Barrierefreiheit: WCAG-Level AA\n- Performance:\n  - LCP (Largest Contentful Paint) < 2 s\n  - FID (First Input Delay) < 100 ms\n  - CLS (Cumulative Layout Shift) < 0,1\"\n\n**Question 5: Welche Erfolgskriterien (KPIs) sollen nach dem Launch gemessen werden (z. B. Besucher-Conversion-Rate, Formular-Abschlussrate, durchschnittliche Sitzungsdauer)?**\n\nAnswer:\nFolgende Erfolgskriterien sollten nach dem Launch gemessen werden:\n- Besucher-Conversion-Rate (z. B. Anzahl der Buchungen pro 100 Besucher)\n- Formular-Abschlussrate (z. B. Anzahl der abgeschlossenen Formulare pro 100 Besucher)\n- Durchschnittliche Sitzungsdauer (z. B. Zeit, die Besucher auf der Landingpage verbringen)\n- Bounce-Rate (z. B. Anzahl der Besucher, die die Landingpage sofort verlassen)\n- Seitenaufrufe pro Sitzung (z. B. Anzahl der Seiten, die Besucher pro Sitzung aufrufen)\n\nReasoning:\nDie Messung dieser Erfolgskriterien ermöglicht es, die Effektivität der Landingpage zu bewerten und gezielte Optimierungen vorzunehmen, um die Conversion-Rate und die Nutzererfahrung zu verbessern.\n\nConcrete Implementation:\nIm Abschnitt \"Definition of Done\" sollten die Erfolgskriterien hinzugefügt werden. Beispiel:\n\"Definition of Done\n- ...\n- Erfolgskriterien:\n  - Besucher-Conversion-Rate\n  - Formular-Abschlussrate\n  - Durchschnittliche Sitzungsdauer\n  - Bounce-Rate\n  - Seitenaufrufe pro Sitzung\"\n\n---\n\n## Iteration 2\n\n### JSON Structured Section Update Applied\n\n- Mode: JSON Structured Update\n- Section: nonFunctional\n- Feedback: **Question 1: Welche konkreten Bild- und Text-Assets (Hero-Bild, Icons, Kurs-Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen soll...\n\n### Best Practice Recommendations\n\n**Question 1: Identify the top unresolved product scope risk.**\n\nAnswer:\nThe top unresolved product scope risk is the lack of a clear definition of the iterative development process and the potential for feature creep. The PRD mentions an iterative approach but does not provide detailed information on how the process will be managed, including how requirements will be prioritized, and how changes will be handled. This lack of clarity could lead to scope creep, delays, and cost overruns.\n\nReasoning:\nA well-defined iterative development process is essential for managing product scope and ensuring that the development team is working on the most valuable features. Without a clear process, the project may experience delays, and the final product may not meet the stakeholders' expectations.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the iterative development process, including:\n\n* A clear definition of the iteration cycle and the milestones that will be used to measure progress\n* A description of how requirements will be prioritized and how changes will be handled\n* A definition of the roles and responsibilities of the stakeholders and the development team\n* A description of the communication plan and how stakeholders will be informed of progress and changes\n\nSection: **System Vision** and **System Boundaries** should be updated to include a detailed description of the iterative development process.\n\n**Question 2: Identify the top unresolved UX risk.**\n\nAnswer:\nThe top unresolved UX risk is the lack of accessibility features in the PRD. While the PRD mentions that the website should be responsive and work on different devices, it does not provide any information on how the website will be made accessible to users with disabilities.\n\nReasoning:\nAccessibility is a critical aspect of UX, and neglecting it can lead to a poor user experience for users with disabilities. Moreover, accessibility is a legal requirement in many countries, and neglecting it can lead to legal issues.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the accessibility features that will be implemented, including:\n\n* A description of how the website will be made accessible to users with visual, auditory, motor, or cognitive disabilities\n* A definition of the accessibility standards that will be followed (e.g., WCAG 2.1)\n* A description of how accessibility will be tested and validated\n\nSection: **Domain Model** and **Global Business Rules** should be updated to include a detailed description of the accessibility features.\n\n**Question 3: Identify the top unresolved data/operational risk.**\n\nAnswer:\nThe top unresolved data/operational risk is the lack of a clear data management plan. The PRD mentions that the website will collect user data, but it does not provide any information on how the data will be stored, processed, and protected.\n\nReasoning:\nData management is a critical aspect of operational risk, and neglecting it can lead to data breaches, fines, and reputational damage. Moreover, data protection is a legal requirement in many countries, and neglecting it can lead to legal issues.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the data management plan, including:\n\n* A description of the types of data that will be collected and how they will be used\n* A definition of the data storage and processing procedures\n* A description of the data protection measures that will be implemented (e.g., encryption, access controls)\n* A description of how data breaches will be handled and notified\n\nSection: **Data Impact** and **Security** should be updated to include a detailed description of the data management plan.\n\nOpen Points, Gaps, or unresolved areas in the PRD:\n\n* The PRD does not provide a clear definition of the iterative development process.\n* The PRD does not provide any information on accessibility features.\n* The PRD does not provide a clear data management plan.\n* The PRD does not provide any information on how the website will be tested and validated.\n* The PRD does not provide any information on how the website will be maintained and updated after launch.\n\nThese open points, gaps, or unresolved areas should be addressed in the next PRD revision to ensure that the project is well-planned and executed.\n",
  "iterations": [
    {
      "iterationNumber": 1,
      "generatorOutput": "# YogaStudio Landingpage – Produktanforderungsdokument (PRD)\n\n## System Vision\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries & Operating Model\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand  \n\n## Functional Feature Catalogue\n\n### F-01 – Hero‑Section\n**Feature Name:** Hero‑Bereich mit Bild, Titel, Untertitel und Call‑to‑Action (CTA)\n\n1. **Purpose** – Erzeugt den ersten visuellen Eindruck, kommuniziert das Studio‑Branding und leitet den Besucher zu den wichtigsten Aktionen (z. B. Kursplan ansehen).  \n2. **Actors** – Besucher (alle Geräte).  \n3. **Trigger** – Seitenaufruf.  \n4. **Preconditions** – Bild‑ und Text‑Assets sind im CMS/Dateisystem hinterlegt.  \n5. **Main Flow**  \n   1. Seite lädt, Hero‑Bild wird angezeigt.  \n   2. Titel und Untertitel werden überlagert.  \n   3. CTA‑Button („Kursplan ansehen“) ist sichtbar.  \n   4. Besucher klickt CTA → Browser scrollt zum Kursplan‑Abschnitt.  \n6. **Alternate Flows**  \n   - Bild‑Ladefehler → Fallback‑Bild wird angezeigt.  \n   - CTA‑Link nicht definiert → Button wird deaktiviert.  \n7. **Postconditions** – Hero‑Section ist sichtbar; ggf. Scroll‑Position geändert.  \n8. **Data Impact** – Keine Datenänderung.  \n9. **UI Impact** – Vollbild‑Div, responsives Hintergrundbild, überlagerter Text, animierter CTA‑Button.  \n10. **Acceptance Criteria**  \n    - Bild lädt innerhalb von 2 s bei 3G.  \n    - Text ist lesbar (Kontrast‑Ratio ≥ 4.5:1).  \n    - CTA‑Button scrollt korrekt zum Kursplan.  \n\n### F-02 – Leistungen‑Section\n**Feature Name:** Darstellung der angebotenen Yoga‑Leistungen\n\n1. **Purpose** – Informiert Besucher über Kursarten, Preise und Besonderheiten.  \n2. **Actors** – Besucher.  \n3. **Trigger** – Seitenaufruf, automatischer Render nach Hero.  \n4. **Preconditions** – Leistungs‑Daten (Titel, Beschreibung, Preis, Icon) sind im JSON/Headless‑CMS hinterlegt.  \n5. **Main Flow**  \n   1. System rendert ein Raster (2‑3 Spalten) mit einzelnen Leistungskarten.  \n   2. Jede Karte zeigt Icon, Titel, Kurzbeschreibung, Preis.  \n   3. Optional: „Mehr erfahren“-Link öffnet Modal mit Detailtext.  \n6. **Alternate Flows**  \n   - Keine Leistungen definiert → Platzhalter‑Text „Bald verfügbar“.  \n   - Bild‑/Icon‑Ladefehler → generisches Icon wird verwendet.  \n7. **Postconditions** – Leistungen sind sichtbar; ggf. Modal geöffnet.  \n8. **Data Impact** – Keine Datenänderung.  \n9. **UI Impact** – Karten‑Layout, responsive Grid, Modal‑Komponente.  \n10. **Acceptance Criteria**  \n    - Alle definierten Leistungen werden korrekt angezeigt.  \n    - Modal öffnet und schließt ohne Layout‑Shift.  \n    - Preise sind im richtigen Währungsformat (€ xx,xx).  \n\n### F-03 – Kursplan‑Anzeige\n**Feature Name:** Interaktive Übersicht des wöchentlichen Kursplans\n\n1. **Purpose** – Gibt Besuchern einen schnellen Überblick über Kurszeiten, Trainer und verfügbare Plätze.  \n2. **Actors** – Besucher.  \n3. **Trigger** – Besucher scrollt zum Kursplan‑Abschnitt oder klickt CTA im Hero.  \n4. **Preconditions** – Kursplan‑Daten (Wochentag, Zeit, Kursname, Trainer, Max‑Teilnehmer) liegen als JSON/CSV vor.  \n5. **Main Flow**  \n   1. System lädt Kursplan‑Daten via AJAX (falls statisch, direkt eingebettet).  \n   2. Daten werden in einer tabellarischen Ansicht (Tage × Zeiten) dargestellt.  \n   3. Jede Zelle enthält Kursname, Trainer‑Name und ein „Jetzt buchen“-Button (optional).  \n   4. Besucher kann per Klick auf einen Kurs weitere Details (Beschreibung, Dauer) in einem Tooltip/Modal sehen.  \n6. **Alternate Flows**  \n   - Daten‑Load‑Fehler → Fehlermeldung „Kursplan konnte nicht geladen werden“.  \n   - Keine Kurse für einen Tag → Zelle zeigt „Kein Kurs“.  \n7. **Postconditions** – Kursplan ist sichtbar; ggf. Tooltip/Modal geöffnet.  \n8. **Data Impact** – Keine Persistenz; nur Lesezugriff.  \n9. **UI Impact** – Responsive Tabelle, Hover‑/Click‑Interaktionen, ggf. Buchungs‑Button (führt zu externem Buchungssystem).  \n10. **Acceptance Criteria**  \n    - Kursplan lädt innerhalb von 1 s bei 4G.  \n    - Alle Kurse des aktuellen Monats werden korrekt angezeigt.  \n    - Tooltip/Modal zeigt vollständige Kursdetails ohne Überlappungs‑Probleme.  \n\n### F-04 – Kontaktformular\n**Feature Name:** Formular für Anfragen und Newsletter‑Anmeldung\n\n1. **Purpose** – Ermöglicht Besuchern, direkt Kontakt aufzunehmen oder sich für den Newsletter anzumelden.  \n2. **Actors** – Besucher.  \n3. **Trigger** – Besucher klickt „Kontakt aufnehmen“ oder scrollt zum Formular‑Abschnitt.  \n4. **Preconditions** – Formular‑Endpoint (E‑Mail‑Service oder Formspree) ist konfiguriert; reCAPTCHA‑Schlüssel vorhanden (optional).  \n5. **Main Flow**  \n   1. Besucher füllt Felder: Name, E‑Mail, Betreff, Nachricht.  \n   2. Optional: Checkbox „Newsletter abonnieren“.  \n   3. Besucher klickt „Absenden“.  \n   4. Frontend validiert Eingaben (Pflichtfelder, E‑Mail‑Format).  \n   5. Bei Erfolg wird POST an Endpoint gesendet.  \n   6. UI zeigt Success‑Message „Ihre Nachricht wurde gesendet“.  \n6. **Alternate Flows**  \n   - Validierungsfehler → Feld‑bezogene Fehlermeldungen.  \n   - Netzwerk‑Fehler → Fehlermeldung „Nachricht konnte nicht gesendet werden, bitte später erneut versuchen“.  \n   - reCAPTCHA‑Fehler → Hinweis „Bitte bestätigen Sie, dass Sie kein Bot sind“.  \n7. **Postconditions** – Nachricht wird an Studio‑E‑Mail weitergeleitet; optional Newsletter‑Eintrag gespeichert.  \n8. **Data Impact** – Eingabedaten werden an externen Service übermittelt; keine lokale Speicherung.  \n9. **UI Impact** – Formular‑Komponente, Fehlermeldungs‑Anzeige, Success‑Banner, ggf. reCAPTCHA‑Widget.  \n10. **Acceptance Criteria**  \n    - Alle Pflichtfelder werden geprüft.  \n    - Erfolgreiche Submission liefert Success‑Message innerhalb von 2 s.  \n    - Fehlermeldungen sind klar und lokalisiert (Deutsch).  \n\n---\n\n## Feature Delta (JSON)\n```json\n{\n  \"addedFeatures\": [],\n  \"updatedFeatures\": []\n}\n```\n\n## Questions for Improvement\n1. Welche konkreten Bild‑ und Text‑Assets (Hero‑Bild, Icons, Kurs‑Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen sollen sie bereitgestellt werden?  \n2. Soll das Kontaktformular zusätzlich zu E‑Mail‑Versand eine Integration in ein CRM‑System (z. B. HubSpot, Mailchimp) erhalten, und falls ja, welche Felder sind dafür erforderlich?  \n3. Welche konkreten Preis‑ und Kursdetails (z. B. Preis pro Einheit, Paket‑Preise, Trainer‑Infos) sollen im Leistungs‑ und Kursplan‑Abschnitt angezeigt werden?  \n4. Gibt es Vorgaben für die Barrierefreiheit (WCAG‑Level) oder spezielle Performance‑Ziele (z. B. LCP < 2 s) für die Landingpage?  \n5. Welche Erfolgskriterien (KPIs) sollen nach dem Launch gemessen werden (z. B. Besucher‑Conversion‑Rate, Formular‑Abschlussrate, durchschnittliche Sitzungsdauer)?",
      "answererOutput": "**Question 1: Welche konkreten Bild- und Text-Assets (Hero-Bild, Icons, Kurs-Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen sollen sie bereitgestellt werden?**\n\nAnswer:\nFür eine professionelle Darstellung sollten folgende Bild- und Text-Assets bereitgestellt werden:\n- Hero-Bild: 1920x1080 Pixel, JPEG oder WebP, max. 500 KB\n- Icons: SVG oder PNG, 32x32 Pixel, für verschiedene Kursarten und Social-Media-Links\n- Kurs-Bilder: 800x600 Pixel, JPEG oder WebP, max. 200 KB pro Bild\n- Schriftarten: Open-Source-Schriften wie Open Sans oder Montserrat, für eine einheitliche Typografie\n- Text-Assets: Alle Texte sollten in einem einheitlichen Format wie Markdown oder JSON vorliegen, um eine einfache Integration in die Landingpage zu ermöglichen.\n\nReasoning:\nDie Bereitstellung von Bild- und Text-Assets in geeigneten Formaten und Größen ist entscheidend für eine schnelle Ladezeit und eine professionelle Darstellung der Landingpage. Die Verwendung von Open-Source-Schriften und einheitlichen Text-Assets erleichtert die Wartung und Aktualisierung der Inhalte.\n\nConcrete Implementation:\nIm Abschnitt \"System Boundaries & Operating Model\" sollte ein Unterpunkt \"Bild- und Text-Assets\" hinzugefügt werden, der die Anforderungen an die Assets auflistet. Beispiel:\n\"System Boundaries & Operating Model\n- ...\n- Bild- und Text-Assets:\n  - Hero-Bild: 1920x1080 Pixel, JPEG oder WebP, max. 500 KB\n  - Icons: SVG oder PNG, 32x32 Pixel\n  - Kurs-Bilder: 800x600 Pixel, JPEG oder WebP, max. 200 KB pro Bild\n  - Schriftarten: Open-Source-Schriften wie Open Sans oder Montserrat\n  - Text-Assets: Markdown oder JSON\"\n\n**Question 2: Soll das Kontaktformular zusätzlich zu E-Mail-Versand eine Integration in ein CRM-System (z. B. HubSpot, Mailchimp) erhalten, und falls ja, welche Felder sind dafür erforderlich?**\n\nAnswer:\nJa, eine Integration in ein CRM-System wie HubSpot oder Mailchimp ist empfehlenswert, um die Kontaktdaten der Besucher zu speichern und für zukünftige Marketing-Kampagnen zu nutzen. Die folgenden Felder sollten für die Integration erforderlich sein:\n- Name\n- E-Mail-Adresse\n- Telefonnummer (optional)\n- Nachrichtentext\n- Checkbox für den Newsletter-Bezug\n\nReasoning:\nDie Integration in ein CRM-System ermöglicht eine zentrale Verwaltung der Kontaktdaten und eine einfache Auswertung der Besucher-Interaktionen. Die Erfassung von Telefonnummern und Nachrichtentexten kann für die Nachverfolgung von Anfragen und die Verbesserung des Kundenservices hilfreich sein.\n\nConcrete Implementation:\nIm Abschnitt \"Functional Feature Catalogue\" sollte das Feature \"Kontaktformular\" um die Integration in ein CRM-System erweitert werden. Beispiel:\n\"F-04 – Kontaktformular\n- ...\n- Integration in ein CRM-System (z. B. HubSpot, Mailchimp)\n  - Erforderliche Felder: Name, E-Mail-Adresse, Telefonnummer (optional), Nachrichtentext, Checkbox für den Newsletter-Bezug\"\n\n**Question 3: Welche konkreten Preis- und Kursdetails (z. B. Preis pro Einheit, Paket-Preise, Trainer-Infos) sollen im Leistungs- und Kursplan-Abschnitt angezeigt werden?**\n\nAnswer:\nFolgende Preis- und Kursdetails sollten im Leistungs- und Kursplan-Abschnitt angezeigt werden:\n- Preis pro Einheit (z. B. 10 € pro Stunde)\n- Paket-Preise (z. B. 50 € pro Monat für 4 Einheiten)\n- Trainer-Infos (z. B. Name, Bild, Beschreibung)\n- Kursbeschreibung und -ziele\n- Kursdauer und -frequenz\n\nReasoning:\nDie Anzeige von Preis- und Kursdetails ermöglicht es den Besuchern, sich schnell und einfach über die Angebote des Yogastudios zu informieren und eine fundierte Entscheidung über eine Buchung zu treffen.\n\nConcrete Implementation:\nIm Abschnitt \"Functional Feature Catalogue\" sollten die Features \"Leistungen-Section\" und \"Kursplan-Anzeige\" um die Anzeige von Preis- und Kursdetails erweitert werden. Beispiel:\n\"F-02 – Leistungen-Section\n- ...\n- Preis- und Kursdetails:\n  - Preis pro Einheit\n  - Paket-Preise\n  - Trainer-Infos\n  - Kursbeschreibung und -ziele\n  - Kursdauer und -frequenz\nF-03 – Kursplan-Anzeige\n- ...\n- Preis- und Kursdetails:\n  - Preis pro Einheit\n  - Paket-Preise\n  - Trainer-Infos\n  - Kursbeschreibung und -ziele\n  - Kursdauer und -frequenz\"\n\n**Question 4: Gibt es Vorgaben für die Barrierefreiheit (WCAG-Level) oder spezielle Performance-Ziele (z. B. LCP < 2 s) für die Landingpage?**\n\nAnswer:\nJa, die Landingpage sollte den WCAG-Level AA erfüllen, um eine gute Barrierefreiheit zu gewährleisten. Darüber hinaus sollten folgende Performance-Ziele angestrebt werden:\n- LCP (Largest Contentful Paint) < 2 s\n- FID (First Input Delay) < 100 ms\n- CLS (Cumulative Layout Shift) < 0,1\n\nReasoning:\nDie Erfüllung der WCAG-Level AA und die Einhaltung der Performance-Ziele gewährleisten eine gute Nutzererfahrung und eine hohe Zugänglichkeit der Landingpage.\n\nConcrete Implementation:\nIm Abschnitt \"Non-Functional Requirements\" sollten die Anforderungen an die Barrierefreiheit und Performance hinzugefügt werden. Beispiel:\n\"Non-Functional Requirements\n- ...\n- Barrierefreiheit: WCAG-Level AA\n- Performance:\n  - LCP (Largest Contentful Paint) < 2 s\n  - FID (First Input Delay) < 100 ms\n  - CLS (Cumulative Layout Shift) < 0,1\"\n\n**Question 5: Welche Erfolgskriterien (KPIs) sollen nach dem Launch gemessen werden (z. B. Besucher-Conversion-Rate, Formular-Abschlussrate, durchschnittliche Sitzungsdauer)?**\n\nAnswer:\nFolgende Erfolgskriterien sollten nach dem Launch gemessen werden:\n- Besucher-Conversion-Rate (z. B. Anzahl der Buchungen pro 100 Besucher)\n- Formular-Abschlussrate (z. B. Anzahl der abgeschlossenen Formulare pro 100 Besucher)\n- Durchschnittliche Sitzungsdauer (z. B. Zeit, die Besucher auf der Landingpage verbringen)\n- Bounce-Rate (z. B. Anzahl der Besucher, die die Landingpage sofort verlassen)\n- Seitenaufrufe pro Sitzung (z. B. Anzahl der Seiten, die Besucher pro Sitzung aufrufen)\n\nReasoning:\nDie Messung dieser Erfolgskriterien ermöglicht es, die Effektivität der Landingpage zu bewerten und gezielte Optimierungen vorzunehmen, um die Conversion-Rate und die Nutzererfahrung zu verbessern.\n\nConcrete Implementation:\nIm Abschnitt \"Definition of Done\" sollten die Erfolgskriterien hinzugefügt werden. Beispiel:\n\"Definition of Done\n- ...\n- Erfolgskriterien:\n  - Besucher-Conversion-Rate\n  - Formular-Abschlussrate\n  - Durchschnittliche Sitzungsdauer\n  - Bounce-Rate\n  - Seitenaufrufe pro Sitzung\"",
      "questions": [
        "Welche konkreten Bild‑ und Text‑Assets (Hero‑Bild, Icons, Kurs‑Bilder) stehen bereits zur Verfügung, und in welchen Formaten/Größen sollen sie bereitgestellt werden?",
        "Soll das Kontaktformular zusätzlich zu E‑Mail‑Versand eine Integration in ein CRM‑System (z. B. HubSpot, Mailchimp) erhalten, und falls ja, welche Felder sind dafür erforderlich?",
        "Welche konkreten Preis‑ und Kursdetails (z. B. Preis pro Einheit, Paket‑Preise, Trainer‑Infos) sollen im Leistungs‑ und Kursplan‑Abschnitt angezeigt werden?",
        "Gibt es Vorgaben für die Barrierefreiheit (WCAG‑Level) oder spezielle Performance‑Ziele (z. B. LCP < 2 s) für die Landingpage?",
        "Welche Erfolgskriterien (KPIs) sollen nach dem Launch gemessen werden (z. B. Besucher‑Conversion‑Rate, Formular‑Abschlussrate, durchschnittliche Sitzungsdauer)?"
      ],
      "mergedPRD": "## System Vision\n\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries\n\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand\n\n## Domain Model\n\n- Kern-Entitaeten: Nutzer/Besucher, Feature, Anforderung und Iteration.\n- Beziehungen: Eine Anforderung aggregiert Features; jede Iteration verfeinert bestehende Features und kann neue ueber ein strukturiertes Delta hinzufuegen.\n- Datenkonsistenz: Feature-IDs bleiben ueber Iterationen stabil und gelten als unveraenderliche Kennungen.\n- Quellkontext (Iteration 1): Erstelle eine kompakte Landingpage fuer ein lokales Yogastudio mit Hero, Leistungen, Kursplan und Kontaktformular.\n\n## Global Business Rules\n\n- Bestehende Features duerfen waehrend der iterativen Verfeinerung nicht entfernt werden.\n- Neue Features werden nur ueber validiertes Feature-Delta-JSON akzeptiert.\n- Doppelte Features (gleiche Intention/Bezeichnung) werden deterministisch verworfen.\n- Akzeptanzkriterien aller Features muessen testbar und beobachtbar bleiben.\n\n## Functional Feature Catalogue\n\n### F-01: Responsive Layout\n\n1. Purpose\nTo ensure the landing page renders optimally and maintains full functionality across a defined set of viewport sizes (mobile, tablet, desktop), thereby providing a consistent user experience, reducing bounce rates, and supporting conversion goals regardless of the access device.\n\n2. Actors\n- End User (visitor to the Yogastudio landing page)\n- Frontend Developer (implementing the layout logic)\n- QA Tester (validating responsiveness)\n\n3. Trigger\nA user accesses the landing page URL via a web browser on any device (desktop, tablet, or mobile phone).\n\n4. Preconditions\n- The HTML document includes a valid `<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">` tag.\n- The CSS architecture is built using a mobile-first approach with defined breakpoints.\n- All page assets (images, icons) are available in suitable resolutions or use vector formats (SVG).\n\n5. Main Flow\n1.  Upon page load, the browser's rendering engine reads the viewport meta tag and establishes the initial layout viewport width equal to the device's screen width.\n2.  The CSS is parsed and applied. The base (mobile) styles are applied first, targeting a viewport width of 0px and up.\n3.  The browser evaluates the current viewport width against the following predefined CSS media query breakpoints in ascending order:\n    a. `@media (min-width: 480px)` – Applies styles for large mobile phones.\n    b. `@media (min-width: 768px)` – Applies styles for tablets (portrait and landscape) and small laptops. The main navigation menu switches from a vertical/hamburger layout to a horizontal top bar. The Hero section's text and CTA button stack vertically. The \"Leistungen\" and \"Kursplan\" sections transition from a single-column stack to a two-column grid.\n    c. `@media (min-width: 1024px)` – Applies styles for standard desktop monitors. The main content container reaches a maximum fixed width (e.g., 1200px) and centers. The \"Kursplan\" table becomes fully visible without horizontal scrolling. The \"Kontakt\" form and map may appear side-by-side.\n    d. `@media (min-width: 1280px)` – Applies styles for large desktop screens, increasing whitespace and maximum container width slightly.\n4.  For all image assets, the `srcset` attribute and CSS `max-width: 100%; height: auto;` rules are applied to prevent overflow and serve appropriately sized images based on viewport density and width.\n5.  The responsive navigation toggle (hamburger icon) is conditionally rendered and functional only at viewport widths below the 768px breakpoint. Clicking it toggles the visibility of the navigation menu overlay.\n\n6. Alternate Flows\n- **A1: JavaScript Disabled.** If the user has JavaScript disabled, the responsive navigation menu (hamburger) remains non-functional. The mobile navigation fallback is a simple vertical list of links always visible below the studio logo, ensuring core navigation remains accessible.\n- **A2: Extreme Aspect Ratio / Very Tall Mobile Screen.** On a very tall, narrow mobile screen (e.g., 9:21 aspect ratio), the Hero section's background image may be cropped more significantly. The CSS `background-position: center;` and `background-size: cover;` rules ensure the focal point remains centered, and the text container maintains a minimum height for readability.\n- **A3: Device Rotation.** Upon device rotation (portrait to landscape or vice versa), the `resize` event fires. The browser re-evaluates the viewport width against the breakpoints and dynamically reapplies the correct CSS rules without requiring a page reload.\n- **A4: High-DPI (Retina) Displays.** For viewports that meet a `min-width` breakpoint but have a high device pixel ratio (e.g., 2), the browser automatically selects the higher-resolution image from the `srcset` list, ensuring crisp visuals.\n\n7. Postconditions\n- The page layout adapts to the current viewport width with no horizontal scrollbars appearing at any breakpoint.\n- All textual content remains readable without requiring user zooming (minimum font size of 16px in base styles).\n- All interactive elements (buttons, form inputs, links) have a minimum touch target size of 44x44 CSS pixels on mobile viewports.\n- The navigation is fully accessible and operable with the appropriate interaction model for the device (tap for mobile, hover for desktop).\n- No content is clipped or hidden unintentionally due to overflow at any breakpoint.\n\n8. Data Impact\n- **Storage:** No new data is stored on the server or client as a direct result of the responsive layout logic.\n- **Transmission:** The use of `srcset` and `<picture>` elements may result in the browser requesting a different image file size, optimizing bandwidth usage on mobile networks. CSS files are cached by the browser after the initial load.\n- **Processing:** Client-side processing is limited to the browser's native CSS rendering engine and layout calculation. No additional server-side processing is required per request.\n\n9. UI Impact\n- **Layout Structure:** The main layout container uses CSS Grid or Flexbox. The number of columns in grid-based sections (\"Leistungen\", \"Kursplan\" preview) changes from 1 (mobile) to 2 (tablet) to 3 or 4 (desktop).\n- **Navigation:** The desktop header displays a full horizontal menu. The mobile header displays a logo, a hamburger icon button, and possibly a \"Kontakt\" CTA button. The mobile menu is an off-canvas overlay or accordion.\n- **Typography:** Font sizes and line heights are scaled using `rem` units, with minor adjustments at breakpoints (e.g., larger H1 on desktop).\n- **Spacing:** Padding and margin values (stored in CSS custom properties) are increased at larger breakpoints to utilize available screen real estate.\n- **Forms:** The contact form fields stack vertically on mobile/tablet but may arrange in two columns on wide desktop screens. The submit button spans the full width on mobile and becomes auto-width on desktop.\n\n10. Acceptance Criteria\n- **AC1:** When the viewport width is 320px (small mobile), the page renders with a single-column layout. The navigation is a hamburger menu. No horizontal scrollbar is present. All text is readable without zooming.\n- **AC2:** When the viewport width is 768px (tablet), the navigation displays as a horizontal top bar. The \"Leistungen\" section shows services in two equal-width columns. The Hero section's text and image are side-by-side. The \"Kursplan\" table has a horizontal scroll container if its content exceeds the viewport width.\n- **AC3:** When the viewport width is 1440px (desktop), the main content container is centered with a maximum width. The \"Kursplan\" section displays the full weekly schedule table without internal horizontal scrolling. The \"Kontakt\" form and studio location map are displayed in a two-column layout.\n- **AC4:** When rotating a mobile device from portrait to landscape (simulating a 568px x 320px viewport), the layout correctly switches from the mobile (480px) breakpoint styles to the tablet (768px) breakpoint styles if the new width meets the condition, and vice versa.\n- **AC5:** All clickable/tappable elements (buttons, nav links, form inputs) meet a minimum touch target size of 44x44 CSS pixels on viewports <= 768px width.\n- **AC6:** All images load without distortion or unintended cropping at their respective breakpoints, and no image causes layout shift (CLS) after load.\n\n### F-02: Sticky Navigation Menu\n\n1. Purpose\nTo provide a fixed-position navigation header that remains visible at the top of the viewport during page scroll, improving site navigation accessibility and user experience on the single-page landing page.\n\n2. Actors\n- Primary: Website Visitor (end-user)\n- Secondary: Studio Administrator (manages content via CMS, if applicable)\n\n3. Trigger\nThe feature activates automatically when the user scrolls the page vertically beyond a predefined threshold (e.g., 50px from the top).\n\n4. Preconditions\n- The landing page HTML includes a `<header>` element with a navigation container (`<nav>`) containing anchor links to page sections (e.g., `#hero`, `#leistungen`, `#kursplan`, `#kontakt`).\n- The page content height exceeds the viewport height, enabling vertical scrolling.\n- The viewport width is at least 768px (desktop/tablet). On mobile, the navigation may collapse into a hamburger menu; sticky behavior applies to the toggled header.\n\n5. Main Flow\n1. **Initial Render**: The page loads with the navigation header in its default static position at the top of the document flow.\n2. **Scroll Event Listener**: A JavaScript `scroll` event listener is attached to the `window` object upon page load.\n3. **Threshold Check**: On each scroll event, the script calculates `window.scrollY`. If `scrollY > 50`, proceed to step 4; else, proceed to step 5.\n4. **Apply Sticky Class**: The script adds a CSS class (e.g., `is-sticky`) to the header element. This class applies `position: fixed; top: 0; left: 0; width: 100%;` and increases the header's `z-index` to ensure it overlays subsequent content.\n5. **Remove Sticky Class**: If `scrollY <= 50`, the script removes the `is-sticky` class, reverting the header to its original static/relative positioning.\n6. **Link Click Handling**: When a user clicks a navigation link, the page smoothly scrolls (`scrollIntoView({ behavior: 'smooth' })`) to the target section. After scroll completion, the sticky state is re-evaluated based on the new scroll position.\n7. **Mobile Toggle (if applicable)**: On viewports < 768px, a hamburger icon toggles the visibility of the navigation links. When the mobile menu is open and the user scrolls, the sticky header behavior (steps 3-5) still applies to the header bar containing the hamburger icon.\n\n6. Alternate Flows\n- **A1: No Scrollable Content**: If the page content height is less than the viewport height, the scroll event never triggers. The header remains in its default static position. The script should handle this gracefully without errors.\n- **A2: Rapid Scroll/Resize**: During fast scrolling or window resizing, multiple scroll events fire in quick succession. The script uses `requestAnimationFrame` or a debounce mechanism (e.g., 50ms) to limit DOM updates and maintain performance.\n- **A3: Mobile Menu Open on Scroll**: On mobile, if the user opens the hamburger menu and then scrolls, the mobile menu overlay should automatically close to prevent obstructing content, while the header remains sticky.\n- **A4: Anchor Link from External Page**: If a user lands on the page with a URL hash (e.g., `index.html#kursplan`), the browser jumps to the section on load. The script must evaluate the initial scroll position after DOM content loaded and apply the sticky class if the hash target is below the 50px threshold.\n\n7. Postconditions\n- The navigation header is visually fixed at the top of the viewport whenever the page scroll position exceeds 50px.\n- All navigation links remain functional and scroll smoothly to their target sections.\n- The header's z-index ensures it is always above other page content (e.g., hero image, section backgrounds).\n- On mobile, the sticky header bar (with hamburger icon) remains accessible during scroll.\n\n8. Data Impact\n- **Client-Side Storage**: Optionally, the current scroll state (e.g., `isSticky: true/false`) can be stored in `sessionStorage` to persist the sticky class across page reloads if the user was mid-scroll, improving perceived performance.\n- **Analytics**: Click events on navigation links may be tracked (e.g., via Google Analytics) to measure navigation usage. No server-side data storage is required for the sticky functionality itself.\n- **No Database Changes**: This feature is purely presentational and client-side; no new database tables or persistent data storage are needed.\n\n9. UI Impact\n- **CSS**: Add a `.is-sticky` class to the header's stylesheet with:\n  ```css\n  .site-header.is-sticky {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    z-index: 1000;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1); /* Optional visual indicator */\n  }\n  ```\n- **Responsive Behavior**: On mobile (<768px), the sticky class applies only to the top bar containing the logo and hamburger icon, not the expanded mobile menu overlay.\n- **Visual Feedback**: Optionally, the header's background opacity or color can transition when becoming sticky to indicate state change (e.g., from transparent to solid white).\n- **Spacing Adjustment**: When the header becomes fixed, it is removed from the document flow. To prevent content jump, the script should add equivalent `padding-top` to the `<body>` or a spacer element equal to the header's height when the sticky class is applied.\n\n10. Acceptance Criteria\n- **AC1**: On a desktop viewport (width ≥768px), when the user scrolls down more than 50px, the navigation header becomes fixed at the top of the viewport and remains there during further scrolling.\n- **AC2**: When scrolling back up to within 50px of the top, the header returns to its original static position in the document flow.\n- **AC3**: Clicking any navigation link smoothly scrolls the page to the correct section and the sticky state updates correctly based on the final scroll position.\n- **AC4**: On mobile viewports (<768px), the header bar (with logo/hamburger) becomes sticky on scroll, and the mobile menu overlay closes automatically if open during scroll.\n- **AC5**: No layout shift or content jump occurs when the header switches to fixed positioning (i.e., the main content does not unexpectedly move up).\n- **AC6**: The sticky functionality works correctly across Chrome, Firefox, Safari, and Edge latest versions, with no JavaScript errors in the console during scroll events.\n- **AC7**: If the page has insufficient content to scroll, the header remains static and no sticky class is applied.\n\n### F-03: Hamburger Menu for Mobile\n\n1. Purpose\nTo provide an accessible, space-efficient navigation interface on mobile viewports (width < 768px) by collapsing the standard horizontal navigation bar into a toggleable vertical menu. This ensures all primary navigation links remain available without cluttering the small screen.\n\n2. Actors\n- Mobile User: The primary actor who interacts with the hamburger menu icon to show/hide navigation links.\n- Site Administrator (Indirect): Configures the navigation link structure, which the menu dynamically reflects.\n\n3. Trigger\nThe user's viewport width enters the mobile range (defined as less than 768px), causing the desktop navigation to be hidden and the hamburger menu icon to become visible in the header.\n\n4. Preconditions\n- The desktop navigation component (containing all primary links: Home, Leistungen, Kursplan, Kontakt) exists and is functional.\n- The page layout is responsive, using CSS media queries or a responsive framework.\n- The hamburger icon element is present in the DOM within the header, styled as `display: none` on desktop viewports.\n- All navigation links are defined in a single source (e.g., a JavaScript array or consistent HTML structure) to ensure the mobile menu can replicate them exactly.\n\n5. Main Flow\n1. User accesses the landing page on a mobile device or resizes their desktop browser window to a width less than 768px.\n2. The responsive CSS/JavaScript detects the viewport change. The desktop navigation bar is hidden (`display: none`), and the hamburger icon element is shown (`display: block` or `flex`).\n3. The user taps the hamburger icon.\n4. JavaScript intercepts the tap event, toggles a CSS class (e.g., `.is-open`) on a dedicated mobile menu container.\n5. The mobile menu container, previously hidden (`max-height: 0`, `opacity: 0`, or `display: none`), becomes visible with a smooth transition. It expands vertically, typically overlaying the page content or pushing it down.\n6. The hamburger icon visually transforms (e.g., morphs into an 'X' or changes background image) to indicate the open state. The `aria-expanded` attribute on the icon button is updated to `\"true\"`.\n7. The user views the list of navigation links, now displayed in a vertical stack.\n8. The user either:\n   a. Taps a navigation link: The browser navigates to the corresponding anchor section (e.g., `#leistungen`). The menu collapse flow (step 9) is triggered.\n   b. Taps the now 'X'-shaped icon again: The menu collapse flow (step 9) is triggered without navigation.\n9. JavaScript removes the `.is-open` class from the mobile menu container. The container collapses and becomes hidden. The hamburger icon reverts to its original state, and `aria-expanded` is set to `\"false\"`.\n\n6. Alternate Flows\n- **A1: Viewport Resize During Open Menu**\n  1. While the mobile menu is open (`.is-open` class active), the user rotates their device or resizes the browser window to a width of 768px or greater.\n  2. A `resize` event listener detects the new viewport width.\n  3. JavaScript immediately removes the `.is-open` class from the mobile menu container, ensuring it is hidden.\n  4. The desktop navigation bar is shown (`display: flex` or `block`), and the hamburger icon is hidden (`display: none`).\n  5. The system state is consistent with the desktop view.\n- **A2: Tap Outside Menu to Close**\n  1. The mobile menu is open.\n  2. The user taps on any part of the main page content outside the boundaries of the open mobile menu container.\n  3. A global touch/click event listener detects the tap target is not within the menu container or the hamburger button.\n  4. The listener programmatically triggers the menu collapse logic (steps 9 of Main Flow).\n  5. The menu closes, and the icon state resets.\n\n7. Postconditions\n- The mobile menu's visual state (open or closed) always corresponds to the last user action and the current viewport width.\n- On mobile viewports, the desktop navigation is never visible simultaneously with the hamburger icon.\n- All primary navigation links are accessible through the mobile menu when it is open.\n- The hamburger icon's visual state and `aria-expanded` attribute accurately reflect the menu's state.\n- If A2 is implemented, tapping the main content area closes an open menu.\n\n8. Data Impact\n- No persistent data is created, stored, or modified by this feature.\n- Optional: A non-persistent analytics event (e.g., `menu_toggle`) may be fired upon each toggle action for interaction tracking, but this does not affect core functionality.\n\n9. UI Impact\n- **New Elements:**\n  - A hamburger icon button (typically `<button>` with `aria-label=\"Menü öffnen/schließen\"`), positioned in the header, visible only on mobile.\n  - A mobile menu container `<div>` (or `<nav>`) that houses a cloned or dynamically generated list of the primary navigation links. This container is hidden by default on mobile.\n- **Style Changes (CSS):**\n  - Media query `@media (max-width: 767px)`:\n    - Hides the desktop navigation (`display: none` on its container).\n    - Shows the hamburger icon (`display: block`).\n    - Styles the mobile menu container (position: fixed/absolute, full width, background color, z-index).\n    - Defines transition effects for opening/closing (e.g., `max-height`, `transform`, `opacity`).\n  - Class `.is-open` applied to the mobile menu container to trigger its visible state.\n  - Class `.is-active` (or similar) applied to the hamburger button to change its icon (e.g., using a background image swap or SVG transformation).\n- **Accessibility:**\n  - Hamburger button must have `aria-controls` pointing to the mobile menu container's ID.\n  - The mobile menu container must have `aria-hidden=\"true\"` when closed and `aria-hidden=\"false\"` when open.\n  - Focus management is recommended: when the menu opens, focus should move to the first link inside it; when it closes, focus returns to the hamburger button.\n\n10. Acceptance Criteria\n- **AC1:** On viewport widths < 768px, the desktop navigation bar is not visible, and the hamburger icon is visible in the header.\n- **AC2:** On viewport widths >= 768px, the hamburger icon is not visible, and the standard desktop navigation bar is visible.\n- **AC3:** Tapping the hamburger icon on a mobile viewport immediately displays a vertical list of all primary navigation links (Home, Leistungen, Kursplan, Kontakt).\n- **AC4:** The mobile menu contains a visually distinct close mechanism (either the transformed 'X' icon or a dedicated \"Schließen\" button/link) that functions identically to tapping the icon again.\n- **AC5:** Tapping any navigation link within the open mobile menu navigates the user to the correct page section and automatically closes the menu.\n- **AC6:** The mobile menu can be closed by tapping the close mechanism (icon/X) without navigation occurring.\n- **AC7:** (If A2 implemented) Tapping anywhere in the main page content area while the mobile menu is open closes the menu.\n- **AC8:** (If A1 implemented) Rotating or resizing the mobile browser window to a width >= 768px while the menu is open automatically closes the menu and shows the desktop navigation.\n- **AC9:** The hamburger icon and mobile menu container have the correct ARIA attributes (`aria-label`, `aria-expanded`, `aria-controls`, `aria-hidden`) that update in real-time with the menu state.\n- **AC10:** The transition between open and closed states is smooth (e.g., fade or slide) without layout shifts or content jumps on the underlying page.\n\n### F-04: Hero Section with Background Image\n\n1. Purpose\nTo create an immediate visual impact and brand recognition by displaying a full-width, high-quality background image with the studio's name and tagline prominently overlaid. This section establishes the studio's aesthetic and provides a clear entry point to the website.\n\n2. Actors\nPrimary: Website Visitor (any user accessing the landing page).\nSecondary: Content Administrator (theoretically, for updating the image or text, though this is a static front-end feature in this scope).\n\n3. Trigger\nThe browser completes the initial parsing of the HTML document and begins rendering the `<body>` content.\n\n4. Preconditions\n1.  The landing page HTML file (`index.html`) is served.\n2.  The background image asset (e.g., `hero-background.jpg`) is available in the defined assets directory (e.g., `/assets/images/`).\n3.  The studio name (\"[Studio Name]\") and tagline (\"[Studio Tagline]\") text strings are hard-coded in the HTML or available via a static configuration.\n4.  The user's browser supports CSS3 background properties and Flexbox/Grid layout.\n\n5. Main Flow\n1.  The browser parses the HTML and encounters the `<section>` element with the ID or class `hero-section`.\n2.  The browser applies the CSS rule for `hero-section` which sets `width: 100%`, `height: 100vh` (or a fixed `min-height` like `600px`), and `position: relative`.\n3.  The CSS rule applies the background image using `background-image: url('/assets/images/hero-background.jpg');`, along with `background-size: cover`, `background-position: center`, and `background-repeat: no-repeat`.\n4.  The browser renders the background image. If the image has not fully loaded, a solid background color (e.g., `#f5f5f5`) defined in the CSS is displayed as a placeholder.\n5.  The browser parses the child `<div>` container (e.g., class `hero-content`) within the section.\n6.  The CSS for `hero-content` applies `position: absolute` or uses Flexbox/Grid to center its content both vertically and horizontally within the `hero-section`.\n7.  The browser renders the `<h1>` element containing the studio name. The CSS applies a text styling (e.g., `color: white`, `text-shadow: 0 2px 4px rgba(0,0,0,0.5)`) to ensure legibility against the background image.\n8.  The browser renders the `<p>` or `<h2>` element containing the tagline, with appropriate, smaller typography and the same legibility styling.\n9.  The browser applies a semi-transparent dark overlay (e.g., `background: rgba(0, 0, 0, 0.3);`) on the `hero-section` or `hero-content` container to further enhance text contrast, as defined in the CSS.\n10. The final rendered hero section is visible to the user, with the background image covering the full viewport width and height, and the text centered and clearly readable.\n\n6. Alternate Flows\n1.  **Background Image Fails to Load:** The browser cannot retrieve the image file (404 error or network issue). The CSS-defined solid background color remains visible. The text overlay is still rendered and legible against this solid color. A console error is logged.\n2.  **High-Resolution/Retina Display:** The browser on a high-DPI device requests a higher-resolution image if a `srcset` attribute is provided on a semantic `<img>` tag (alternative implementation) or if a media query serves a different image file. The main flow adapts to serve `hero-background@2x.jpg`.\n3.  **Very Narrow Viewport (Mobile Portrait):** The viewport width is less than 320px. The CSS media query (`@media (max-width: 320px)`) triggers, reducing the `font-size` of the `<h1>` and tagline, and potentially reducing the `min-height` of the section to prevent excessive vertical whitespace. The text may wrap to a second line.\n4.  **User has \"Reduce Motion\" Accessibility Preference:** The user's OS/browser setting `prefers-reduced-motion` is active. Any CSS transition or animation intended for the hero content (e.g., fade-in) is disabled, and the content is rendered immediately without animation.\n\n7. Postconditions\n1.  The DOM contains a visible `<section>` element occupying the top of the viewport.\n2.  The computed style of this section includes a background image (or the fallback color) set to `cover` the area.\n3.  The studio name and tagline text nodes are present in the DOM, are direct children of the centered container, and have computed styles ensuring they are positioned over the background.\n4.  The visual contrast ratio between the text and the background (including overlay) meets WCAG AA standards (≥ 4.5:1 for normal text).\n\n8. Data Impact\n*   **No Persistent Data Storage:** This feature does not read from or write to any database, server-side session, or client-side storage (localStorage/cookies).\n*   **Static Asset Transfer:** The web server delivers the static image file (`hero-background.jpg`) to the client's browser. Server logs may record a GET request for this asset.\n\n9. UI Impact\n*   **DOM Structure:** Adds a top-level `<section id=\"hero\">` containing a content wrapper (`<div class=\"hero-content\">`), an `<h1>`, and a tagline element.\n*   **CSS:** Requires styles for full-width/height, background image handling, absolute/flex centering, typography, text shadow/overlay for contrast, and responsive breakpoints.\n*   **Responsive Behavior:** The section must adapt to all viewport widths (mobile to desktop). Text size and container padding must adjust via media queries. The background image remains centered and covers the area.\n*   **Accessibility:** The text must have sufficient color contrast. If the image is purely decorative, the section should have `aria-hidden=\"true\"` or the image should be implemented via CSS (as specified) to be ignored by screen readers. The `<h1>` must be the first heading on the page.\n\n10. Acceptance Criteria\n1.  **AC1:** Upon loading the landing page, a hero section is visible at the top, spanning the entire viewport width.\n2.  **AC2:** The hero section displays the specified background image, scaled to cover the entire section without distortion (aspect ratio preserved, no cropping of the central subject).\n3.  **AC3:** The studio name is displayed as a large, prominent heading (`<h1>`) and the tagline as a subheading, both centered horizontally and vertically within the hero section.\n4.  **AC4:** The text remains clearly readable against the background image in all standard lighting conditions (verified via contrast ratio tool).\n5.  **AC5:** On viewport widths below 768px, the font sizes of the heading and tagline reduce appropriately, and no horizontal scrolling is introduced by the hero section.\n6.  **AC6:** If the background image URL is deliberately broken (404), the section displays the fallback background color and the text remains fully legible and centered.\n7.  **AC7:** The hero section renders correctly in the latest versions of Chrome, Firefox, Safari, and Edge.\n\n### F-05: Hero Call‑to‑Action Button\n\n1. Purpose\nTo provide a prominent, clearly visible button in the hero section of the landing page that encourages website visitors to navigate directly to the contact form, thereby increasing lead generation and inquiries for the yoga studio.\n\n2. Actors\n*   Primary Actor: Website Visitor\n*   Secondary Actor: Studio Staff (indirectly, via analytics)\n\n3. Trigger\nThe rendering of the landing page's hero section.\n\n4. Preconditions\n*   The landing page is successfully served and rendered in the user's browser.\n*   The hero section HTML structure is present.\n*   The target contact form page (`/contact` or equivalent) exists, is published, and is accessible.\n*   The button's link `href` attribute is correctly configured to point to the contact form's URL.\n\n5. Main Flow\n1.  The user's browser requests and receives the landing page HTML.\n2.  The browser parses the HTML and renders the hero section.\n3.  The hero Call‑to‑Action (CTA) button is rendered with visible text (e.g., \"Jetzt Kurs anfragen\" or \"Kontakt aufnehmen\").\n4.  The user visually identifies the button as a primary action element.\n5.  The user positions the pointer over the button and clicks (or taps) the primary mouse button / touches the screen.\n6.  The browser receives the click event on the button element.\n7.  The browser navigates to the URL specified in the button's `href` attribute (the contact form page).\n8.  The contact form page loads successfully in the browser.\n\n6. Alternate Flows\n*   **A1: Contact Form Page Fails to Load.** After step 7 in the Main Flow, the requested contact form URL returns an HTTP error (e.g., 404 Not Found, 500 Server Error) or fails to load. The browser displays an error page. **System Response:** The button remains clickable, but the navigation target is invalid. This is a configuration/data error, not a flow error.\n*   **A2: Button Temporarily Disabled.** In a future state, the studio may wish to pause new inquiries. The button's `disabled` attribute is set via backend logic or a feature flag. The button is rendered but is not interactive (greyed out, cursor shows 'not-allowed'). **System Response:** Clicking/tapping the button has no effect. No navigation occurs.\n\n7. Postconditions\n*   The user's browser displays the contact form page.\n*   A click event for the specific CTA button (identified by a unique CSS class or ID) is recorded in the analytics/logging system with a timestamp and session identifier.\n*   The landing page remains in the browser's history (back button functionality is preserved).\n\n8. Data Impact\n*   A new event log entry is created: `event_type: \"cta_click\"`, `element_id: \"hero-cta-button\"`, `page: \"landing-page\"`, `timestamp: [current_utc_time]`, `session_id: [user_session]`.\n*   No personal user data is stored or modified by this interaction alone.\n*   Referrer data (landing page URL) is passed to the contact form page via the HTTP `Referer` header.\n\n9. UI Impact\n*   **Visual Design:** The button must use the studio's primary brand color, have sufficient color contrast with its background (WCAG AA minimum), and include clear, action-oriented text. It must be visually distinct from other hero elements.\n*   **Placement:** Positioned centrally or aligned with the studio's visual hierarchy within the hero section, typically below the main headline and subheadline.\n*   **Responsiveness:** The button must be fully visible and tappable on all viewport sizes (mobile, tablet, desktop). Minimum touch target size of 44x44px.\n*   **Interactivity:** Visual feedback on hover (e.g., color darken, slight lift) and active (pressed) states. Focus ring must be visible for keyboard navigation (Tab key).\n*   **Accessibility:** The button element must be a native `<button>` or an `<a>` with `role=\"button\"`. It must have an accessible name (via visible text or `aria-label`). The `href` attribute must be present and valid for navigation.\n\n10. Acceptance Criteria\n*   **AC1:** On a standard desktop viewport (≥1024px), the hero CTA button is visible within the hero section without requiring vertical scrolling.\n*   **AC2:** On a standard mobile viewport (≤375px), the hero CTA button is fully visible and its touch target meets the minimum size requirement.\n*   **AC3:** Clicking/tapping the button navigates the browser to the exact, correct URL of the published contact form page within 2 seconds under normal network conditions.\n*   **AC4:** The button displays correct hover and focus states as defined in the UI design specifications.\n*   **AC5:** An analytics event with `event_type: \"cta_click\"` and `element_id: \"hero-cta-button\"` is successfully transmitted to the analytics endpoint upon a click.\n*   **AC6:** The button's text is legible and meets WCAG 2.1 AA contrast ratio requirements against its background.\n*   **AC7:** The button can be focused and activated using only the keyboard (Tab to focus, Enter/Space to activate).\n\n### F-06: Services Overview Section\n\n1. Purpose\nTo present a concise, visually engaging overview of the yoga studio's core service offerings (e.g., class types like Hatha, Vinyasa, Yin) directly on the landing page. This section aims to quickly inform visitors about the studio's specialties, encourage deeper exploration, and drive interest in booking a class.\n\n2. Actors\nPrimary: Website Visitor (unauthenticated user).\nSecondary: Content Administrator (manages service data via a separate backend CMS/admin panel, not part of this feature's runtime).\n\n3. Trigger\nThe rendering of the Services Overview Section is triggered automatically when a user navigates to the landing page (`/`) and the section enters the viewport (or on page load if above the fold).\n\n4. Preconditions\n*   The user has an active internet connection and a modern web browser.\n*   The frontend application is loaded and initialized.\n*   The backend API endpoint (`GET /api/services`) is available and returns data for active services.\n*   At least one service is marked as \"active\" in the backend data store.\n\n5. Main Flow\n1.  The user's browser loads the landing page HTML and associated JavaScript bundles.\n2.  The frontend JavaScript executes and identifies the DOM container for the Services section.\n3.  The frontend issues an asynchronous `GET` request to the configured backend API endpoint (e.g., `/api/services?limit=4&sort=order`).\n4.  The backend API receives the request, queries the data store for active service records, and returns a JSON array containing objects with the fields: `id`, `name` (string), `short_description` (string, max 120 chars), `image_url` (string, absolute URL), `slug` (string, for linking).\n5.  The frontend receives a `200 OK` response with the service data array.\n6.  The frontend iterates over the array and dynamically generates a service card component for each item.\n7.  Each card is inserted into the section's container in the specified order. The card structure is:\n    *   An `<img>` element using the `image_url` as `src` and `alt` text set to `[Service Name] - [Studio Name] Yoga`.\n    *   An `<h3>` heading displaying the `name`.\n    *   A `<p>` paragraph displaying the `short_description`.\n    *   A styled \"Learn More\" button/link pointing to `/services/[slug]` (or a modal trigger if detailed pages are not implemented).\n8.  The fully rendered section becomes visible to the user.\n9.  The frontend analytics module logs an impression event for the \"Services Overview Section\".\n\n6. Alternate Flows\n*   **A1: API Request Fails (Network/5xx Error).** The frontend `catch` block executes. The section container displays a static, server-side rendered fallback message: \"Our diverse yoga offerings are currently being updated. Please check back soon.\" No service cards are rendered. A console error is logged, and an error event is sent to the analytics service.\n*   **A2: API Returns Empty Array.** The frontend logic detects an empty array. The section container displays a fallback message: \"No services are currently listed.\" The section's visual container remains but is empty or contains the message. An analytics event for \"services_empty\" is logged.\n*   **A3: Individual Service Data Incomplete.** During card generation, if a specific service object lacks a `short_description` or `image_url`, the frontend uses predefined fallback values: a generic description text (\"A classic yoga practice.\") and a default placeholder image from the static assets (`/images/service-placeholder.jpg`). The card is still rendered to maintain layout integrity.\n\n7. Postconditions\n*   The Services Overview Section is fully rendered in the DOM with either:\n    *   A grid of service cards (1-4, as limited by API) for each active service.\n    *   A fallback message (in case of error or no data).\n*   All images in successfully rendered cards have initiated a network request for their source file.\n*   An analytics impression event has been dispatched.\n*   The user can interact with the \"Learn More\" buttons/links on each card.\n\n8. Data Impact\n*   **Read:** The feature reads from the `services` data table/collection. Required fields per record: `id` (PK), `name`, `short_description`, `image_url`, `slug`, `is_active` (boolean), `display_order` (integer).\n*   **Write:** This feature does not write or modify any data. All content management is performed via a separate administrative interface.\n*   **API Contract:** Defines a required `GET /api/services` endpoint that accepts optional query parameters (`limit`, `sort`) and returns a JSON array of service objects with the specified schema.\n\n9. UI Impact\n*   **New Components:** `ServiceCard` component.\n*   **Layout:** A responsive grid (CSS Grid or Flexbox) that displays 1 column on mobile, 2 on tablet, and 3-4 on desktop.\n*   **Styling:** Consistent card design with shadow, border-radius, and hover lift effect. Image has `object-fit: cover` and fixed aspect ratio (e.g., 4:3). Typography follows the studio's brand guidelines.\n*   **Accessibility:** All images have descriptive `alt` attributes. Buttons are focusable and have visible focus states. The section has an `aria-labelledby` pointing to its heading (`<h2>`).\n*   **States:** Loading skeleton state is shown immediately while the API request is pending (optional but recommended). Error/empty states as defined in Alternate Flows.\n\n10. Acceptance Criteria\n*   **AC1:** Upon successful load, the section displays a minimum of 1 and a maximum of 4 service cards, sorted by `display_order`.\n*   **AC2:** Each rendered card correctly displays the service's `name`, `short_description`, and associated `image` with proper `alt` text.\n*   **AC3:** The \"Learn More\" button on each card is a functional link pointing to the correct service-specific URL path (`/services/[slug]`).\n*   **AC4:** The grid layout is responsive and adapts correctly to viewport widths: 1 column (mobile <768px), 2 columns (tablet >=768px), 3 columns (desktop >=1024px), 4 columns (large desktop >=1280px) if 4+ services exist.\n*   **AC5:** If the API call fails or returns no active services, the appropriate fallback message is displayed within the section's container.\n*   **AC6:** An analytics event with name `services_section_impression` is logged exactly once when the section becomes visible in the viewport.\n*   **AC7:** If a service record lacks an image or description, the card renders using the defined fallback values without layout breakage.\n*   **AC8:** All interactive elements (buttons/links) meet WCAG 2.1 AA contrast requirements and have visible keyboard focus indicators.\n\n### F-07: Individual Service Card Component\n\n1. Purpose\nTo render a visually consistent, self-contained card component that presents a single yoga studio service (e.g., \"Hatha Yoga\", \"Prenatal Yoga\") to a website visitor. The component displays an identifying icon, the service's title, and a concise descriptive text, enabling quick scanning and understanding of the studio's offerings within the \"Leistungen\" (Services) section.\n\n2. Actors\n- Primary: End User (website visitor) who reads the service information.\n- Secondary: Content Editor (studio staff) who manages the service data in the backend CMS.\n\n3. Trigger\nThe component is triggered to render when the parent \"Services Section\" component processes the array of active service objects provided by the CMS and iterates over them, instantiating an `IndividualServiceCard` for each object in the array.\n\n4. Preconditions\n- The CMS contains at least one published service entry with valid data for the required fields: `id`, `title`, `description`, and `iconIdentifier`.\n- The parent Services Section component has successfully fetched and parsed the list of active services from the CMS API.\n\n5. Main Flow\n1.  The `IndividualServiceCard` component receives a single `service` object as a prop from its parent component.\n2.  The component validates the presence of required props (`title`, `iconIdentifier`). If validation fails, it logs a development error and renders a fallback placeholder card (see Alternate Flow A1).\n3.  The component renders a top-level `<article>` container with a specific CSS class (e.g., `.service-card`) for styling and accessibility.\n4.  Inside the container, the component renders an `<span>` or `<div>` for the icon. It uses the `iconIdentifier` prop to select and render the corresponding SVG icon from a pre-defined, locally imported icon set.\n5.  The component renders an `<h3>` heading element containing the `title` prop text.\n6.  The component renders a `<p>` paragraph element containing the `description` prop text.\n7.  The component applies responsive CSS classes to ensure proper spacing, alignment, and card dimensions across mobile, tablet, and desktop viewports as defined in the global design system.\n\n6. Alternate Flows\nA1: Missing Icon Data - If the `iconIdentifier` prop is null, undefined, or does not match any key in the icon set, the component renders a default \"service\" placeholder icon (e.g., a generic leaf or circle symbol) instead of failing.\nA2: Excessive Description Length - If the `description` text exceeds 150 characters, the component automatically truncates the text and appends an ellipsis (\"...\"). The full text remains available in the `title` attribute of the `<p>` element for hover tooltips.\nA3: Empty Description - If the `description` prop is an empty string, the component renders the icon and title but omits the `<p>` element entirely to avoid visual whitespace.\n\n7. Postconditions\n- A single, styled service card is present in the DOM, correctly positioned within the parent services grid or list.\n- The card displays an icon (either specified or default), the service title, and the description (full or truncated).\n- The card's HTML structure is semantically correct (using `<article>`, `<h3>`, `<p>`).\n- The component's CSS classes are applied, ensuring visual consistency with the design system.\n\n8. Data Impact\n- **Read Access:** The component reads a single service object from its parent's props. The data structure must include: `id` (string/number), `title` (string, required), `description` (string, required), `iconIdentifier` (string, required).\n- **Write Access:** None. The component is presentational and does not modify data.\n- **Storage:** No new data is stored. It relies entirely on the existing service dataset managed in the CMS.\n\n9. UI Impact\n- **Layout:** The card must fit within a responsive grid (e.g., CSS Grid or Flexbox) defined by the parent Services Section. It must have a fixed or flexible width, consistent padding, and border-radius as per the design system.\n- **Styling:** Must use the studio's color palette (primary, secondary, text colors) and typography scale (font family, sizes for title and description). Includes hover state styling (e.g., subtle shadow increase, border color change).\n- **Accessibility:** The `<h3>` heading must be programmatically associated with the card's content. If the icon is purely decorative, it must have `aria-hidden=\"true\"`. If the icon conveys meaning, it requires an `aria-label` or `role=\"img\"`. The color contrast ratio between text and background must meet WCAG AA standards.\n- **Responsiveness:** The card's internal layout (icon above title, etc.) must remain intact and legible on viewports from 320px width upwards. The parent grid's column count must adjust based on viewport width (e.g., 1 column mobile, 2 tablet, 3 desktop).\n\n10. Acceptance Criteria\n- **AC1:** Given a valid service object with all fields, when rendered, then the card displays the correct icon, title, and full description text.\n- **AC2:** Given a service object with a `description` of 200 characters, when rendered, then the displayed description is truncated to 150 characters plus an ellipsis, and the full text is in the `title` attribute.\n- **AC3:** Given a service object with a `description` of exactly 150 characters, when rendered, then the full description is displayed without truncation.\n- **AC4:** Given a service object with an invalid or missing `iconIdentifier`, when rendered, then the default placeholder icon is displayed.\n- **AC5:** Given a service object with an empty `description`, when rendered, then the card contains only the icon and title, with no empty paragraph element in the DOM.\n- **AC6:** The component renders without visual or layout breaking when placed in a parent grid with 1, 2, or 3 columns.\n- **AC7:** The component passes automated accessibility audits (e.g., axe-core) for color contrast, heading hierarchy, and ARIA attributes.\n\n### F-08: Course Schedule Section\n\n### 1. Purpose\nProvide website visitors with a clear, up‑to‑date weekly overview of all yoga classes offered by the studio, including date, start‑time, duration, class type, and instructor name. The section must enable quick visual scanning and support direct navigation to the booking form for each class.\n\n### 2. Actors\n| Actor | Role |\n|-------|------|\n| **Visitor** | Views the schedule, selects a class to book. |\n| **Studio Administrator** | Creates, updates, or deletes class entries via the CMS backend. |\n| **System (Web Server / API)** | Serves schedule data and logs access events. |\n\n### 3. Trigger\nThe schedule section is rendered automatically when the landing‑page URL (`/`) is requested and the page’s DOM reaches the “Course Schedule” placeholder element.\n\n### 4. Preconditions\n1. The CMS contains at least one active class entry for the current week.  \n2. The REST endpoint `GET /api/v1/schedule?week={ISO_WEEK_NUMBER}` is reachable and returns a JSON payload with a 200 status code.  \n3. The visitor’s browser supports JavaScript ES2022 and CSS Grid.  \n4. The visitor’s locale is either `de-DE` or `en-US`; the system defaults to `de-DE` if not detected.\n\n### 5. Main Flow (deterministic implementation steps)\n\n1. **Page Load** – Browser loads `index.html` and executes `main.js`.  \n2. **Determine Current Week** – `main.js` calculates the ISO week number of the current date (e.g., using `date-fns` library).  \n3. **API Request** – `main.js` sends an HTTP GET request to `/api/v1/schedule?week={ISO_WEEK_NUMBER}` with the header `Accept: application/json`.  \n4. **Receive Payload** – Server returns JSON structured as:  \n\n   ```json\n   {\n     \"week\": \"2024-W07\",\n     \"classes\": [\n       {\n         \"id\": \"c123\",\n         \"date\": \"2024-02-19\",\n         \"startTime\": \"08:00\",\n         \"durationMinutes\": 60,\n         \"type\": \"Vinyasa Flow\",\n         \"instructor\": \"Anna Müller\",\n         \"bookingUrl\": \"/booking?classId=c123\"\n       },\n       ...\n     ]\n   }\n   ```\n\n5. **Validate Payload** – `main.js` validates that:\n   - `week` matches the requested week.\n   - `classes` is an array of objects with all required fields.\n   - No duplicate `id` values exist.\n   If validation fails, jump to Alternate Flow A‑1.\n\n6. **Sort Classes** – Sort the `classes` array first by `date` (ascending) then by `startTime` (ascending).\n\n7. **Generate Grid Structure** – For each day Monday‑Sunday, create a column in a CSS Grid container (`#schedule-grid`). Within each column, create a row for every class belonging to that day.\n\n8. **Render Class Cards** – For each class object:\n   - Create a `<div class=\"class-card\" data-id=\"{id}\">`.\n   - Insert child elements:\n     - `<time datetime=\"{date}T{startTime}\">{formattedDate} – {formattedTime}</time>`\n     - `<h4 class=\"class-type\">{type}</h4>`\n     - `<p class=\"instructor\">Instructor: {instructor}</p>`\n     - `<a href=\"{bookingUrl}\" class=\"book-btn\">Jetzt buchen</a>`\n   - Apply ARIA roles: `role=\"listitem\"` for the card, `role=\"button\"` for the link.\n\n9. **Inject into DOM** – Append each completed column to `#schedule-grid`. Ensure the grid container has `role=\"table\"` and each column has `role=\"columnheader\"`.\n\n10. **Accessibility Enhancements** – Add `tabindex=\"0\"` to each class card, and provide a hidden `<span class=\"sr-only\">` describing the class details for screen readers.\n\n11. **Cache Result** – Store the received JSON in `sessionStorage` under key `schedule_{ISO_WEEK_NUMBER}` with a timestamp. Subsequent page loads within the same session read from cache instead of issuing a new API request.\n\n12. **Log Rendering** – Send a non‑blocking POST to `/api/v1/analytics` with payload `{event: \"schedule_rendered\", week: \"2024-W07\", count: <number_of_classes>}`.\n\n13. **Display Completed** – Remove the placeholder spinner (`#schedule-loading`) and reveal the populated grid.\n\n### 6. Alternate Flows\n| Flow | Condition | Steps |\n|------|-----------|-------|\n| **A‑1** | Payload validation fails | 1. Show error banner `<div class=\"schedule-error\">Fehler beim Laden des Kursplans. Bitte versuchen Sie es später erneut.</div>`.<br>2. Log error via POST to `/api/v1/analytics` with `{event:\"schedule_error\", details:<validation_error>}`.<br>3. End. |\n| **A‑2** | API returns HTTP 404 or 500 | 1. Display same error banner as A‑1.<br>2. Retry request after 30 seconds (max 2 retries).<br>3. If still failing, fall back to cached data if available; otherwise show error banner. |\n| **A‑3** | No classes for the requested week (`classes` array empty) | 1. Render a single centered message `<p class=\"no-classes\">In dieser Woche finden keine Kurse statt. Bitte prüfen Sie die nächste Woche.</p>`.<br>2. Provide navigation buttons “Vorherige Woche” and “Nächste Woche” that reload the section with the adjusted week number. |\n| **A‑4** | Visitor’s browser does not support CSS Grid | 1. Detect lack of support via `CSS.supports(\"display\", \"grid\")`.<br>2. Load fallback stylesheet `schedule-fallback.css` that uses a flex‑based vertical list.<br>3. Render classes in a single column list preserving all data fields. |\n| **A‑5** | Time‑zone mismatch (visitor’s locale differs from studio’s timezone) | 1. Detect visitor’s timezone via `Intl.DateTimeFormat().resolvedOptions().timeZone`.<br>2. Convert `date` and `startTime` from studio timezone (Europe/Berlin) to visitor’s timezone using `date-fns-tz` before rendering.<br>3. Append a small note “Zeiten in Ihrer Zeitzone” under the grid header. |\n\n### 7. Postconditions\n- The DOM contains a fully populated, accessible schedule grid (`#schedule-grid`) reflecting the current week’s classes, or an error/empty‑state message if applicable.  \n- Session storage holds the schedule JSON for the displayed week with a timestamp.  \n- Analytics endpoint has recorded either a `schedule_rendered` or `schedule_error` event.  \n- No server‑side data was modified; the operation is read‑only.\n\n### 8. Data Impact\n| Operation | Data Modified | Persistence |\n|-----------|---------------|-------------|\n| GET `/api/v1/schedule` | Reads `class` records for the requested week from the database. | No write operation. |\n| POST `/api/v1/analytics` | Inserts a new analytics record. | Persistent (audit log). |\n| SessionStorage write | Stores JSON payload locally. | Exists until browser tab is closed or overwritten. |\n\n### 9. UI Impact\n- **New Section**: `<section id=\"course-schedule\">` inserted below the “Leistungen” block.  \n- **Responsive Layout**: CSS Grid with `grid-template-columns: repeat(7, 1fr);` on screens ≥ 768 px; single‑column flex layout on smaller screens.  \n- **Styling**: New SCSS file `schedule.scss` compiled to `schedule.css`, defining `.class-card`, `.book-btn`, `.schedule-error`, and `.no-classes`.  \n- **Accessibility**: ARIA roles, keyboard navigation, and screen‑reader text as described in Main Flow step 10.  \n- **Loading Indicator**: `<div id=\"schedule-loading\" class=\"spinner\"></div>` displayed until step 13.  \n- **Navigation Controls**: “Vorherige Woche” / “Nächste Woche” buttons added to the section header for week navigation (used in Alternate Flow A‑3).  \n\n### 10. Acceptance Criteria\n1. **Correct Data Rendering** – For a given ISO week, the grid displays every class exactly once, ordered by day and start time, with accurate date, time, type, instructor, and functional “Jetzt buchen” link.  \n2. **Error Handling** – Simulated API 500 response triggers the error banner and logs an `schedule_error` event; the banner disappears after a successful retry.  \n3. **Empty Week** – When the API returns an empty `classes` array, the “no classes” message appears and navigation buttons correctly load the previous and next weeks.  \n4. **Cache Utilization** – Reloading the page within the same browser session does not issue a second API call; the schedule is loaded from `sessionStorage`.  \n5. **Responsive Design** – On viewport widths ≥ 768 px the grid shows seven columns; on < 768 px it collapses to a single column list without loss of information.  \n6. **Accessibility** – All class cards are reachable via Tab, have appropriate ARIA roles, and screen readers announce date, time, type, and instructor. Automated accessibility test (axe-core) reports zero violations.  \n7. **Timezone Conversion** – When the visitor’s timezone differs from Europe/Berlin, displayed times reflect the visitor’s local time and a note “Zeiten in Ihrer Zeitzone” is visible.  \n8. **Analytics Logging** – Each successful render sends a POST with `event:\"schedule_rendered\"` and correct `count`; each failure sends `event:\"schedule_error\"` with a non‑empty `details` field.  \n9. **Performance** – Initial render (including API call) completes within 800 ms on a 3G connection measured by Lighthouse.  \n10. **Browser Compatibility** – Feature works without degradation on the latest versions of Chrome, Firefox, Safari, and Edge; on browsers lacking CSS Grid, the fallback layout is applied and passes visual regression tests.\n\n### F-09: Course Detail Modal\n\n1. Purpose  \n   Provide visitors with a full, on‑demand view of a specific yoga class (description, instructor, duration, capacity, prerequisites, and enrollment link) without leaving the schedule section, thereby increasing conversion from schedule browsing to booking.\n\n2. Actors  \n   - **Visitor** – interacts with the schedule entry on the landing page.  \n   - **Frontend Application** – HTML/JS/CSS running in the visitor’s browser.  \n   - **Backend API** – REST endpoint that returns detailed course data in JSON format.  \n\n3. Trigger  \n   Visitor clicks (or taps) on a schedule entry card/button representing a single class in the “Kursplan” section.\n\n4. Preconditions  \n   1. The landing page has fully loaded and the schedule grid is rendered.  \n   2. Each schedule entry includes a data attribute `data-course-id` containing a valid UUID.  \n   3. The modal component (`<div id=\"course-detail-modal\">`) exists in the DOM but is hidden (`display:none`).  \n   4. The browser can reach the backend API at `/api/courses/{id}` (CORS allowed).  \n\n5. Main Flow  \n   1. Visitor clicks a schedule entry.  \n   2. Frontend captures the click event on the element with class `.schedule-entry`.  \n   3. Frontend extracts the `data-course-id` value (`COURSE_ID`).  \n   4. Frontend disables page scrolling (`document.body.style.overflow = 'hidden'`).  \n   5. Frontend adds a semi‑transparent overlay element (`<div class=\"modal-backdrop\">`) to the DOM.  \n   6. Frontend sends an asynchronous GET request to `/api/courses/COURSE_ID` with `Accept: application/json`.  \n   7. Backend validates `COURSE_ID`, retrieves the course record, and returns JSON:  \n      ```json\n      {\n        \"id\": \"UUID\",\n        \"title\": \"String\",\n        \"description\": \"String\",\n        \"instructor\": \"String\",\n        \"durationMinutes\": Number,\n        \"capacity\": Number,\n        \"prerequisites\": \"String\",\n        \"enrollmentUrl\": \"String\"\n      }\n      ```  \n   8. Frontend receives the response within 200 ms (network timeout set to 3 s).  \n   9. Frontend populates modal fields:  \n      - `#modal-title` ← `title`  \n      - `#modal-description` ← `description`  \n      - `#modal-instructor` ← `instructor`  \n      - `#modal-duration` ← `durationMinutes` + \" min\"  \n      - `#modal-capacity` ← `capacity` + \" Plätze\"  \n      - `#modal-prerequisites` ← `prerequisites`  \n      - `#modal-enroll` href ← `enrollmentUrl`  \n   10. Frontend sets ARIA attributes: `role=\"dialog\"`, `aria-modal=\"true\"`, `aria-labelledby=\"modal-title\"`.  \n   11. Frontend makes the modal visible (`display:block`) and moves focus to the close button (`#modal-close`).  \n   12. Visitor can close the modal by:  \n       a. Clicking the close button (`#modal-close`).  \n       b. Clicking the overlay backdrop.  \n       c. Pressing the `Esc` key.  \n   13. On close, frontend removes the overlay, restores page scrolling, returns focus to the originally clicked schedule entry, and hides the modal (`display:none`).  \n\n6. Alternate Flows  \n   **A1 – API returns error (404 or 500)**  \n   1. Steps 1‑6 of Main Flow execute.  \n   2. Backend responds with HTTP status ≥400.  \n   3. Frontend displays an error message inside the modal body: “Die Kursdetails konnten nicht geladen werden. Bitte versuchen Sie es später erneut.”  \n   4. All other modal fields remain hidden.  \n   5. Visitor can close the modal using the same mechanisms as in step 12.  \n\n   **A2 – Network timeout (no response within 3 s)**  \n   1. Steps 1‑6 of Main Flow execute.  \n   2. Frontend aborts the request after 3 s.  \n   3. Frontend shows a spinner for 1 s, then replaces it with the same error message as A1.  \n\n   **A3 – Missing `data-course-id` attribute**  \n   1. Visitor clicks an element lacking the attribute.  \n   2. Frontend logs a client‑side error to the console and aborts the flow; no modal is opened.  \n\n7. Postconditions  \n   - **Success path:** Modal is hidden, page scroll restored, and no residual overlay remains. System state is unchanged except that a read‑only API call was logged.  \n   - **Error path:** Modal is displayed with an error message; after closure, the system returns to the same state as the success path.  \n\n8. Data Impact  \n   - Read‑only retrieval of a single course record.  \n   - No creation, update, or deletion of data.  \n   - API call is logged for analytics (timestamp, course ID, response status).  \n\n9. UI Impact  \n   - New modal markup inserted into the landing page HTML template.  \n   - CSS classes: `.modal-backdrop`, `.course-detail-modal`, responsive layout (mobile: full‑width, desktop: centered 600 px).  \n   - JavaScript module `courseDetailModal.js` exposing `initCourseDetailModal()` to bind click listeners.  \n   - Accessibility: focus trap inside modal, `Esc` key handling, ARIA roles, sufficient color contrast.  \n\n10. Acceptance Criteria  \n   1. Clicking any schedule entry opens the modal within 200 ms after the API response.  \n   2. All fields display exactly the data returned by the API; titles, durations, and capacities match the backend values.  \n   3. Modal can be closed by close button, backdrop click, or `Esc` key; after close, focus returns to the original schedule entry.  \n   4. In case of API error or timeout, the error message is shown and the modal remains closable.  \n   5. No page scroll occurs while the modal is open; scroll is restored after close.  \n   6. The modal passes WCAG 2.1 AA accessibility tests (focus trap, ARIA attributes, keyboard operability).  \n   7. Automated unit tests cover: successful data load, API error handling, timeout handling, missing `data-course-id`.  \n   8. End‑to‑end tests verify that a visitor can open a modal, view details, and close it on desktop (Chrome 120) and mobile (iOS Safari 17).\n\n### F-10: Contact Form Component\n\n1. Purpose\nTo provide a mechanism for website visitors to submit inquiries about the yoga studio's offerings and to request booking for specific classes. The component captures essential contact and intent data, facilitates initial qualification, and triggers a notification workflow for studio staff.\n\n2. Actors\n*   **Primary Actor:** Website Visitor (prospective student).\n*   **Secondary Actor:** Studio Staff Member (recipient of form submission notifications).\n\n3. Trigger\nThe visitor scrolls to or clicks on a \"Contact\" or \"Jetzt Anfragen\" (Inquire Now) call-to-action button/link, which expands or navigates to the contact form section.\n\n4. Preconditions\n*   The landing page containing the component has fully loaded.\n*   The visitor's browser supports HTML5 form validation and JavaScript.\n*   A backend API endpoint (`/api/contact-submit`) is available and accessible to receive form data.\n*   An email service (e.g., SendGrid, SMTP) is configured for the studio's contact address.\n\n5. Main Flow\n1.  The visitor views the contact form with the following mandatory fields: Full Name (text), Email Address (email type), Phone Number (tel type), and Message (textarea).\n2.  The visitor enters their data into the form fields.\n3.  The visitor selects the primary reason for contact from a dropdown menu with options: \"Allgemeine Anfrage\" (General Inquiry), \"Kursbuchung\" (Class Booking), \"Preise & Mitgliedschaft\" (Pricing & Membership), \"Sonstiges\" (Other).\n4.  The visitor clicks the \"Absenden\" (Submit) button.\n5.  The client-side JavaScript performs synchronous validation: checks that all fields are non-empty, validates email format, and validates phone number format (e.g., German format validation: optional +49, then 10-13 digits).\n6.  If validation passes, the JavaScript prevents the default form submission, creates a JSON payload from the form data, and sends a `POST` request to the `/api/contact-submit` endpoint.\n7.  The server receives the request, validates the data schema and sanitizes inputs to prevent injection attacks.\n8.  The server creates a new record in the `contact_submissions` database table with fields: `id` (UUID), `name`, `email`, `phone`, `inquiry_type`, `message`, `submitted_at` (timestamp), `status` (default: 'new').\n9.  The server queues an email notification to the studio's designated contact address (e.g., `info@yogastudio-xyz.de`). The email subject includes the inquiry type and the visitor's name. The email body contains all submitted data and a timestamp.\n10. The server returns a `200 OK` response with a JSON object `{ \"success\": true, \"message\": \"Vielen Dank! Wir werden uns zeitnah bei Ihnen melden.\" }`.\n11. The client-side JavaScript receives the successful response, displays the success message in a designated UI feedback area, and disables the submit button to prevent duplicate submissions.\n12. The form fields are cleared or the form is reset.\n\n6. Alternate Flows\n*   **A1: Client-Side Validation Failure:** At step 5, if a field is empty or data format is invalid, the JavaScript highlights the erroneous field(s) with a red border and displays a specific, inline error message (e.g., \"Bitte geben Sie eine gültige E-Mail-Adresse ein.\"). The form is not submitted. The visitor corrects the data and retries step 4.\n*   **A2: Server-Side Validation/Processing Failure:** At step 7 or 8, if the server encounters an error (e.g., database connection failure, invalid data schema), it returns a `5xx` or `400` error response. The client-side JavaScript receives the non-200 response, displays a generic error message in the feedback area (\"Ein technischer Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.\"), and re-enables the submit button. The visitor can retry submission.\n*   **A3: Network Failure:** The `POST` request at step 6 fails to complete (e.g., user loses connection). The client-side JavaScript's fetch/catch block detects the failure, displays the same generic error message as in A2, and re-enables the submit button.\n*   **A4: User Navigation During Submission:** After clicking submit but before the server responds, the visitor navigates away from the page. The browser aborts the pending request. No data is saved, and no notification is sent. The visitor must resubmit.\n\n7. Postconditions\n*   A new, persistent contact submission record exists in the system database with a 'new' status.\n*   An email notification containing the submission details has been queued for delivery to the studio's inbox.\n*   The website visitor has received clear visual feedback (success or error message) regarding their submission attempt.\n*   The form UI is in a reset state (success) or retains entered data with error highlights (failure).\n\n8. Data Impact\n*   **Database:** A new row is inserted into the `contact_submissions` table. No existing user data is modified.\n*   **Session:** No session data is created or modified for anonymous visitors.\n*   **External Systems:** An email is generated and sent to the studio's external email service provider.\n\n9. UI Impact\n*   The form component must be responsive and function on mobile and desktop.\n*   It must include:\n    *   Text input fields with associated `<label>` tags.\n    *   A dropdown (`<select>`) for inquiry type.\n    *   A textarea for the message.\n    *   A primary action button (\"Absenden\").\n    *   A dedicated, prominent area (e.g., `<div>` with ARIA live region) for displaying success or error feedback messages.\n    *   Visual validation states (e.g., red borders, helper text) for invalid fields.\n    *   Loading state on the submit button (e.g., spinner or \"Wird gesendet...\") during the API request.\n    *   Disabled state on the submit button after successful submission.\n\n10. Acceptance Criteria\n*   **AC1:** The form renders correctly with all specified fields (Name, Email, Phone, Inquiry Type dropdown, Message) and the submit button.\n*   **AC2:** Attempting to submit an empty form triggers client-side validation errors on all required fields.\n*   **AC3:** Submitting an invalid email address (e.g., \"test@\") triggers a specific client-side validation error on the email field.\n*   **AC4:** Submitting a valid form results in a `200` response from the backend, a success message is displayed to the user, and the form is cleared/disabled.\n*   **AC5:** A new record with correct data is created in the `contact_submissions` database table upon a valid submission.\n*   **AC6:** A notification email is successfully queued for delivery to the studio's contact address within 5 seconds of a valid form submission.\n*   **AC7:** If the backend returns any non-200 response, a generic error message is displayed to the user, and the submit button is re-enabled.\n*   **AC8:** The form is fully navigable and operable via keyboard (Tab key) and is compatible with screen readers (proper labels, ARIA attributes for dynamic feedback).\n\n### F-11: Form Validation Logic\n\n1. Purpose\nTo ensure only complete and syntactically valid data is submitted via the contact form, preventing server-side processing of incomplete inquiries and improving data quality for the yoga studio.\n\n2. Actors\nEnd-user (website visitor filling the contact form).\n\n3. Trigger\nUser attempts to submit the contact form by clicking the \"Submit\" button or pressing Enter within a form field.\n\n4. Preconditions\nThe contact form is fully rendered in the user's browser with the following required fields identified: `name` (text), `email` (email), `message` (textarea). The form's submit event is bound to a validation function.\n\n5. Main Flow\n1.  User initiates form submission.\n2.  Validation function intercepts the form's native submit event, preventing default submission behavior.\n3.  Function clears all previous inline error messages and visual error indicators (e.g., red borders) from all form fields.\n4.  Function initializes a boolean flag `isValid` to `true`.\n5.  For each field in the `requiredFields` list (`name`, `email`, `message`):\n    a. Function checks if the field's trimmed value is an empty string.\n    b. If empty:\n        i. Function sets `isValid` to `false`.\n        ii. Function adds a specific error message element (e.g., `<span class=\"error-message\">This field is required</span>`) immediately after the field.\n        iii. Function adds a CSS class (e.g., `input-error`) to the field's container to apply visual styling (e.g., red border).\n6.  For the `email` field specifically:\n    a. If the field is non-empty, function tests the value against a standard email regular expression pattern (e.g., `/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/`).\n    b. If the pattern does not match:\n        i. Function sets `isValid` to `false`.\n        ii. Function adds the error message \"Please enter a valid email address\" after the email field.\n        iii. Function applies the `input-error` class to the email field's container.\n7.  After all validations, function checks the final state of `isValid`.\n8.  If `isValid` remains `true`, the function programmatically triggers the form's native submission (e.g., `form.submit()` or allows the event to proceed).\n9.  If `isValid` is `false`, the function focuses the first invalid field and terminates without submitting the form.\n\n6. Alternate Flows\n*   **A1: User corrects an error and resubmits.** After an initial failed validation with visible errors, the user amends the data in one or more fields and clicks submit again. The validation function re-executes from Step 3, clearing old errors and re-validating all fields based on the new input.\n*   **A2: Email field contains only whitespace.** The trimmed value check in Step 5a correctly identifies a whitespace-only string as empty, triggering the \"required\" error message, not the \"invalid format\" message.\n*   **A3: Form contains optional fields.** The validation logic explicitly ignores any fields not listed in the `requiredFields` array, so their content (or lack thereof) does not affect the `isValid` flag.\n\n7. Postconditions\n*   **Successful Submission:** The form data is transmitted to the server endpoint specified in the form's `action` attribute. No client-side error indicators are present.\n*   **Failed Submission:** The form remains on the page. One or more fields have a visual error indicator (CSS class applied). Corresponding textual error messages are visible in the DOM adjacent to the invalid fields. The `isValid` flag is `false`. Focus is set on the first invalid field.\n\n8. Data Impact\nNo persistent data is stored or modified on the client. Temporary validation state (`isValid` flag, error message elements) exists only in the current page session. Valid form data is prepared for transmission upon successful validation.\n\n9. UI Impact\n*   Dynamic insertion and removal of `<span class=\"error-message\">` elements into the DOM after specific form fields.\n*   Application and removal of a CSS class (e.g., `input-error`) on field container elements to change their border color to red.\n*   Programmatic focus management to the first invalid field upon validation failure.\n*   The submit button's default behavior is conditionally allowed or blocked by the JavaScript event handler.\n\n10. Acceptance Criteria\n1.  **AC1:** Attempting to submit the form with the `name` field empty displays a \"This field is required\" error message next to the name field and prevents submission.\n2.  **AC2:** Attempting to submit the form with the `email` field empty displays a \"This field is required\" error message next to the email field and prevents submission.\n3.  **AC3:** Attempting to submit the form with an `email` value of \"invalid-email\" displays a \"Please enter a valid email address\" error message and prevents submission.\n4.  **AC4:** Attempting to submit the form with a `message` field empty displays a \"This field is required\" error message next to the message field and prevents submission.\n5.  **AC5:** Submitting the form with all required fields filled and a syntactically valid email (e.g., \"test@example.com\") does not display any error messages and allows the form to submit.\n6.  **AC6:** Correcting a previously invalid field and resubmitting clears the old error message for that field and re-validates the entire form.\n7.  **AC7:** Validation logic executes on every submit attempt, clearing all previous errors before performing new checks.\n\n### F-12: Form Submission Handling (Email Notification)\n\n1. Purpose  \n   Enable the landing page to transmit the data entered in the contact form to the studio’s designated email address, providing immediate notification of visitor inquiries and persisting the inquiry data for audit purposes.\n\n2. Actors  \n   - **Visitor** – person who fills out and submits the contact form.  \n   - **Web Browser (Client)** – executes the front‑end JavaScript and sends the HTTP request.  \n   - **Web Server / API Endpoint** – receives the request, validates data, stores the record, and triggers email dispatch.  \n   - **Email Service Provider (ESP)** – external SMTP server or transactional‑email API (e.g., SendGrid, Mailgun) that actually delivers the email.  \n   - **Database** – persistent store for submitted inquiries.\n\n3. Trigger  \n   Visitor clicks the “Senden” button on the contact form after all required fields are filled.\n\n4. Preconditions  \n   1. The contact form is rendered with the fields: Name (text, required), E‑Mail (email, required, valid format), Telefon (text, optional), Nachricht (textarea, required, max 500 characters).  \n   2. Client‑side validation has passed (required fields present, email format correct, message length ≤ 500).  \n   3. reCAPTCHA v2 (or equivalent) token has been obtained and attached to the form data.  \n   4. The API endpoint `/api/contact` is reachable (HTTP 200 on health‑check).  \n   5. The ESP credentials (API key or SMTP credentials) are stored securely in the server environment.\n\n5. Main Flow  \n   1. **Submit Request** – The browser sends an HTTPS POST to `/api/contact` with a JSON payload containing the form fields and the reCAPTCHA token.  \n   2. **Rate‑limit Check** – The server middleware checks the visitor’s IP against a sliding‑window limit of 5 submissions per hour; if exceeded, respond with HTTP 429.  \n   3. **reCAPTCHA Verification** – Server calls Google reCAPTCHA verification endpoint; if verification fails, respond with HTTP 400 and error “captcha_invalid”.  \n   4. **Server‑side Validation** – Server validates each field (non‑empty, email regex, message length). On failure, respond with HTTP 422 and a field‑error map.  \n   5. **Persist Inquiry** – Insert a new record into table `contact_inquiries` with columns: `id` (UUID), `name`, `email`, `phone`, `message`, `submitted_at` (UTC timestamp), `ip_address`, `captcha_status`.  \n   6. **Compose Email** – Build an email object:  \n      - **From:** `no-reply@<studio-domain>`  \n      - **To:** `studio@example.com` (configurable)  \n      - **Subject:** “Neue Kontaktanfrage von <Name>”  \n      - **Body (HTML & plain‑text):** includes all submitted fields and the submission timestamp.  \n   7. **Send Email** – Invoke the ESP SDK or SMTP client with the composed email.  \n   8. **Email Success Check** – If ESP returns success status (e.g., 202 Accepted), continue; otherwise log error and proceed to step 10.  \n   9. **Respond to Client** – Return HTTP 200 with JSON `{ \"status\": \"success\", \"message\": \"Ihre Anfrage wurde gesendet.\" }`.  \n   10. **Failure Handling** – If email dispatch fails, update the `contact_inquiries` record with `email_sent = false` and `email_error = <error_message>`. Respond to client with HTTP 500 and JSON `{ \"status\": \"error\", \"message\": \"Technischer Fehler – bitte später erneut versuchen.\" }`.\n\n6. Alternate Flows  \n   - **A1 – Validation Error (Step 4)**  \n     1. Server detects missing or malformed fields.  \n     2. Respond with HTTP 422 and a JSON payload listing each invalid field and an error message.  \n     3. Client displays the errors inline next to the corresponding inputs.  \n\n   - **A2 – reCAPTCHA Failure (Step 3)**  \n     1. Verification endpoint returns `success: false`.  \n     2. Respond with HTTP 400 and error code `captcha_invalid`.  \n     3. Client shows a generic “Bitte bestätigen Sie, dass Sie kein Bot sind.” message and forces a new captcha challenge.  \n\n   - **A3 – Email Service Unavailable (Step 8)**  \n     1. ESP returns a non‑2xx status or times out.  \n     2. Server logs the failure, marks the inquiry as `email_sent = false`.  \n     3. Server retries email dispatch up to 2 additional times with exponential back‑off (2 s, 4 s).  \n     4. If all retries fail, proceed to step 10 of the Main Flow.  \n\n   - **A4 – Database Write Failure (Step 5)**  \n     1. INSERT operation throws an exception (e.g., deadlock, constraint violation).  \n     2. Server rolls back the transaction, logs the error, and returns HTTP 500 with message “Datenbankfehler – bitte später erneut versuchen.”  \n     3. No email is sent.\n\n7. Postconditions  \n   - A new row exists in `contact_inquiries` with `email_sent = true` (or false if email failed) and accurate timestamps.  \n   - If email dispatch succeeded, the studio’s inbox receives a correctly formatted message containing all submitted data.  \n   - The client receives a JSON response indicating success or the specific error that occurred.  \n   - All events (submission, validation outcome, email status) are logged to the application log with correlation ID.\n\n8. Data Impact  \n   - **Database:** Table `contact_inquiries` grows by one row per successful POST. Columns: `id` (UUID, primary key), `name` (VARCHAR 255), `email` (VARCHAR 255), `phone` (VARCHAR 50, nullable), `message` (TEXT), `submitted_at` (TIMESTAMP UTC), `ip_address` (INET), `captcha_status` (ENUM ['valid','invalid']), `email_sent` (BOOLEAN), `email_error` (TEXT, nullable).  \n   - **Logs:** Each submission creates an INFO log entry with correlation ID; failures create WARN/ERROR entries.  \n   - **Email Service:** One outbound email transaction per successful submission; failure attempts are recorded in ESP’s activity logs.\n\n9. UI Impact  \n   - **Success State:** After receiving HTTP 200, the front‑end replaces the form with a green success banner: “Ihre Anfrage wurde gesendet.”  \n   - **Validation Errors:** Inline error messages appear beneath each offending field; the form remains populated with previously entered values.  \n   - **Captcha Error:** A red banner appears above the form: “Bitte bestätigen Sie, dass Sie kein Bot sind.” and the captcha widget is reset.  \n   - **Server Error:** A red banner appears: “Technischer Fehler – bitte später erneut versuchen.” The form data is preserved for resubmission.  \n   - **Rate‑limit Exceeded:** Red banner: “Zu viele Anfragen – bitte versuchen Sie es in einer Stunde erneut.”  \n\n10. Acceptance Criteria  \n   1. Submitting a fully valid form results in an email delivered to `studio@example.com` within 5 seconds of the HTTP 200 response.  \n   2. The email contains all fields exactly as entered, with proper HTML escaping to prevent injection.  \n   3. Invalid client‑side data (e.g., missing name) prevents the POST request; server‑side validation also blocks malformed data and returns HTTP 422 with correct field error mapping.  \n   4. reCAPTCHA failures return HTTP 400 with error code `captcha_invalid` and display the appropriate UI message.  \n   5. When the ESP is unreachable, the system retries twice, logs each attempt, and finally returns HTTP 500 with the generic error message while persisting the inquiry with `email_sent = false`.  \n   6. Rate limiting blocks the 6th submission from the same IP within one hour, returning HTTP 429 and the UI shows the rate‑limit banner.  \n   7. All persisted records include a non‑null UUID, accurate UTC timestamp, and the visitor’s IP address.  \n   8. No sensitive data (e.g., ESP API key) is exposed to the client; it is stored only in server environment variables.  \n   9. Unit tests cover: successful flow, each alternate flow (validation error, captcha error, email failure, DB failure, rate limit).  \n   10. Load test with 100 concurrent submissions shows no loss of data and email delivery success rate ≥ 99 %.\n\n### F-13: CAPTCHA Integration for Contact Form\n\n1. Purpose\nTo integrate a challenge-response test (CAPTCHA) into the contact form to distinguish human users from automated bots, thereby preventing spam submissions, protecting form data integrity, and reducing manual processing overhead.\n\n2. Actors\n- Visitor (End User)\n- System (Backend Server & Frontend Interface)\n\n3. Trigger\nThe Visitor clicks the \"Submit\" button on the contact form.\n\n4. Preconditions\n- The contact form is fully rendered on the webpage.\n- A CAPTCHA service provider (e.g., Google reCAPTCHA v2/v3, hCaptcha) has been selected and the corresponding site key and secret key are configured in the system's environment variables or configuration management.\n- The frontend codebase includes the necessary CAPTCHA provider's JavaScript library.\n- The backend server has an outbound internet connection to verify the CAPTCHA response token with the provider's API.\n\n5. Main Flow\n1.  Visitor fills out all required fields in the contact form (Name, Email, Message).\n2.  The CAPTCHA widget (e.g., \"I'm not a robot\" checkbox, invisible score-based challenge) is rendered within the form as the last focusable element.\n3.  Visitor interacts with the CAPTCHA widget. For an interactive challenge, they complete the task (e.g., select images). For an invisible challenge, the provider's script analyzes user behavior and assigns a risk score.\n4.  Upon successful CAPTCHA completion/validation by the provider, a unique response token (`g-recaptcha-response` or equivalent) is generated and attached to the form data.\n5.  Visitor clicks the \"Submit\" button. The frontend JavaScript prevents the default form submission if the CAPTCHA token is absent or invalid.\n6.  The form data, including the CAPTCHA response token, is sent via an HTTPS POST request to the backend endpoint (e.g., `/api/contact-submit`).\n7.  The backend server receives the request and extracts the CAPTCHA response token and the user's IP address.\n8.  The backend constructs a verification request to the CAPTCHA provider's secret verification endpoint (e.g., `https://www.google.com/recaptcha/api/siteverify`), including the secret key, the response token, and the remote IP.\n9.  The backend sends the verification request to the provider's API and awaits the JSON response.\n10. The backend parses the provider's response. If the `success` field is `true` (and for score-based systems, if the `score` meets a predefined threshold, e.g., >0.5), the submission is considered human.\n11. The backend proceeds to validate the other form fields (email format, message length).\n12. If all validations pass, the backend processes the submission (e.g., sends an email to the studio, stores in database) and returns a `200 OK` response with a success message.\n13. The frontend receives the success response and displays a confirmation message to the Visitor (e.g., \"Message sent successfully!\").\n\n6. Alternate Flows\nA. CAPTCHA Verification Fails (Bot Detected):\n   1. At step 9, the provider's response has `success: false` or the score is below the threshold.\n   2. The backend immediately halts processing.\n   3. The backend returns a `403 Forbidden` or `400 Bad Request` response with a specific error code (e.g., `CAPTCHA_FAILED`).\n   4. The frontend receives the error response and displays a clear, user-friendly error message adjacent to the CAPTCHA widget (e.g., \"CAPTCHA verification failed. Please try again.\"). The form data for other fields is preserved.\n   5. The Visitor must re-attempt the CAPTCHA and resubmit.\n\nB. CAPTCHA Service Unavailable:\n   1. At step 8 or 9, the backend's request to the CAPTCHA provider's API fails (network timeout, DNS error, 5xx response).\n   2. The backend logs the critical error.\n   3. The backend is configured with a fail-safe policy (e.g., `CAPTCHA_ON_FAIL=REJECT`). It rejects the submission and returns a `503 Service Unavailable` response with a generic error message (\"Service temporarily unavailable. Please try later.\").\n   4. *Alternative Policy:* If configured with `CAPTCHA_ON_FAIL=ACCEPT` (not recommended for high-risk forms), the backend would proceed with submission after logging a warning, but this flow is not the primary spec.\n\nC. Visitor Uses Accessibility Tool (e.g., Screen Reader):\n   1. The CAPTCHA widget implementation must be fully accessible (WCAG 2.1 AA compliant).\n   2. For an audio challenge, the Visitor activates the audio option via the widget's accessible controls.\n   3. The Visitor listens to the audio challenge and enters the correct numbers/words.\n   4. The flow proceeds to Main Flow step 4. If the audio challenge fails, Alternate Flow A is triggered.\n\n7. Postconditions\n- **Success:** The contact form submission data is processed (e.g., emailed, stored), and the Visitor sees a success confirmation. The CAPTCHA token is consumed and cannot be reused.\n- **Failure (Bot/Invalid):** The submission is rejected and discarded. No data is stored or emailed. The Visitor sees an error message and must correct the CAPTCHA. The form data for other fields may be preserved in the frontend state.\n- **Failure (Service):** The submission is rejected. The system logs the service outage. The Visitor sees a generic service unavailability message.\n\n8. Data Impact\n- **New Data Stored:** None from the CAPTCHA itself (tokens are single-use and ephemeral). Only the standard contact form data (name, email, message, timestamp, IP) is stored upon successful submission.\n- **Logging:** Backend must log CAPTCHA verification attempts, including: timestamp, IP address, form endpoint, provider's `success`/`score`/`error-codes`, and final submission outcome (accepted/rejected). This is critical for monitoring spam attacks and tuning thresholds.\n- **Configuration:** New environment/configuration variables are required: `CAPTCHA_PROVIDER` (e.g., `recaptcha_v2`, `hcaptcha`), `CAPTCHA_SITE_KEY`, `CAPTCHA_SECRET_KEY`, `CAPTCHA_SCORE_THRESHOLD` (if applicable), `CAPTCHA_ON_FAIL` policy.\n\n9. UI Impact\n- The contact form HTML must be modified to include a container element for the CAPTCHA widget (e.g., `<div class=\"g-recaptcha\" data-sitekey=\"...\"></div>`).\n- The widget must be placed logically within the form, typically after the last input field and before the submit button.\n- The form's submit button must have its default event handler augmented to check for the presence of a valid CAPTCHA token before allowing submission (for invisible/score-based CAPTCHAs, this check is handled by the provider's callback).\n- Clear, accessible error messages for CAPTCHA failure must be displayed in a dedicated `div` associated with the widget (using `aria-live=\"polite\"`).\n- The overall form layout must accommodate the widget's size without breaking responsive design.\n\n10. Acceptance Criteria\n- **AC1 (Spam Block):** Automated bot submissions (simulated via scripted POST requests without a valid CAPTCHA token) are rejected by the backend with a `403`/`400` response and do not result in stored data or sent emails.\n- **AC2 (Human Success):** A human user can successfully complete the CAPTCHA challenge, submit the form, and receive a success confirmation. The studio receives the email/notification with the correct form data.\n- **AC3 (UI Element):** The CAPTCHA widget is visibly present on the contact form page for all users (desktop/mobile). It is keyboard-navigable and operable.\n- **AC4 (Error Handling):** On CAPTCHA failure (e.g., user selects wrong images), the frontend displays a clear, specific error message without clearing other form fields. The user can retry the CAPTCHA.\n- **AC5 (Performance):** The addition of the CAPTCHA does not increase the page's Time-to-Interactive (TTI) by more than 500ms on a standard 3G connection (measured via Lighthouse). The backend verification adds less than 200ms average latency to the form submission API response time.\n- **AC6 (Logging):** All CAPTCHA verification attempts (success/failure, score, error codes) are logged with sufficient detail for audit and debugging.\n- **AC7 (Accessibility):** The CAPTCHA implementation passes an automated accessibility scan (e.g., axe-core) for the contact form page with 0 violations related to the widget. Audio challenge is functional.\n\n### F-14: Footer with Address, Hours, and Copyright\n\n1. Purpose\nTo display the yoga studio's static contact information, operational hours, and mandatory legal copyright notice at the bottom of every page, ensuring compliance and providing essential details to visitors.\n\n2. Actors\nPrimary: Website Visitor (views the footer).\nSecondary: Studio Administrator (provides source data; no direct interface).\n\n3. Trigger\nThe browser completes rendering the main page content and reaches the footer section in the HTML document structure.\n\n4. Preconditions\n- The HTML document contains a dedicated `<footer>` element with a specific ID or class (e.g., `#site-footer`).\n- Source data for the studio address, opening hours, and studio name is available in a defined configuration (e.g., a JSON file, environment variables, or hardcoded in the template).\n- The viewport meta tag is set for responsive design.\n\n5. Main Flow\n1.  The browser parses the HTML and encounters the `<footer>` element.\n2.  The footer container `<div>` is rendered with a CSS class `footer-container`.\n3.  The address block is rendered as a `<div>` with class `footer-address`. It contains:\n    a.  Studio name as an `<h3>` or `<strong>` element.\n    b.  Street address, postal code, and city as separate `<p>` or `<span>` elements.\n    c.  Phone number as a `tel:` link.\n4.  The opening hours block is rendered as a `<div>` with class `footer-hours`. It contains:\n    a.  A heading \"Öffnungszeiten\" (or equivalent).\n    b.  An unordered list `<ul>` where each `<li>` contains a day (e.g., \"Mo-Fr\") and corresponding time (e.g., \"08:00 - 20:00\").\n5.  The copyright block is rendered as a `<div>` with class `footer-copyright`. It contains a `<p>` element with the text: `© [CurrentYear] [StudioName]. Alle Rechte vorbehalten.`\n6.  CSS styles are applied to arrange the three blocks (address, hours, copyright) in a responsive flexbox or grid row on desktop (min-width: 768px) and a stacked column on mobile.\n7.  The footer is visually separated from the main content by a top border and has a dark background (e.g., `#2d3748`) with light text (e.g., `#e2e8f0`).\n\n6. Alternate Flows\nA1. **Missing Address Data:** If the source address string is empty, the `footer-address` block is not rendered, and the remaining blocks reflow to fill the space.\nA2. **Mobile Layout:** On viewport width < 768px, the flex direction changes to `column`, items are centered (`align-items: center`), and padding is reduced to `1rem`.\nA3. **Dynamic Year:** If the implementation uses a static year in the data, the copyright displays that year. If a dynamic year is implemented (e.g., via JavaScript `new Date().getFullYear()`), the script executes after DOM load to replace a placeholder token.\n\n7. Postconditions\n- The footer is visibly rendered at the bottom of the viewport or page content.\n- All provided data (address, hours, studio name) is accurately displayed in the specified format.\n- The page's overall layout is not broken; the footer does not overlap main content.\n- The copyright notice is present and legible.\n\n8. Data Impact\n- **Read:** The feature reads static configuration data (`studioAddress`, `studioHours`, `studioName`, `copyrightYear`).\n- **Write:** No data is written to any database or file. The data source is read-only for this feature.\n- **Storage:** Source data resides in a configuration file (e.g., `config/footer.json`) or within the frontend template file (e.g., `footer.html` or a component).\n\n9. UI Impact\n- **Structure:** A new `<footer>` section is added to the base HTML layout template.\n- **Styling:** New CSS classes (`.footer-container`, `.footer-address`, `.footer-hours`, `.footer-copyright`) are defined in the main stylesheet. Styles include flexbox layout, responsive breakpoints, typography, color, and spacing.\n- **Responsiveness:** The footer layout changes from a 3-column row on desktop to a single-column stack on mobile devices.\n- **Accessibility:** Text contrast ratios meet WCAG AA standards. The phone number link uses the `tel:` protocol correctly.\n\n10. Acceptance Criteria\n- **AC1:** On a desktop viewport (≥768px), the address, opening hours, and copyright are displayed side-by-side in a single row with sufficient spacing.\n- **AC2:** On a mobile viewport (<768px), the three blocks are displayed in a single vertical column, centered, with appropriate vertical spacing.\n- **AC3:** The address block correctly displays the full street, city, and phone number as defined in the source data.\n- **AC4:** The opening hours list displays each day-time pair on a separate line, using the exact format from the source data.\n- **AC5:** The copyright text includes the correct studio name and either the specified static year or the current calendar year.\n- **AC6:** The footer has a distinct background color from the main page content and a top border separator.\n- **AC7:** No console errors or warnings are thrown during page load related to the footer component.\n- **AC8:** The footer remains at the bottom of the page (either sticky or static after content) without overlapping other elements.\n\n### F-15: Social Media Icon Links\n\n1. Purpose\nTo provide website visitors with direct, one-click access to the yoga studio's official social media profiles (Facebook, Instagram, YouTube) to increase follower counts, engagement, and brand awareness beyond the website.\n\n2. Actors\n- Primary: Website Visitor (any user accessing the landing page).\n- Secondary: Studio Administrator (responsible for providing and updating the target URLs).\n\n3. Trigger\nThe rendering of the landing page's footer or a dedicated \"Connect\" section is initiated by the user's browser requesting and parsing the HTML/CSS/JS of the page.\n\n4. Preconditions\n- The studio administrator has provided valid, absolute URLs for the Facebook, Instagram, and YouTube profiles in the system's configuration or CMS.\n- The frontend assets (SVG icon files or a licensed icon font like FontAwesome) for the specified social platforms are available and deployed with the website.\n- The user's browser has JavaScript enabled (if analytics tracking is implemented via JS) and supports the rendering of the icon format used (SVG/icon font).\n\n5. Main Flow\n1.  The user's browser loads the landing page HTML.\n2.  The browser parses the HTML and encounters the `<nav>` or `<div>` container designated for social links (e.g., with class `social-links`).\n3.  For each configured platform (Facebook, Instagram, YouTube):\n    a.  The system retrieves the stored absolute URL (e.g., `https://www.facebook.com/StudioName`) from the configuration.\n    b.  The system generates an anchor (`<a>`) element with:\n        - `href` attribute set to the retrieved URL.\n        - `target=\"_blank\"` and `rel=\"noopener noreferrer\"` attributes for security and UX.\n        - A unique, accessible `aria-label` (e.g., `aria-label=\"Follow us on Facebook\"`).\n    c.  Within the anchor, the system inserts the corresponding platform's icon (via `<svg>` or `<i>` tag).\n4.  The browser renders the clickable icon elements in the specified location (e.g., footer).\n5.  The user clicks on a specific platform icon.\n6.  The browser opens the `href` URL in a new tab/window, navigating to the studio's social media profile page.\n\n6. Alternate Flows\n- **A1: Missing or Invalid URL Configuration.** If a platform's URL is empty or malformed in the configuration:\n    - The system does not render the anchor element or icon for that specific platform.\n    - No clickable element is presented for the missing platform.\n- **A2: Icon Asset Fails to Load.** If the icon file (SVG/font) is corrupted or missing:\n    - The browser may display a broken image icon or an empty space.\n    - The anchor element with the correct `href` and `aria-label` is still rendered and clickable, but lacks visual branding.\n- **A3: User Disables Pop-ups/New Tabs.** If the user's browser is configured to block new tabs/windows:\n    - The social media profile may open in the current tab, replacing the studio's landing page, or the action may be blocked entirely based on browser settings.\n\n7. Postconditions\n- For the User: The user's current browser session now has an additional tab/window open pointing to the selected social media platform, or the current tab has navigated away from the studio's site.\n- For the System: An optional analytics event (e.g., `social_click`) with parameters `{platform: 'facebook'}` may have been logged to the analytics service if implemented.\n\n8. Data Impact\n- **Read:** The feature reads three data points from persistent storage/configuration: `social_url_facebook`, `social_url_instagram`, `social_url_youtube`.\n- **Write (Optional):** If click analytics are implemented, each icon click writes an event log to the analytics database/service, incrementing a counter for the specific platform.\n- **No** user-generated data is stored or processed by this feature itself.\n\n9. UI Impact\n- **Placement:** A container (e.g., `<div class=\"social-icons\">`) must be present in the landing page's HTML structure, typically in the global footer or a specific \"Connect\" section.\n- **Styling:** CSS rules must define the size, color, spacing, and hover effects (e.g., color change, slight scale) for the icons to match the site's design system.\n- **Accessibility:** Each icon link must have a clear `aria-label`. The container may have a heading like \"Follow Us\" with `aria-hidden=\"true\"` if decorative.\n- **Responsiveness:** Icons must remain properly sized and spaced on all viewport sizes (mobile, tablet, desktop).\n\n10. Acceptance Criteria\n- **AC1:** The landing page footer displays three distinct, recognizable icons for Facebook, Instagram, and YouTube.\n- **AC2:** Each icon is a functional hyperlink. Clicking the Facebook icon opens the exact URL configured for `social_url_facebook` in a new browser tab.\n- **AC3:** The `target=\"_blank\"` and `rel=\"noopener noreferrer\"` attributes are present on all generated anchor tags (verified via browser DevTools).\n- **AC4:** Each icon link has a unique, descriptive `aria-label` (e.g., \"Visit our Instagram profile\").\n- **AC5:** If a URL is removed from the configuration, the corresponding icon disappears from the page entirely.\n- **AC6:** Icons adhere to the specified design specifications for size, color, and hover state (verified via visual QA and CSS inspection).\n- **AC7 (Optional):** A click on an icon successfully logs an analytics event with the correct `platform` parameter to the designated analytics endpoint.\n\n### F-16: Google Maps Embed\n\n1. Purpose\nTo embed an interactive Google Map on the studio's website, precisely pinpointing the physical location of the yoga studio. This allows website visitors to visually identify the studio's address, get directions, and explore the surrounding area, thereby facilitating physical visits and supporting the goal of increasing studio foot traffic.\n\n2. Actors\n*   Primary: Website Visitor (any user accessing the landing page).\n*   Secondary: Studio Administrator (for initial configuration and potential address updates).\n\n3. Trigger\nThe map is rendered automatically when a visitor navigates to the webpage section containing the location information (typically within the \"Kontakt\" or a dedicated \"Anfahrt\" section).\n\n4. Preconditions\n*   The studio has a verified, precise physical address (street, postal code, city).\n*   A valid Google Maps Platform API key with the \"Maps JavaScript API\" and \"Places API\" (optional for address autocomplete in admin) enabled is generated and stored securely in the website's configuration environment.\n*   The website's domain is authorized for use with the API key in the Google Cloud Console.\n*   The backend/content management system (if any) has a field to store and manage the studio's address string.\n\n5. Main Flow\n1.  The visitor's browser loads the HTML page containing the map container element (e.g., `<div id=\"studio-map\"></div>`).\n2.  The page's JavaScript executes and initializes the Google Maps JavaScript API using the stored API key.\n3.  The script creates a new `google.maps.Map` instance, binding it to the container element.\n4.  The script geocodes the stored studio address string (e.g., \"Yogastudio Namaste, Hauptstraße 10, 12345 Berlin\") into geographic coordinates (latitude/longitude).\n5.  A `google.maps.Marker` is created with the obtained coordinates and placed on the map at the studio's location.\n6.  The map's center is set to the marker's position, and a default zoom level (e.g., 15) is applied.\n7.  The fully interactive map (supporting pan, zoom, street view toggle) is rendered within the designated container for the visitor.\n\n6. Alternate Flows\n*   **A1: Invalid or Missing API Key:** The API script fails to load or returns an error. The system detects the load failure and displays a static, non-interactive image of the map (a pre-generated screenshot of the correct location) within the container, along with a text link to open the location in a new Google Maps tab.\n*   **A2: Geocoding Failure:** The provided address string is ambiguous or invalid and cannot be converted to coordinates. The map initializes at a default fallback location (e.g., the city center) with a warning message visible to the user: \"Konnte die genaue Adresse nicht auf der Karte finden. Bitte nutzen Sie die Adressangabe unten.\" The static address text remains visible.\n*   **A3: Network/API Quota Error:** The Google Maps API request fails due to network issues or exceeded quota. The system implements a retry logic (e.g., one retry after 2 seconds). If the retry also fails, it falls back to the static image solution described in A1.\n\n7. Postconditions\n*   The map container in the DOM is populated with either the interactive map or a defined fallback (static image + message).\n*   The visitor can see a representation of the studio's location.\n*   No personal user data is stored by the map interaction. Standard Google Maps API usage logs (IP, request timestamp) are generated by Google's servers as per their privacy policy.\n\n8. Data Impact\n*   **Read:** The system reads the stored studio address string from the website's configuration/ CMS.\n*   **Write:** None. The feature is read-only.\n*   **External Calls:** Multiple calls to Google Maps Platform endpoints: Maps JavaScript API library, Geocoding API (to convert address to coordinates). These are client-side from the visitor's browser.\n*   **Caching:** Browser caching of the Google Maps API library script is expected. No application-level caching of coordinates is strictly required, but recommended for performance (cache geocoding result for the address).\n\n9. UI Impact\n*   **New Element:** A `<div>` container with a specific ID/class is added to the contact/location page.\n*   **Dimensions:** The container must have explicit width (100% of parent) and height (e.g., 400px or 60vh) defined in CSS to render correctly.\n*   **Responsive:** The map must resize fluidly within its container on different screen sizes.\n*   **Loading State:** A subtle loading spinner or skeleton placeholder should be visible in the container before the map initializes.\n*   **Fallback Styling:** The static fallback image must be styled to match the container dimensions and have an `alt` attribute describing the map.\n\n10. Acceptance Criteria\n*   **AC1:** On the live site, the map section loads within 3 seconds on a standard connection and displays an interactive map centered on the studio's correct, verified address.\n*   **AC2:** A visible marker (default Google Maps pin) is placed exactly at the studio's geocoded coordinates.\n*   **AC3:** The map is fully interactive; the user can zoom in/out, pan, and switch to satellite/street view.\n*   **AC4:** The map container is responsive and maintains correct aspect ratio/functionality on mobile viewports (<768px width).\n*   **AC5:** If the API key is manually invalidated in the config, the page gracefully shows the static fallback image and a functional external link to Google Maps for the studio address, with no JavaScript errors breaking the page layout.\n*   **AC6:** The geocoded coordinates correspond to the studio's address when manually verified via the Google Maps website.\n\n### F-17: SEO Meta Tags (Title & Description)\n\n1. Purpose\nTo improve search engine visibility and click-through rates by programmatically inserting optimized, page-specific `<title>` and `<meta name=\"description\">` tags into the HTML `<head>` of each landing page.\n\n2. Actors\n- Primary: Search Engine Crawlers (e.g., Googlebot)\n- Secondary: Content Administrator (via CMS)\n\n3. Trigger\nAn HTTP GET request for any page of the landing page (e.g., `/`, `/leistungen`, `/kursplan`, `/kontakt`).\n\n4. Preconditions\n- The requested page route is defined and resolvable.\n- Page-level SEO metadata (title, description) is either:\n  a) Pre-configured and stored in the site's data source (e.g., CMS, JSON config), OR\n  b) A site-wide default metadata set is defined as a fallback.\n\n5. Main Flow\n1.  The web server receives an HTTP GET request for a specific page route (e.g., `/kursplan`).\n2.  The server-side rendering logic (or static site generator build step) resolves the requested route to its corresponding page component/template.\n3.  The rendering logic queries the data source for the page-specific SEO metadata object using the route identifier.\n4.  If a page-specific metadata object is found, its `title` and `description` values are retrieved. If not found, the system retrieves the site-wide default `title` and `description` values.\n5.  The retrieved `title` string is sanitized to ensure it does not exceed 60 characters and is encoded for HTML.\n6.  The retrieved `description` string is sanitized to ensure it does not exceed 160 characters and is encoded for HTML.\n7.  The rendering engine injects the sanitized `title` into a `<title>` tag and the sanitized `description` into a `<meta name=\"description\" content=\"...\">` tag.\n8.  These tags are placed within the `<head>` section of the final HTML document.\n9.  The complete HTML response, including the injected meta tags, is sent to the client.\n\n6. Alternate Flows\n- **A1: Missing Page-Specific and Default Metadata:** If neither page-specific nor site-wide default metadata exists, the system generates a `title` from the page's primary heading (e.g., `<h1>` text) truncated to 60 chars. The `description` is set to an empty string, and no `<meta name=\"description\">` tag is rendered.\n- **A2: Dynamic Title Component:** For pages with dynamic content (e.g., a specific instructor's bio page), the `title` template may include a variable (e.g., `\"{InstructorName} - YogaStudio Name\"`). The system substitutes the variable with runtime data before sanitization and injection.\n\n7. Postconditions\n- The HTTP response body contains a complete HTML document.\n- The `<head>` section includes exactly one `<title>` tag with a non-empty, sanitized string.\n- The `<head>` section includes zero or one `<meta name=\"description\">` tag. If present, its `content` attribute contains a non-empty, sanitized string of 1-160 characters.\n- The rendered `title` and `description` accurately reflect the configured data for the requested page or the appropriate fallback.\n\n8. Data Impact\n- A new data structure `seoMetadata` is required for each page entity in the data source (e.g., CMS page model, frontmatter in Markdown files, entry in a `pages.json` config). Structure: `{ \"title\": \"string (max 60)\", \"description\": \"string (max 160)\" }`.\n- A site-wide default `seoMetadata` object must be stored in the central configuration.\n- No new database tables are required if using an existing CMS; otherwise, a simple key-value store for page routes is sufficient.\n\n9. UI Impact\n- The Content Administration Interface (CMS) must include input fields for \"SEO Title\" and \"Meta Description\" on the page edit/create form for all manageable pages.\n- These fields should display character counters (e.g., \"45/60\") and provide validation feedback upon save if limits are exceeded.\n- The interface should pre-fill these fields with the current values when editing a page.\n\n10. Acceptance Criteria\n- **AC1:** For the homepage (`/`), when configured with `title: \"Willkommen bei Studio Yoga\"` and `description: \"Ihr lokales Yogastudio für Hatha und Vinyasa.\"`, the rendered HTML `<head>` contains `<title>Willkommen bei Studio Yoga</title>` and `<meta name=\"description\" content=\"Ihr lokales Yogastudio für Hatha und Vinyasa.\">`.\n- **AC2:** For a page with no configured SEO data, the rendered HTML `<head>` uses the site-wide default metadata (e.g., `<title>Studio Yoga - Deine Auszeit</title>`).\n- **AC3:** A configured `title` of 75 characters is truncated to 60 characters in the rendered output without breaking HTML encoding.\n- **AC4:** The CMS edit form for any page displays the current saved SEO Title and Meta Description values in their respective input fields.\n- **AC5:** Attempting to save a Meta Description longer than 160 characters in the CMS triggers a validation error and prevents save.\n\n### F-18: Open Graph Tags for Social Sharing\n\n1. Purpose\nTo ensure that when the yoga studio's landing page URL is shared on social media platforms (e.g., Facebook, LinkedIn, Twitter) and messaging apps (e.g., WhatsApp, Slack), a rich, branded preview is displayed. This preview includes a title, description, and image, which increases click-through rates, maintains brand consistency, and drives traffic to the studio.\n\n2. Actors\n- Social Media Platform Crawlers (e.g., Facebook's `facebookexternalhit`, Twitter's `Twitterbot`).\n- Website Developers implementing the tags.\n- Studio Management providing the content assets (text, image).\n\n3. Trigger\nA user copies the landing page URL and pastes it into a social media post, comment, or private message, prompting the platform's crawler to fetch and parse the page's metadata.\n\n4. Preconditions\n- The landing page (`index.html`) is fully developed and deployed to a publicly accessible web server.\n- The studio has provided final, approved text for the title and description, and a high-quality, branded image (e.g., studio logo, class photo).\n- The image file is hosted on the same domain or a publicly accessible CDN.\n\n5. Main Flow\n1.  **Define Content:** The developer defines the static Open Graph (OG) tag values based on studio input:\n    *   `og:title`: Studio name + primary value proposition (e.g., \"YogaStudio München | Finde deine innere Balance\").\n    *   `og:description`: Concise studio description or unique selling point (max 2-3 sentences, ~200 characters).\n    *   `og:image`: Absolute URL to the selected, optimized image file (e.g., `https://yogastudio-muenchen.de/assets/og-image.jpg`).\n    *   `og:url`: The canonical absolute URL of the landing page (e.g., `https://yogastudio-muenchen.de/`).\n    *   `og:type`: Set to `website`.\n    *   `og:locale`: Set to `de_DE`.\n2.  **Implement HTML Tags:** The developer inserts the following `<meta>` tags into the `<head>` section of `index.html`:\n    ```html\n    <meta property=\"og:title\" content=\"[defined title]\" />\n    <meta property=\"og:description\" content=\"[defined description]\" />\n    <meta property=\"og:image\" content=\"[defined image URL]\" />\n    <meta property=\"og:url\" content=\"[defined URL]\" />\n    <meta property=\"og:type\" content=\"website\" />\n    <meta property=\"og:locale\" content=\"de_DE\" />\n    ```\n3.  **Optimize Image:** The developer ensures the `og:image` file meets platform specifications: minimum 1200x630 pixels, under 5MB, in JPG or PNG format, with a max aspect ratio of 3:1. The file is compressed for fast loading.\n4.  **Validate Implementation:** The developer uses official debugging tools:\n    *   Facebook Sharing Debugger (`https://developers.facebook.com/tools/debug/`) to scrape the URL, verify tag detection, and preview the link.\n    *   Twitter Card Validator (`https://cards-dev.twitter.com/validator`) to confirm the summary card display.\n    *   LinkedIn Post Inspector (`https://www.linkedin.com/post-inspector/`) for verification.\n5.  **Deploy:** The updated `index.html` and optimized image are committed and deployed to the production web server.\n\n6. Alternate Flows\n- **A1: Missing or Invalid Image:** If the specified `og:image` URL returns a 404 error, is too small, or has an incorrect format, crawlers may fall back to a generic page screenshot or no image. *Solution:* During validation (Step 4), the debugger will flag this. The developer must correct the image URL, size, or format and re-test.\n- **A2: Crawler Access Denied:** If the server's `robots.txt` or firewall blocks the crawler's user-agent, the OG tags will not be read. *Solution:* The developer verifies server logs for blocked requests and configures `robots.txt` to allow common social media crawlers (`User-agent: facebookexternalhit`, `User-agent: Twitterbot`, etc.).\n- **A3: Dynamic Page Requirement:** If the studio later requests that OG tags (e.g., `og:title` or `og:image`) change per course or blog post, the static HTML implementation is insufficient. *Solution:* This requires a backend solution (e.g., server-side rendering, CMS with dynamic meta tags), which is out of scope for this static landing page feature.\n\n7. Postconditions\n- The live `index.html` source code contains all specified, valid Open Graph `<meta>` tags within the `<head>`.\n- The `og:image` file is publicly accessible via its absolute URL and returns a `200 OK` HTTP status.\n- Social media platform debuggers show no errors for the URL and correctly render the provided title, description, and image in their link preview generators.\n- The feature is functional and visible to end-users when they share the URL.\n\n8. Data Impact\n- **New Static Data:** The approved title, description, and image filename are stored as hard-coded strings within the `index.html` file.\n- **New Asset:** An optimized image file (e.g., `og-image.jpg`) is added to the project's `/assets/` or `/images/` directory and deployed with the site.\n- No database schema changes or new API endpoints are created.\n\n9. UI Impact\n- There is **no direct change** to the visual user interface of the landing page itself.\n- The impact is indirect and occurs on **external platforms**: When a user shares the page's URL, the social network's UI (the link preview card) will now display the studio's custom title, description, and image instead of a generic page scrape.\n\n10. Acceptance Criteria\n- **AC1:** The `index.html` `<head>` contains exactly the six required OG meta tags (`og:title`, `og:description`, `og:image`, `og:url`, `og:type`, `og:locale`) with the studio's provided content.\n- **AC2:** The `og:image` URL is an absolute path (starting with `https://`), points to an existing file, and the image dimensions are at least 1200x630 pixels.\n- **AC3:** The Facebook Sharing Debugger shows a \"Preview\" section with the correct title, description, and image, and reports no warnings or errors for the provided URL.\n- **AC4:** The Twitter Card Validator shows a \"Summary Card\" with the correct title, description, and image.\n- **AC5:** Manually sharing the page URL on a personal Facebook/LinkedIn timeline results in a post preview that matches the validator output from AC3/AC4.\n\n### F-19: Google Analytics Tracking Script\n\n1. Purpose\nTo integrate Google Analytics (GA4) tracking into the landing page, enabling the collection of anonymized visitor data (page views, key interactions) for measuring traffic, user behavior, and conversion goals related to course inquiries and contact form submissions.\n\n2. Actors\n- Primary: End-user's web browser (executes the tracking script).\n- Secondary: System (injects and initializes the script).\n\n3. Trigger\nThe landing page's initial HTML document is parsed and rendered by the user's browser.\n\n4. Preconditions\n- A valid GA4 Measurement ID (e.g., `G-XXXXXXXXXX`) is stored in the project's environment configuration or a dedicated configuration file (e.g., `.env`, `config.js`).\n- The page structure includes a consistent, targetable element for the main content container (for accurate page path tracking).\n\n5. Main Flow\n1.  On page load, the system reads the configured GA4 Measurement ID from the environment/config.\n2.  If a valid Measurement ID is present, the system dynamically injects the GA4 script tag (`<script async src=\"https://www.googletagmanager.com/gtag/js?id=MEASUREMENT_ID\"></script>`) into the `<head>` section of the HTML.\n3.  The system injects an inline initialization script immediately after the GA script tag. This script:\n    a. Defines the `window.dataLayer` and `gtag` function if not already present.\n    b. Calls `gtag('js', new Date())`.\n    c. Calls `gtag('config', 'MEASUREMENT_ID', { 'anonymize_ip': true });` to initialize the tracking property with IP anonymization enabled.\n4.  The GA library automatically tracks the initial `page_view` event, capturing the page's path (`location.pathname + location.search`) and title.\n5.  The system attaches event listeners to specific user interaction elements to track custom events:\n    a. **Service/Leistung Clicks:** Listens for clicks on elements with class `.service-card` or `.leistung-button`, triggering `gtag('event', 'generate_lead', { 'event_category': 'engagement', 'event_label': 'service_view' });`.\n    b. **Course Plan Interactions:** Listens for clicks on the course schedule table or buttons with class `.kurs-plan-entry`, triggering `gtag('event', 'view_item', { 'event_category': ' kursplan', 'event_label':ClickedCourseName });` (where `ClickedCourseName` is extracted from the element's text/data attribute).\n    c. **Contact Form Submission:** Listens for the `submit` event on the `<form id=\"contact-form\">`. Upon submission (and before potential page reload), it triggers `gtag('event', 'generate_lead', { 'event_category': 'contact', 'event_label': 'form_submit' });`.\n\n6. Alternate Flows\nA1: **Missing Tracking ID:** If no Measurement ID is found in the configuration at step 1, the system skips steps 2-5 entirely. No GA script is injected, and no tracking occurs. The page loads without error.\nA2: **Script Injection Failure:** If the external GA script fails to load (e.g., network error, blocked by browser extension), the inline initialization script (step 3) will not execute. The system logs a non-blocking warning to the console. No tracking data is sent for that session, but page functionality remains unaffected.\nA3: **Consent Not Given (if Consent Management is present):** If a separate consent management system (e.g., for GDPR) is implemented and the user has not consented to analytics cookies, the system bypasses steps 2-5 regardless of the configuration. Tracking is withheld until consent is granted.\n\n7. Postconditions\n- The GA4 tracking library is loaded and initialized on the page (if ID present and consent given).\n- A `page_view` event for the current URL has been sent to Google's servers.\n- Event listeners are active on specified interactive elements.\n- The system state is otherwise unchanged; user experience and core functionality are not impacted.\n\n8. Data Impact\n- **Data Collected:** Page path, page title, timestamp, screen resolution, language, a pseudonymous client ID (stored in a first-party cookie), and the custom events defined in step 5 of the Main Flow.\n- **Data Processing:** Data is sent directly to Google Analytics servers. IP addresses are anonymized upon collection.\n- **Storage:** No analytics data is stored on the studio's servers. All data resides in the configured GA4 property.\n- **PII:** The implementation ensures no personally identifiable information (PII) like names, email addresses, or phone numbers is sent to GA. Form field values are explicitly not tracked.\n\n9. UI Impact\n- **Visible:** None. The tracking script runs asynchronously in the background and does not alter the visual layout or content of the page.\n- **Non-Visible:** The presence of the GA script and `dataLayer` in the browser's JavaScript environment. This is transparent to the user.\n\n10. Acceptance Criteria\n1.  **Configuration:** The system correctly reads the GA4 Measurement ID from the specified configuration source.\n2.  **Script Injection:** The GA script (`gtag/js`) and the initialization inline script are present in the rendered HTML `<head>` only when a valid ID is configured and consent (if applicable) is given.\n3.  **Initialization:** The `gtag('config', ...)` call executes without JavaScript errors, as verified by browser console and the GA Debugger extension.\n4.  **Page View:** A `page_view` event for the correct URL appears in the GA4 \"Realtime\" > \"Events\" report within 60 seconds of loading the page.\n5.  **Custom Events:** Clicking a `.service-card` element, a `.kurs-plan-entry` element, and successfully submitting the `#contact-form` each generate a corresponding event (`generate_lead` or `view_item`) visible in the GA4 Realtime report with correct `event_category` and `event_label` parameters.\n6.  **No Regression:** The presence of the tracking script does not cause layout shifts (CLS), increase Largest Contentful Paint (LCP) significantly, or block the main thread. Page functionality (form submission, navigation) remains fully operational.\n7.  **Fallback:** When the Measurement ID is removed from configuration, no GA-related script tags or `gtag` calls appear in the page source or runtime environment.\n\n### F-20: Smooth Scroll to Anchor Links\n\n1. Purpose\nTo provide a smooth, animated scrolling experience when a user clicks a navigation link that targets a specific section (anchor) on the same page, improving user experience and perceived professionalism compared to the browser's default instant jump.\n\n2. Actors\nPrimary Actor: Website Visitor (end-user).\nSecondary Actor: None.\n\n3. Trigger\nThe user clicks on a navigation link (`<a>` element) whose `href` attribute is a fragment identifier (e.g., `#services`, `#contact`) pointing to an existing element on the current page.\n\n4. Preconditions\n1. The landing page contains at least one navigation link with an `href` attribute starting with `#`.\n2. The target element (with an `id` matching the fragment identifier) exists in the DOM.\n3. JavaScript is enabled in the user's browser (with a graceful fallback to default behavior if disabled).\n4. A fixed or sticky header, if present, does not obscure the target section's heading after scroll completion.\n\n5. Main Flow\n1. The user clicks a navigation anchor link (`<a href=\"#target-id\">`).\n2. The browser's default jump behavior is prevented via `event.preventDefault()`.\n3. The target element is located using `document.getElementById()` with the fragment identifier from the `href`.\n4. If the target element is found:\n   a. The vertical scroll position is calculated. This is the `targetElement.offsetTop` minus the height of any fixed/sticky header (if applicable) to ensure the target is fully visible.\n   b. A smooth scrolling animation is initiated using `window.scrollTo({ top: calculatedPosition, behavior: 'smooth' })`.\n   c. The browser's URL hash is updated to the fragment identifier (`#target-id`) using `history.pushState()` to avoid triggering another jump.\n5. The animation completes when the browser reaches the calculated scroll position.\n6. Optional: Focus is programmatically moved to the target element (`targetElement.focus()`) for accessibility, provided the element is focusable.\n\n6. Alternate Flows\n1. **JavaScript Disabled or Fails to Load:**\n   a. The click event is not intercepted.\n   b. The browser performs its default instant jump to the anchor.\n   c. The feature degrades gracefully; core functionality (navigation) remains intact.\n2. **Target Element Not Found:**\n   a. After step 3 in the main flow, `document.getElementById()` returns `null`.\n   b. No smooth scroll is initiated. The click event's default is prevented, but no action occurs. Optionally, a console warning is logged for debugging.\n3. **User Initiates New Scroll Before Current Animation Completes:**\n   a. A new click on any smooth-scroll link occurs while a previous scroll animation is in progress.\n   b. The current animation is cancelled (implicitly by the browser when a new `scrollTo` is called).\n   c. The new scroll animation begins from the current viewport position to the new target's calculated position.\n\n7. Postconditions\n1. The viewport is scrolled to the vertical position where the target element's top edge is aligned with the top of the viewport (accounting for fixed header offset).\n2. The URL in the address bar displays the correct fragment identifier (e.g., `.../index.html#services`).\n3. If implemented, the target element has focus.\n4. The active state of the navigation link corresponding to the target section is updated (if such a UI component exists and is managed separately).\n\n8. Data Impact\nNo persistent data is created, modified, or stored. A transient, in-memory analytics event (e.g., `smooth_scroll_triggered`) may be logged to an analytics queue if tracking is implemented, but this is not a core data storage operation.\n\n9. UI Impact\n1. **Visual:** The page content scrolls vertically with a smooth, decelerating animation (typical duration ~300-500ms) instead of an instant jump.\n2. **URL:** The fragment identifier appears in the URL bar without a full page reload.\n3. **Focus:** A visible focus ring may appear around the target element if it receives focus.\n4. **Navigation State:** The clicked navigation link may reflect an \"active\" state, and this state should update as the user scrolls (if an intersection observer is used for this, it is a separate concern).\n\n10. Acceptance Criteria\n1. **AC1:** Clicking a valid navigation anchor link results in a smooth vertical scroll animation to the target section.\n2. **AC2:** The target section's heading is not obscured by a fixed header (if present) after scroll completion.\n3. **AC3:** The browser's URL hash updates to match the clicked link's `href` fragment during/after the scroll.\n4. **AC4:** If JavaScript is disabled, clicking an anchor link performs the browser's default instant jump to the target section.\n5. **AC5:** Clicking a link with an `href` pointing to a non-existent `id` does not cause a scroll and does not throw a visible error to the user.\n6. **AC6:** The smooth scroll animation respects the user's \"prefers-reduced-motion\" OS setting; if reduced motion is preferred, the scroll should be instant (behave like the default jump).\n7. **AC7:** The feature works correctly on all modern browsers (Chrome, Firefox, Safari, Edge) and provides a graceful fallback (instant scroll) on browsers that do not support `scrollTo` with `behavior: 'smooth'`.\n\n### F-21: Image Lazy Loading\n\n1. Purpose\nTo improve initial page load performance and reduce bandwidth consumption by deferring the loading of images that are not immediately visible within the user's viewport. This ensures critical content (e.g., hero image, above-the-fold text) renders faster, improving Core Web Vitals (LCP, CLS) and user experience on the yoga studio landing page.\n\n2. Actors\n- Primary Actor: Web Browser (Client-side JavaScript)\n- Secondary Actor: End User (via scrolling behavior)\n\n3. Trigger\n- Initial page load (DOMContentLoaded event).\n- User scroll action that changes the viewport, causing new images to enter the viewport.\n\n4. Preconditions\n- All target `<img>` elements in the HTML have a `data-src` (or `data-srcset`) attribute containing the actual high-resolution image URL(s).\n- All target `<img>` elements have a `loading=\"lazy\"` attribute (for native browser support) OR are identified by a specific CSS class (e.g., `.lazy`) for the JavaScript polyfill/observer.\n- A lightweight placeholder image (e.g., a 1x1 transparent GIF, a low-quality blurred version, or a solid background color) is set as the initial `src` attribute to prevent layout shift.\n- The browser supports the Intersection Observer API or a polyfill is included.\n\n5. Main Flow\n1.  On `DOMContentLoaded`, the JavaScript selects all `<img>` elements that either have `loading=\"lazy\"` or the `.lazy` class.\n2.  For each selected image, the script stores the actual image URL from `data-src` (or `data-srcset`) in a variable and ensures the `src` attribute contains only the placeholder.\n3.  An `IntersectionObserver` instance is created with a root margin (e.g., `\"100px 0px\"`) to trigger loading slightly before the image enters the viewport.\n4.  Each target image is observed by the `IntersectionObserver`.\n5.  When the observer callback detects an image has intersected the viewport (based on the root margin):\n    a.  The image's `src` attribute is set to the value from `data-src`.\n    b.  If `srcset` is used, `data-srcset` is moved to `srcset`.\n    c.  The image is unobsered from the `IntersectionObserver`.\n6.  The image begins loading. Upon successful load (`onload` event), a CSS class (e.g., `.loaded`) is added to the image to trigger a fade-in transition. On error (`onerror`), a fallback image or error message is displayed.\n\n6. Alternate Flows\n- **A1: JavaScript Disabled.** If client-side JavaScript is unavailable, the browser's native `loading=\"lazy\"` attribute (if present) will handle lazy loading. If no native support and no JS, all images will load immediately as the `data-src` attributes are ignored by the browser, and only the placeholder `src` is loaded (resulting in broken/incomplete images). *Mitigation: The HTML must include a `<noscript>` block containing the full, correct `<img>` tags with standard `src` attributes for critical images to ensure basic functionality without JS.*\n- **A2: Image Already in Viewport on Load.** The `IntersectionObserver` callback triggers immediately for images already within the viewport (plus root margin), loading them without delay.\n- **A3: Network Failure.** If the image URL from `data-src` fails to load (404, timeout), the `onerror` handler replaces the `src` with a predefined fallback image (e.g., a generic \"image not available\" icon) and logs the error to the console for debugging.\n- **A4: Rapid Scrolling.** The `IntersectionObserver` efficiently batches callbacks. Images that quickly enter and exit the viewport during rapid scrolling will still load once the intersection threshold is met; the load process cannot be easily canceled mid-request but will complete in the background.\n\n7. Postconditions\n- All images initially outside the viewport (plus defined root margin) have their `src`/`srcset` attributes updated from the `data-*` attributes and are loading or have loaded.\n- Images that entered the viewport during the session have either displayed successfully, displayed a fallback, or are in a loading state.\n- The initial page payload size is reduced, as only placeholder images and critical above-the-fold images are requested immediately.\n- The `IntersectionObserver` has no remaining observed targets (all have been unobserved).\n\n8. Data Impact\n- **No new persistent data storage.** All logic is client-side and ephemeral.\n- **Session State:** The browser's native image cache stores loaded images. If the user navigates away and returns (via back button), cached images may load instantly from the browser cache if the same URLs are requested.\n- **Analytics (Optional):** A custom event (e.g., `lazyImageLoaded`) could be dispatched for each successful image load to allow integration with analytics tools (e.g., Google Analytics) to track performance metrics, but this is not a core requirement.\n\n9. UI Impact\n- **Before Load:** Off-screen images display as the defined placeholder (e.g., a light gray box or a very low-resolution blurred preview).\n- **During Load:** The browser's default loading spinner/behavior may appear briefly.\n- **After Successful Load:** The image fades in smoothly via a CSS transition on the `.loaded` class (opacity from 0 to 1). This prevents layout shift (CLS) as the placeholder reserves the correct aspect ratio space.\n- **After Error:** The fallback image replaces the placeholder, clearly indicating the image could not be loaded.\n- **No visual change** for images natively supported by the browser's `loading=\"lazy\"` attribute when JavaScript is disabled.\n\n10. Acceptance Criteria\n- **AC1:** The initial page load (measured via browser DevTools Network tab) shows only placeholder image requests and requests for images within the viewport (including the defined root margin). No requests for off-screen images occur until they are scrolled near.\n- **AC2:** All images load and display correctly when their container scrolls into the viewport. The fade-in transition plays smoothly without causing layout shift (CLS score remains near 0).\n- **AC3:** The feature works in all target browsers (Chrome, Firefox, Safari, Edge). For browsers without Intersection Observer support (e.g., older Safari), the included polyfill functions correctly.\n- **AC4:** If an image URL is invalid, the fallback image is displayed, and no broken image icon is shown.\n- **AC5:** The `<noscript>` block contains functional, non-lazy-loaded versions of the hero image and any other critical images, ensuring the page remains usable and visually complete without JavaScript.\n- **AC6:** Performance metrics (Lighthouse) show an improvement in \"Largest Contentful Paint (LCP)\" compared to a version without lazy loading, assuming similar network conditions.\n\n### F-22: ARIA Labels for Accessibility\n\n1. Purpose\nTo ensure the landing page for the local yoga studio is fully navigable and understandable for users of assistive technologies, specifically screen readers. This is achieved by adding appropriate ARIA (Accessible Rich Internet Applications) attributes to all interactive and non-standard semantic elements, thereby meeting WCAG 2.1 AA success criteria.\n\n2. Actors\n- Primary: End-users utilizing screen readers (e.g., NVDA, JAWS, VoiceOver).\n- Secondary: Front-end developers implementing the attributes; QA testers validating accessibility.\n\n3. Trigger\nA user navigates to the landing page using a screen reader or other assistive technology that relies on the accessibility tree.\n\n4. Preconditions\n- The core HTML structure and visual design of the landing page (Hero, Services, Course Plan, Contact Form) are implemented.\n- All interactive elements (links, buttons, form inputs) have native HTML semantics where possible (e.g., `<button>`, `<a>`, `<input>`).\n- The page is served with a proper `lang` attribute on the `<html>` element.\n\n5. Main Flow\n1.  **Navigation Landmark:** Add `role=\"navigation\"` to the `<nav>` element containing the main site links (e.g., \"Leistungen\", \"Kursplan\", \"Kontakt\"). Add an `aria-label=\"Hauptnavigation\"` to describe its purpose.\n2.  **Main Content Landmark:** Ensure the primary content container (e.g., `<main>`) has `role=\"main\"` and `aria-label=\"Seiteninhalt\"`.\n3.  **Hero Section:** The main headline (`<h1>`) is inherently accessible. If the hero contains a non-semantic container for background imagery or layout, add `role=\"img\"` and a concise `aria-label=\"Yoga Studio [Stadname] - Willkommen\"` describing the visual theme.\n4.  **Services Section:** Each service card (e.g., \"Hatha Yoga\", \"Vinyasa Flow\") is a `<div>` or `<article>`. Add `role=\"region\"` and a unique `aria-labelledby` that references the card's title `<h2>` or `<h3>` ID.\n5.  **Course Plan Table:** The weekly schedule is presented in an HTML `<table>`.\n    a. Add `<caption>` element with text \"Wöchentlicher Kursplan für [Monat/Jahr]\".\n    b. Ensure all table headers (`<th>`) have proper `scope=\"col\"` or `scope=\"row\"` attributes.\n6.  **Contact Form:**\n    a. Each form input (`<input>`, `<textarea>`) has a visible, associated `<label>` using the `for` attribute.\n    b. For the form's purpose, add `aria-label=\"Kontaktformular für [Studio Name]\"` to the `<form>` element.\n    c. For the submit button with only an icon (e.g., SVG arrow), add `aria-label=\"Nachricht senden\"`.\n7.  **Skip Link:** Implement a visually hidden but focusable \"Skip to main content\" link as the first focusable element in the `<body>`. It must have `href=\"#main\"` (targeting the `<main id=\"main\">` element) and appropriate CSS to become visible on focus.\n8.  **Icon Buttons/Links:** For any icon-only buttons (e.g., social media icons in the footer), add `aria-label=\"Link zu [Platform Name]\"` (e.g., \"Link zu Instagram\").\n9.  **Live Regions (if applicable):** If the contact form uses AJAX for submission, the status message container (success/error) must have `aria-live=\"polite\"` and `aria-atomic=\"true\"`.\n\n6. Alternate Flows\n1.  **Dynamic Form Validation:** If form validation errors appear dynamically without a page reload, the error message container for each invalid field must have `role=\"alert\"` or be placed within an element with `aria-live=\"assertive\"` to ensure immediate announcement. The invalid input must also have `aria-invalid=\"true\"` and `aria-describedby` pointing to the error message ID.\n2.  **Modal/Dialog (if used):** If a \"Book Now\" button opens a modal dialog for class registration, the modal must have `role=\"dialog\"`, `aria-modal=\"true\"`, and an `aria-labelledby` referencing its title. Focus must be trapped within the modal upon opening and returned to the triggering button upon closing.\n3.  **Expandable/Collapsible Sections:** If the course plan has filter toggles (e.g., \"Show only advanced\"), the button controlling the section must have `aria-expanded=\"true/false\"` and `aria-controls=\"ID-of-content-section\"`.\n\n7. Postconditions\n- All major page sections are programmatically determinable via landmarks.\n- Every interactive element has an accessible name computable by assistive technologies.\n- The accessibility tree accurately reflects the page structure and state (e.g., expanded/collapsed, form errors).\n- Screen reader users can navigate sequentially and by landmark/heading to all content and functionality.\n\n8. Data Impact\n- **None.** This feature does not alter business data, database schemas, or application state. It only adds metadata attributes to the front-end HTML/DOM.\n\n9. UI Impact\n- **Visual Design:** No visual changes to the existing UI layout, colors, or typography.\n- **Code Structure:** The HTML source code will include additional `role`, `aria-label`, `aria-labelledby`, `aria-describedby`, `aria-live`, and `aria-expanded` attributes.\n- **CSS:** May require minor adjustments for the \"Skip to main content\" link to be hidden off-screen but visible on `:focus`.\n\n10. Acceptance Criteria\n1.  **Automated Test:** The page scores 0 violations for WCAG 2.1 AA rules related to ARIA (e.g., `aria-label`, `aria-labelledby`, `role` usage) in a tool like axe-core or Lighthouse.\n2.  **Manual Screen Reader Test (VoiceOver/NVDA):**\n    a. A user can navigate the page using the landmark rotor/list and jump directly to \"Main Navigation\", \"Main Content\", and \"Footer\".\n    b. The hero section is announced with its descriptive label.\n    c. Each service card is announced as a \"region\" followed by its title.\n    d. The course plan table is read logically, with headers properly associated with cells.\n    e. All form inputs are announced with their associated labels. Validation errors (if triggered) are announced immediately.\n    f. Icon-only buttons announce their purpose (e.g., \"Instagram, link\").\n3.  **Keyboard Navigation:** The \"Skip to main content\" link is the first tab stop, becomes visibly focused, and correctly moves focus to the `<main>` element when activated.\n4.  **Code Review:** All added ARIA attributes are validated against the W3C ARIA specification and are necessary (i.e., native HTML semantics are not overridden unnecessarily).\n\n### F-23: HTTPS Redirection\n\n1. Purpose\nTo enforce secure communication by automatically redirecting all unencrypted HTTP requests to their encrypted HTTPS counterparts. This protects data integrity and confidentiality, improves search engine ranking, and ensures compliance with modern security standards.\n\n2. Actors\n- End-User (via browser or HTTP client)\n- Web Server (handling the request)\n- Search Engine Crawler (indexing the site)\n\n3. Trigger\nAn HTTP request (port 80) is received by the web server for any resource on the studio's domain (e.g., `http://yogastudio-example.de/`).\n\n4. Preconditions\n- A valid SSL/TLS certificate is installed and correctly configured for the domain.\n- The web server is configured to listen on port 443 for HTTPS traffic.\n- The HTTPS virtual host/server block is fully functional and serves the site correctly.\n\n5. Main Flow\n1.  The web server receives an HTTP request on port 80.\n2.  The server inspects the `Host` header and requested URI path/query string.\n3.  The server constructs the target HTTPS URL by replacing the `http://` scheme with `https://` while preserving the exact host, port (if non-standard), path, and query string.\n4.  The server sends an HTTP 301 (Moved Permanently) response with the `Location` header set to the constructed HTTPS URL.\n5.  The client (browser/crawler) receives the 301 response and automatically issues a new request to the provided HTTPS URL.\n6.  The web server receives the new HTTPS request on port 443 and processes it normally, serving the requested resource.\n\n6. Alternate Flows\n- **A1: Request Already Uses HTTPS:** The server receives a request on port 443. The server skips the redirection logic and proceeds directly to serve the requested resource over the established secure connection.\n- **A2: Redirect to a Non-Existent HTTPS Resource:** The HTTP request is for a valid path that does not exist (e.g., `/invalid-page`). The server still issues a 301 redirect to `https://domain/invalid-page`. The subsequent HTTPS request then results in the appropriate 404 Not Found response from the HTTPS server.\n- **A3: Malformed Host Header:** The HTTP request contains an invalid or missing `Host` header. The server may return a 400 Bad Request error instead of a redirect, as it cannot reliably construct the target HTTPS URL.\n\n7. Postconditions\n- All subsequent requests for the site's resources from the client are made over HTTPS.\n- The HTTP (port 80) endpoint consistently returns a 301 redirect for any requested path.\n- The site is exclusively accessible via HTTPS for properly configured clients.\n- Search engine crawlers receive a clear signal to index the HTTPS version of the site.\n\n8. Data Impact\nNo persistent data is created, modified, or deleted. The operation is stateless and only affects request routing.\n\n9. UI Impact\nThere is no visible user interface change. Users may briefly see their browser's address bar change from `http://` to `https://` and a potential minor delay during the redirect handshake. The lock icon (or equivalent security indicator) will be displayed after the HTTPS connection is established.\n\n10. Acceptance Criteria\n- **AC1:** Any URL accessed via `http://[valid-domain]/[any-path]` returns an HTTP 301 status code.\n- **AC2:** The `Location` header in the 301 response points to the identical path and query string on the `https://` scheme.\n- **AC3:** Accessing the site directly via `https://[valid-domain]/[any-path]` returns a 200 OK status code and serves the correct content without any redirect.\n- **AC4:** The redirect chain length is exactly 1 (HTTP -> HTTPS), with no redirect loops (e.g., HTTPS redirecting back to HTTP or to another HTTP URL).\n- **AC5:** The SSL/TLS certificate for the HTTPS endpoint is valid, trusted by the client, and presented without errors during the HTTPS request.\n- **AC6:** The redirection works consistently for the primary domain (e.g., `yogastudio-example.de`) and any configured `www` subdomain (e.g., `www.yogastudio-example.de`), redirecting each to its corresponding HTTPS host.\n\n### F-24: Newsletter Signup Field\n\n1. Purpose\nTo collect email addresses from website visitors who voluntarily opt-in to receive the yoga studio's newsletter and promotional communications, building a marketing contact list.\n\n2. Actors\n*   **Primary Actor:** Website Visitor (potential customer).\n*   **Secondary Actor:** Studio Staff/Marketing Team (indirectly, as recipients of the collected data).\n\n3. Trigger\nThe visitor scrolls to or navigates to the section of the landing page containing the newsletter signup form and decides to subscribe.\n\n4. Preconditions\n*   The landing page is fully loaded and rendered in the user's browser.\n*   The newsletter signup field component is visible and interactive on the page (e.g., in the footer or a dedicated section).\n*   The backend API endpoint for handling newsletter subscriptions is available and responsive.\n\n5. Main Flow\n1.  The visitor views the landing page and locates the newsletter signup field, which includes a text input for an email address, a \"Subscribe\" button, and a link to the privacy policy.\n2.  The visitor enters a valid email address into the input field.\n3.  The visitor clicks the \"Subscribe\" button.\n4.  The frontend performs immediate client-side validation to ensure the input is a syntactically valid email address (e.g., contains '@' and a domain).\n5.  Upon passing client-side validation, the frontend sends an asynchronous HTTP POST request to the backend subscription endpoint (`/api/subscribe`) containing the email address and an implicit or explicit consent flag.\n6.  The backend receives the request, validates the email format server-side, and checks against the existing subscriber database to prevent duplicates (based on normalized email address).\n7.  If the email is valid and new, the backend creates a new subscriber record with the email, a timestamp (`subscribed_at`), a `source` field set to \"landingpage\", and a `consent_given` flag set to `true` (based on the act of submission). The record status is set to `active`.\n8.  The backend returns a successful HTTP response (e.g., `200 OK` or `201 Created`).\n9.  The frontend receives the successful response and updates the UI to display a success confirmation message (e.g., \"Thank you for subscribing!\") and disables or resets the input field and button.\n\n6. Alternate Flows\n*   **A1: Invalid Email Format (Client-Side):** In step 4, the client-side validation fails. The UI displays an inline error message (e.g., \"Please enter a valid email address\") next to the input field. The form is not submitted.\n*   **A2: Invalid Email Format (Server-Side):** In step 6, server-side validation fails (e.g., malformed email passed client-side). The backend returns an error response (e.g., `400 Bad Request`). The frontend displays a generic error message (e.g., \"Invalid email address. Please try again.\").\n*   **A3: Email Already Subscribed:** In step 6, the email is found in the database with an `active` status. The backend returns a specific response (e.g., `409 Conflict`). The frontend displays a message (e.g., \"This email is already on our list.\"). The subscriber's `subscribed_at` timestamp is not updated.\n*   **A4: Backend Unavailable:** In step 5, the network request fails (timeout, 5xx error). The frontend displays a generic failure message (e.g., \"Subscription failed. Please check your connection and try again.\") and re-enables the submit button.\n\n7. Postconditions\n*   A new subscriber record exists in the database with the provided email, timestamp, source, and active status, OR an existing active record is left unchanged.\n*   The user interface reflects the outcome (success message, error message, or field reset).\n*   The system has logged the subscription attempt (success or failure) for audit purposes.\n\n8. Data Impact\n*   **New Data Created:** A `subscribers` table record with fields: `id` (PK), `email` (unique, indexed), `subscribed_at` (datetime), `source` (varchar), `consent_given` (boolean), `status` (varchar, e.g., 'active').\n*   **Data Updated:** No existing data is updated for a new subscription. For an already-subscribed email, no update occurs.\n*   **GDPR/Privacy:** The `consent_given` flag and `subscribed_at` timestamp must be stored to prove opt-in. The privacy policy link must be present.\n\n9. UI Impact\n*   A form component is added to the landing page layout, typically in the footer or a pre-footer section.\n*   The component consists of: a label (\"Subscribe to our newsletter\"), a single-line text input (`type=\"email\"`), a primary action button (\"Subscribe\"), and a small text link to the Privacy Policy.\n*   The UI must provide clear, accessible validation feedback (ARIA live regions for errors/success).\n*   On success, the input and button are replaced by or accompanied by a persistent success message.\n*   The component is responsive and styled consistently with the studio's brand.\n\n10. Acceptance Criteria\n*   **AC1:** Entering a syntactically invalid email (e.g., \"test@\") and clicking Subscribe displays an immediate, clear client-side error message and does not send a network request.\n*   **AC2:** Entering a valid, *new* email address and clicking Subscribe results in a `200`/`201` API response, the UI shows a success confirmation, and a new record with `status='active'` and `consent_given=true` is created in the database.\n*   **AC3:** Entering a valid, *already subscribed* email address and clicking Subscribe results in a `409` API response (or similar), the UI shows an appropriate \"already subscribed\" message, and no new database record is created.\n*   **AC4:** If the API is unreachable or returns a 5xx error, the UI shows a generic failure message and the user can retry.\n*   **AC5:** The subscription form is accessible via keyboard navigation and screen readers. The privacy policy link is clearly visible and navigable.\n*   **AC6:** The input field clears or is disabled after a successful subscription, preventing duplicate immediate submissions.\n\n## Non-Functional Requirements\n\n- Zuverlaessigkeit: Ein iterativer Lauf muss ohne Verlust bereits akzeptierter Features abschliessen.\n- Determinismus: Freeze-Baseline und Feature-IDs bleiben ueber Iterationen stabil.\n- Performance: In Freeze-Mode wird Section-Patching gegenueber Vollregeneration bevorzugt.\n- Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen.\n\n## Error Handling & Recovery\n\n- Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n- Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n- Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n- Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert.\n\n## Deployment & Infrastructure\n\n- Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n- Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n- Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n- Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert.\n\n## Definition of Done\n\n- Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n- Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n- Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n- Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n",
      "tokensUsed": 8799
    },
    {
      "iterationNumber": 2,
      "generatorOutput": "## System Vision\n\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries\n\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand\n\n## Domain Model\n\n- Kern-Entitaeten: Nutzer/Besucher, Feature, Anforderung und Iteration.\n- Beziehungen: Eine Anforderung aggregiert Features; jede Iteration verfeinert bestehende Features und kann neue ueber ein strukturiertes Delta hinzufuegen.\n- Datenkonsistenz: Feature-IDs bleiben ueber Iterationen stabil und gelten als unveraenderliche Kennungen.\n- Quellkontext (Iteration 1): Erstelle eine kompakte Landingpage fuer ein lokales Yogastudio mit Hero, Leistungen, Kursplan und Kontaktformular.\n\n## Global Business Rules\n\n- Bestehende Features duerfen waehrend der iterativen Verfeinerung nicht entfernt werden.\n- Neue Features werden nur ueber validiertes Feature-Delta-JSON akzeptiert.\n- Doppelte Features (gleiche Intention/Bezeichnung) werden deterministisch verworfen.\n- Akzeptanzkriterien aller Features muessen testbar und beobachtbar bleiben.\n\n## Functional Feature Catalogue\n\n### F-01: Responsive Layout\n\n1. Purpose\nTo ensure the landing page renders optimally and maintains full functionality across a defined set of viewport sizes (mobile, tablet, desktop), thereby providing a consistent user experience, reducing bounce rates, and supporting conversion goals regardless of the access device.\n\n2. Actors\n- End User (visitor to the Yogastudio landing page)\n- Frontend Developer (implementing the layout logic)\n- QA Tester (validating responsiveness)\n\n3. Trigger\nA user accesses the landing page URL via a web browser on any device (desktop, tablet, or mobile phone).\n\n4. Preconditions\n- The HTML document includes a valid `<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">` tag.\n- The CSS architecture is built using a mobile-first approach with defined breakpoints.\n- All page assets (images, icons) are available in suitable resolutions or use vector formats (SVG).\n\n5. Main Flow\n1.  Upon page load, the browser's rendering engine reads the viewport meta tag and establishes the initial layout viewport width equal to the device's screen width.\n2.  The CSS is parsed and applied. The base (mobile) styles are applied first, targeting a viewport width of 0px and up.\n3.  The browser evaluates the current viewport width against the following predefined CSS media query breakpoints in ascending order:\n    a. `@media (min-width: 480px)` – Applies styles for large mobile phones.\n    b. `@media (min-width: 768px)` – Applies styles for tablets (portrait and landscape) and small laptops. The main navigation menu switches from a vertical/hamburger layout to a horizontal top bar. The Hero section's text and CTA button stack vertically. The \"Leistungen\" and \"Kursplan\" sections transition from a single-column stack to a two-column grid.\n    c. `@media (min-width: 1024px)` – Applies styles for standard desktop monitors. The main content container reaches a maximum fixed width (e.g., 1200px) and centers. The \"Kursplan\" table becomes fully visible without horizontal scrolling. The \"Kontakt\" form and map may appear side-by-side.\n    d. `@media (min-width: 1280px)` – Applies styles for large desktop screens, increasing whitespace and maximum container width slightly.\n4.  For all image assets, the `srcset` attribute and CSS `max-width: 100%; height: auto;` rules are applied to prevent overflow and serve appropriately sized images based on viewport density and width.\n5.  The responsive navigation toggle (hamburger icon) is conditionally rendered and functional only at viewport widths below the 768px breakpoint. Clicking it toggles the visibility of the navigation menu overlay.\n\n6. Alternate Flows\n- **A1: JavaScript Disabled.** If the user has JavaScript disabled, the responsive navigation menu (hamburger) remains non-functional. The mobile navigation fallback is a simple vertical list of links always visible below the studio logo, ensuring core navigation remains accessible.\n- **A2: Extreme Aspect Ratio / Very Tall Mobile Screen.** On a very tall, narrow mobile screen (e.g., 9:21 aspect ratio), the Hero section's background image may be cropped more significantly. The CSS `background-position: center;` and `background-size: cover;` rules ensure the focal point remains centered, and the text container maintains a minimum height for readability.\n- **A3: Device Rotation.** Upon device rotation (portrait to landscape or vice versa), the `resize` event fires. The browser re-evaluates the viewport width against the breakpoints and dynamically reapplies the correct CSS rules without requiring a page reload.\n- **A4: High-DPI (Retina) Displays.** For viewports that meet a `min-width` breakpoint but have a high device pixel ratio (e.g., 2), the browser automatically selects the higher-resolution image from the `srcset` list, ensuring crisp visuals.\n\n7. Postconditions\n- The page layout adapts to the current viewport width with no horizontal scrollbars appearing at any breakpoint.\n- All textual content remains readable without requiring user zooming (minimum font size of 16px in base styles).\n- All interactive elements (buttons, form inputs, links) have a minimum touch target size of 44x44 CSS pixels on mobile viewports.\n- The navigation is fully accessible and operable with the appropriate interaction model for the device (tap for mobile, hover for desktop).\n- No content is clipped or hidden unintentionally due to overflow at any breakpoint.\n\n8. Data Impact\n- **Storage:** No new data is stored on the server or client as a direct result of the responsive layout logic.\n- **Transmission:** The use of `srcset` and `<picture>` elements may result in the browser requesting a different image file size, optimizing bandwidth usage on mobile networks. CSS files are cached by the browser after the initial load.\n- **Processing:** Client-side processing is limited to the browser's native CSS rendering engine and layout calculation. No additional server-side processing is required per request.\n\n9. UI Impact\n- **Layout Structure:** The main layout container uses CSS Grid or Flexbox. The number of columns in grid-based sections (\"Leistungen\", \"Kursplan\" preview) changes from 1 (mobile) to 2 (tablet) to 3 or 4 (desktop).\n- **Navigation:** The desktop header displays a full horizontal menu. The mobile header displays a logo, a hamburger icon button, and possibly a \"Kontakt\" CTA button. The mobile menu is an off-canvas overlay or accordion.\n- **Typography:** Font sizes and line heights are scaled using `rem` units, with minor adjustments at breakpoints (e.g., larger H1 on desktop).\n- **Spacing:** Padding and margin values (stored in CSS custom properties) are increased at larger breakpoints to utilize available screen real estate.\n- **Forms:** The contact form fields stack vertically on mobile/tablet but may arrange in two columns on wide desktop screens. The submit button spans the full width on mobile and becomes auto-width on desktop.\n\n10. Acceptance Criteria\n- **AC1:** When the viewport width is 320px (small mobile), the page renders with a single-column layout. The navigation is a hamburger menu. No horizontal scrollbar is present. All text is readable without zooming.\n- **AC2:** When the viewport width is 768px (tablet), the navigation displays as a horizontal top bar. The \"Leistungen\" section shows services in two equal-width columns. The Hero section's text and image are side-by-side. The \"Kursplan\" table has a horizontal scroll container if its content exceeds the viewport width.\n- **AC3:** When the viewport width is 1440px (desktop), the main content container is centered with a maximum width. The \"Kursplan\" section displays the full weekly schedule table without internal horizontal scrolling. The \"Kontakt\" form and studio location map are displayed in a two-column layout.\n- **AC4:** When rotating a mobile device from portrait to landscape (simulating a 568px x 320px viewport), the layout correctly switches from the mobile (480px) breakpoint styles to the tablet (768px) breakpoint styles if the new width meets the condition, and vice versa.\n- **AC5:** All clickable/tappable elements (buttons, nav links, form inputs) meet a minimum touch target size of 44x44 CSS pixels on viewports <= 768px width.\n- **AC6:** All images load without distortion or unintended cropping at their respective breakpoints, and no image causes layout shift (CLS) after load.\n\n### F-02: Sticky Navigation Menu\n\n1. Purpose\nTo provide a fixed-position navigation header that remains visible at the top of the viewport during page scroll, improving site navigation accessibility and user experience on the single-page landing page.\n\n2. Actors\n- Primary: Website Visitor (end-user)\n- Secondary: Studio Administrator (manages content via CMS, if applicable)\n\n3. Trigger\nThe feature activates automatically when the user scrolls the page vertically beyond a predefined threshold (e.g., 50px from the top).\n\n4. Preconditions\n- The landing page HTML includes a `<header>` element with a navigation container (`<nav>`) containing anchor links to page sections (e.g., `#hero`, `#leistungen`, `#kursplan`, `#kontakt`).\n- The page content height exceeds the viewport height, enabling vertical scrolling.\n- The viewport width is at least 768px (desktop/tablet). On mobile, the navigation may collapse into a hamburger menu; sticky behavior applies to the toggled header.\n\n5. Main Flow\n1. **Initial Render**: The page loads with the navigation header in its default static position at the top of the document flow.\n2. **Scroll Event Listener**: A JavaScript `scroll` event listener is attached to the `window` object upon page load.\n3. **Threshold Check**: On each scroll event, the script calculates `window.scrollY`. If `scrollY > 50`, proceed to step 4; else, proceed to step 5.\n4. **Apply Sticky Class**: The script adds a CSS class (e.g., `is-sticky`) to the header element. This class applies `position: fixed; top: 0; left: 0; width: 100%;` and increases the header's `z-index` to ensure it overlays subsequent content.\n5. **Remove Sticky Class**: If `scrollY <= 50`, the script removes the `is-sticky` class, reverting the header to its original static/relative positioning.\n6. **Link Click Handling**: When a user clicks a navigation link, the page smoothly scrolls (`scrollIntoView({ behavior: 'smooth' })`) to the target section. After scroll completion, the sticky state is re-evaluated based on the new scroll position.\n7. **Mobile Toggle (if applicable)**: On viewports < 768px, a hamburger icon toggles the visibility of the navigation links. When the mobile menu is open and the user scrolls, the sticky header behavior (steps 3-5) still applies to the header bar containing the hamburger icon.\n\n6. Alternate Flows\n- **A1: No Scrollable Content**: If the page content height is less than the viewport height, the scroll event never triggers. The header remains in its default static position. The script should handle this gracefully without errors.\n- **A2: Rapid Scroll/Resize**: During fast scrolling or window resizing, multiple scroll events fire in quick succession. The script uses `requestAnimationFrame` or a debounce mechanism (e.g., 50ms) to limit DOM updates and maintain performance.\n- **A3: Mobile Menu Open on Scroll**: On mobile, if the user opens the hamburger menu and then scrolls, the mobile menu overlay should automatically close to prevent obstructing content, while the header remains sticky.\n- **A4: Anchor Link from External Page**: If a user lands on the page with a URL hash (e.g., `index.html#kursplan`), the browser jumps to the section on load. The script must evaluate the initial scroll position after DOM content loaded and apply the sticky class if the hash target is below the 50px threshold.\n\n7. Postconditions\n- The navigation header is visually fixed at the top of the viewport whenever the page scroll position exceeds 50px.\n- All navigation links remain functional and scroll smoothly to their target sections.\n- The header's z-index ensures it is always above other page content (e.g., hero image, section backgrounds).\n- On mobile, the sticky header bar (with hamburger icon) remains accessible during scroll.\n\n8. Data Impact\n- **Client-Side Storage**: Optionally, the current scroll state (e.g., `isSticky: true/false`) can be stored in `sessionStorage` to persist the sticky class across page reloads if the user was mid-scroll, improving perceived performance.\n- **Analytics**: Click events on navigation links may be tracked (e.g., via Google Analytics) to measure navigation usage. No server-side data storage is required for the sticky functionality itself.\n- **No Database Changes**: This feature is purely presentational and client-side; no new database tables or persistent data storage are needed.\n\n9. UI Impact\n- **CSS**: Add a `.is-sticky` class to the header's stylesheet with:\n  ```css\n  .site-header.is-sticky {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    z-index: 1000;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1); /* Optional visual indicator */\n  }\n  ```\n- **Responsive Behavior**: On mobile (<768px), the sticky class applies only to the top bar containing the logo and hamburger icon, not the expanded mobile menu overlay.\n- **Visual Feedback**: Optionally, the header's background opacity or color can transition when becoming sticky to indicate state change (e.g., from transparent to solid white).\n- **Spacing Adjustment**: When the header becomes fixed, it is removed from the document flow. To prevent content jump, the script should add equivalent `padding-top` to the `<body>` or a spacer element equal to the header's height when the sticky class is applied.\n\n10. Acceptance Criteria\n- **AC1**: On a desktop viewport (width ≥768px), when the user scrolls down more than 50px, the navigation header becomes fixed at the top of the viewport and remains there during further scrolling.\n- **AC2**: When scrolling back up to within 50px of the top, the header returns to its original static position in the document flow.\n- **AC3**: Clicking any navigation link smoothly scrolls the page to the correct section and the sticky state updates correctly based on the final scroll position.\n- **AC4**: On mobile viewports (<768px), the header bar (with logo/hamburger) becomes sticky on scroll, and the mobile menu overlay closes automatically if open during scroll.\n- **AC5**: No layout shift or content jump occurs when the header switches to fixed positioning (i.e., the main content does not unexpectedly move up).\n- **AC6**: The sticky functionality works correctly across Chrome, Firefox, Safari, and Edge latest versions, with no JavaScript errors in the console during scroll events.\n- **AC7**: If the page has insufficient content to scroll, the header remains static and no sticky class is applied.\n\n### F-03: Hamburger Menu for Mobile\n\n1. Purpose\nTo provide an accessible, space-efficient navigation interface on mobile viewports (width < 768px) by collapsing the standard horizontal navigation bar into a toggleable vertical menu. This ensures all primary navigation links remain available without cluttering the small screen.\n\n2. Actors\n- Mobile User: The primary actor who interacts with the hamburger menu icon to show/hide navigation links.\n- Site Administrator (Indirect): Configures the navigation link structure, which the menu dynamically reflects.\n\n3. Trigger\nThe user's viewport width enters the mobile range (defined as less than 768px), causing the desktop navigation to be hidden and the hamburger menu icon to become visible in the header.\n\n4. Preconditions\n- The desktop navigation component (containing all primary links: Home, Leistungen, Kursplan, Kontakt) exists and is functional.\n- The page layout is responsive, using CSS media queries or a responsive framework.\n- The hamburger icon element is present in the DOM within the header, styled as `display: none` on desktop viewports.\n- All navigation links are defined in a single source (e.g., a JavaScript array or consistent HTML structure) to ensure the mobile menu can replicate them exactly.\n\n5. Main Flow\n1. User accesses the landing page on a mobile device or resizes their desktop browser window to a width less than 768px.\n2. The responsive CSS/JavaScript detects the viewport change. The desktop navigation bar is hidden (`display: none`), and the hamburger icon element is shown (`display: block` or `flex`).\n3. The user taps the hamburger icon.\n4. JavaScript intercepts the tap event, toggles a CSS class (e.g., `.is-open`) on a dedicated mobile menu container.\n5. The mobile menu container, previously hidden (`max-height: 0`, `opacity: 0`, or `display: none`), becomes visible with a smooth transition. It expands vertically, typically overlaying the page content or pushing it down.\n6. The hamburger icon visually transforms (e.g., morphs into an 'X' or changes background image) to indicate the open state. The `aria-expanded` attribute on the icon button is updated to `\"true\"`.\n7. The user views the list of navigation links, now displayed in a vertical stack.\n8. The user either:\n   a. Taps a navigation link: The browser navigates to the corresponding anchor section (e.g., `#leistungen`). The menu collapse flow (step 9) is triggered.\n   b. Taps the now 'X'-shaped icon again: The menu collapse flow (step 9) is triggered without navigation.\n9. JavaScript removes the `.is-open` class from the mobile menu container. The container collapses and becomes hidden. The hamburger icon reverts to its original state, and `aria-expanded` is set to `\"false\"`.\n\n6. Alternate Flows\n- **A1: Viewport Resize During Open Menu**\n  1. While the mobile menu is open (`.is-open` class active), the user rotates their device or resizes the browser window to a width of 768px or greater.\n  2. A `resize` event listener detects the new viewport width.\n  3. JavaScript immediately removes the `.is-open` class from the mobile menu container, ensuring it is hidden.\n  4. The desktop navigation bar is shown (`display: flex` or `block`), and the hamburger icon is hidden (`display: none`).\n  5. The system state is consistent with the desktop view.\n- **A2: Tap Outside Menu to Close**\n  1. The mobile menu is open.\n  2. The user taps on any part of the main page content outside the boundaries of the open mobile menu container.\n  3. A global touch/click event listener detects the tap target is not within the menu container or the hamburger button.\n  4. The listener programmatically triggers the menu collapse logic (steps 9 of Main Flow).\n  5. The menu closes, and the icon state resets.\n\n7. Postconditions\n- The mobile menu's visual state (open or closed) always corresponds to the last user action and the current viewport width.\n- On mobile viewports, the desktop navigation is never visible simultaneously with the hamburger icon.\n- All primary navigation links are accessible through the mobile menu when it is open.\n- The hamburger icon's visual state and `aria-expanded` attribute accurately reflect the menu's state.\n- If A2 is implemented, tapping the main content area closes an open menu.\n\n8. Data Impact\n- No persistent data is created, stored, or modified by this feature.\n- Optional: A non-persistent analytics event (e.g., `menu_toggle`) may be fired upon each toggle action for interaction tracking, but this does not affect core functionality.\n\n9. UI Impact\n- **New Elements:**\n  - A hamburger icon button (typically `<button>` with `aria-label=\"Menü öffnen/schließen\"`), positioned in the header, visible only on mobile.\n  - A mobile menu container `<div>` (or `<nav>`) that houses a cloned or dynamically generated list of the primary navigation links. This container is hidden by default on mobile.\n- **Style Changes (CSS):**\n  - Media query `@media (max-width: 767px)`:\n    - Hides the desktop navigation (`display: none` on its container).\n    - Shows the hamburger icon (`display: block`).\n    - Styles the mobile menu container (position: fixed/absolute, full width, background color, z-index).\n    - Defines transition effects for opening/closing (e.g., `max-height`, `transform`, `opacity`).\n  - Class `.is-open` applied to the mobile menu container to trigger its visible state.\n  - Class `.is-active` (or similar) applied to the hamburger button to change its icon (e.g., using a background image swap or SVG transformation).\n- **Accessibility:**\n  - Hamburger button must have `aria-controls` pointing to the mobile menu container's ID.\n  - The mobile menu container must have `aria-hidden=\"true\"` when closed and `aria-hidden=\"false\"` when open.\n  - Focus management is recommended: when the menu opens, focus should move to the first link inside it; when it closes, focus returns to the hamburger button.\n\n10. Acceptance Criteria\n- **AC1:** On viewport widths < 768px, the desktop navigation bar is not visible, and the hamburger icon is visible in the header.\n- **AC2:** On viewport widths >= 768px, the hamburger icon is not visible, and the standard desktop navigation bar is visible.\n- **AC3:** Tapping the hamburger icon on a mobile viewport immediately displays a vertical list of all primary navigation links (Home, Leistungen, Kursplan, Kontakt).\n- **AC4:** The mobile menu contains a visually distinct close mechanism (either the transformed 'X' icon or a dedicated \"Schließen\" button/link) that functions identically to tapping the icon again.\n- **AC5:** Tapping any navigation link within the open mobile menu navigates the user to the correct page section and automatically closes the menu.\n- **AC6:** The mobile menu can be closed by tapping the close mechanism (icon/X) without navigation occurring.\n- **AC7:** (If A2 implemented) Tapping anywhere in the main page content area while the mobile menu is open closes the menu.\n- **AC8:** (If A1 implemented) Rotating or resizing the mobile browser window to a width >= 768px while the menu is open automatically closes the menu and shows the desktop navigation.\n- **AC9:** The hamburger icon and mobile menu container have the correct ARIA attributes (`aria-label`, `aria-expanded`, `aria-controls`, `aria-hidden`) that update in real-time with the menu state.\n- **AC10:** The transition between open and closed states is smooth (e.g., fade or slide) without layout shifts or content jumps on the underlying page.\n\n### F-04: Hero Section with Background Image\n\n1. Purpose\nTo create an immediate visual impact and brand recognition by displaying a full-width, high-quality background image with the studio's name and tagline prominently overlaid. This section establishes the studio's aesthetic and provides a clear entry point to the website.\n\n2. Actors\nPrimary: Website Visitor (any user accessing the landing page).\nSecondary: Content Administrator (theoretically, for updating the image or text, though this is a static front-end feature in this scope).\n\n3. Trigger\nThe browser completes the initial parsing of the HTML document and begins rendering the `<body>` content.\n\n4. Preconditions\n1.  The landing page HTML file (`index.html`) is served.\n2.  The background image asset (e.g., `hero-background.jpg`) is available in the defined assets directory (e.g., `/assets/images/`).\n3.  The studio name (\"[Studio Name]\") and tagline (\"[Studio Tagline]\") text strings are hard-coded in the HTML or available via a static configuration.\n4.  The user's browser supports CSS3 background properties and Flexbox/Grid layout.\n\n5. Main Flow\n1.  The browser parses the HTML and encounters the `<section>` element with the ID or class `hero-section`.\n2.  The browser applies the CSS rule for `hero-section` which sets `width: 100%`, `height: 100vh` (or a fixed `min-height` like `600px`), and `position: relative`.\n3.  The CSS rule applies the background image using `background-image: url('/assets/images/hero-background.jpg');`, along with `background-size: cover`, `background-position: center`, and `background-repeat: no-repeat`.\n4.  The browser renders the background image. If the image has not fully loaded, a solid background color (e.g., `#f5f5f5`) defined in the CSS is displayed as a placeholder.\n5.  The browser parses the child `<div>` container (e.g., class `hero-content`) within the section.\n6.  The CSS for `hero-content` applies `position: absolute` or uses Flexbox/Grid to center its content both vertically and horizontally within the `hero-section`.\n7.  The browser renders the `<h1>` element containing the studio name. The CSS applies a text styling (e.g., `color: white`, `text-shadow: 0 2px 4px rgba(0,0,0,0.5)`) to ensure legibility against the background image.\n8.  The browser renders the `<p>` or `<h2>` element containing the tagline, with appropriate, smaller typography and the same legibility styling.\n9.  The browser applies a semi-transparent dark overlay (e.g., `background: rgba(0, 0, 0, 0.3);`) on the `hero-section` or `hero-content` container to further enhance text contrast, as defined in the CSS.\n10. The final rendered hero section is visible to the user, with the background image covering the full viewport width and height, and the text centered and clearly readable.\n\n6. Alternate Flows\n1.  **Background Image Fails to Load:** The browser cannot retrieve the image file (404 error or network issue). The CSS-defined solid background color remains visible. The text overlay is still rendered and legible against this solid color. A console error is logged.\n2.  **High-Resolution/Retina Display:** The browser on a high-DPI device requests a higher-resolution image if a `srcset` attribute is provided on a semantic `<img>` tag (alternative implementation) or if a media query serves a different image file. The main flow adapts to serve `hero-background@2x.jpg`.\n3.  **Very Narrow Viewport (Mobile Portrait):** The viewport width is less than 320px. The CSS media query (`@media (max-width: 320px)`) triggers, reducing the `font-size` of the `<h1>` and tagline, and potentially reducing the `min-height` of the section to prevent excessive vertical whitespace. The text may wrap to a second line.\n4.  **User has \"Reduce Motion\" Accessibility Preference:** The user's OS/browser setting `prefers-reduced-motion` is active. Any CSS transition or animation intended for the hero content (e.g., fade-in) is disabled, and the content is rendered immediately without animation.\n\n7. Postconditions\n1.  The DOM contains a visible `<section>` element occupying the top of the viewport.\n2.  The computed style of this section includes a background image (or the fallback color) set to `cover` the area.\n3.  The studio name and tagline text nodes are present in the DOM, are direct children of the centered container, and have computed styles ensuring they are positioned over the background.\n4.  The visual contrast ratio between the text and the background (including overlay) meets WCAG AA standards (≥ 4.5:1 for normal text).\n\n8. Data Impact\n*   **No Persistent Data Storage:** This feature does not read from or write to any database, server-side session, or client-side storage (localStorage/cookies).\n*   **Static Asset Transfer:** The web server delivers the static image file (`hero-background.jpg`) to the client's browser. Server logs may record a GET request for this asset.\n\n9. UI Impact\n*   **DOM Structure:** Adds a top-level `<section id=\"hero\">` containing a content wrapper (`<div class=\"hero-content\">`), an `<h1>`, and a tagline element.\n*   **CSS:** Requires styles for full-width/height, background image handling, absolute/flex centering, typography, text shadow/overlay for contrast, and responsive breakpoints.\n*   **Responsive Behavior:** The section must adapt to all viewport widths (mobile to desktop). Text size and container padding must adjust via media queries. The background image remains centered and covers the area.\n*   **Accessibility:** The text must have sufficient color contrast. If the image is purely decorative, the section should have `aria-hidden=\"true\"` or the image should be implemented via CSS (as specified) to be ignored by screen readers. The `<h1>` must be the first heading on the page.\n\n10. Acceptance Criteria\n1.  **AC1:** Upon loading the landing page, a hero section is visible at the top, spanning the entire viewport width.\n2.  **AC2:** The hero section displays the specified background image, scaled to cover the entire section without distortion (aspect ratio preserved, no cropping of the central subject).\n3.  **AC3:** The studio name is displayed as a large, prominent heading (`<h1>`) and the tagline as a subheading, both centered horizontally and vertically within the hero section.\n4.  **AC4:** The text remains clearly readable against the background image in all standard lighting conditions (verified via contrast ratio tool).\n5.  **AC5:** On viewport widths below 768px, the font sizes of the heading and tagline reduce appropriately, and no horizontal scrolling is introduced by the hero section.\n6.  **AC6:** If the background image URL is deliberately broken (404), the section displays the fallback background color and the text remains fully legible and centered.\n7.  **AC7:** The hero section renders correctly in the latest versions of Chrome, Firefox, Safari, and Edge.\n\n### F-05: Hero Call‑to‑Action Button\n\n1. Purpose\nTo provide a prominent, clearly visible button in the hero section of the landing page that encourages website visitors to navigate directly to the contact form, thereby increasing lead generation and inquiries for the yoga studio.\n\n2. Actors\n*   Primary Actor: Website Visitor\n*   Secondary Actor: Studio Staff (indirectly, via analytics)\n\n3. Trigger\nThe rendering of the landing page's hero section.\n\n4. Preconditions\n*   The landing page is successfully served and rendered in the user's browser.\n*   The hero section HTML structure is present.\n*   The target contact form page (`/contact` or equivalent) exists, is published, and is accessible.\n*   The button's link `href` attribute is correctly configured to point to the contact form's URL.\n\n5. Main Flow\n1.  The user's browser requests and receives the landing page HTML.\n2.  The browser parses the HTML and renders the hero section.\n3.  The hero Call‑to‑Action (CTA) button is rendered with visible text (e.g., \"Jetzt Kurs anfragen\" or \"Kontakt aufnehmen\").\n4.  The user visually identifies the button as a primary action element.\n5.  The user positions the pointer over the button and clicks (or taps) the primary mouse button / touches the screen.\n6.  The browser receives the click event on the button element.\n7.  The browser navigates to the URL specified in the button's `href` attribute (the contact form page).\n8.  The contact form page loads successfully in the browser.\n\n6. Alternate Flows\n*   **A1: Contact Form Page Fails to Load.** After step 7 in the Main Flow, the requested contact form URL returns an HTTP error (e.g., 404 Not Found, 500 Server Error) or fails to load. The browser displays an error page. **System Response:** The button remains clickable, but the navigation target is invalid. This is a configuration/data error, not a flow error.\n*   **A2: Button Temporarily Disabled.** In a future state, the studio may wish to pause new inquiries. The button's `disabled` attribute is set via backend logic or a feature flag. The button is rendered but is not interactive (greyed out, cursor shows 'not-allowed'). **System Response:** Clicking/tapping the button has no effect. No navigation occurs.\n\n7. Postconditions\n*   The user's browser displays the contact form page.\n*   A click event for the specific CTA button (identified by a unique CSS class or ID) is recorded in the analytics/logging system with a timestamp and session identifier.\n*   The landing page remains in the browser's history (back button functionality is preserved).\n\n8. Data Impact\n*   A new event log entry is created: `event_type: \"cta_click\"`, `element_id: \"hero-cta-button\"`, `page: \"landing-page\"`, `timestamp: [current_utc_time]`, `session_id: [user_session]`.\n*   No personal user data is stored or modified by this interaction alone.\n*   Referrer data (landing page URL) is passed to the contact form page via the HTTP `Referer` header.\n\n9. UI Impact\n*   **Visual Design:** The button must use the studio's primary brand color, have sufficient color contrast with its background (WCAG AA minimum), and include clear, action-oriented text. It must be visually distinct from other hero elements.\n*   **Placement:** Positioned centrally or aligned with the studio's visual hierarchy within the hero section, typically below the main headline and subheadline.\n*   **Responsiveness:** The button must be fully visible and tappable on all viewport sizes (mobile, tablet, desktop). Minimum touch target size of 44x44px.\n*   **Interactivity:** Visual feedback on hover (e.g., color darken, slight lift) and active (pressed) states. Focus ring must be visible for keyboard navigation (Tab key).\n*   **Accessibility:** The button element must be a native `<button>` or an `<a>` with `role=\"button\"`. It must have an accessible name (via visible text or `aria-label`). The `href` attribute must be present and valid for navigation.\n\n10. Acceptance Criteria\n*   **AC1:** On a standard desktop viewport (≥1024px), the hero CTA button is visible within the hero section without requiring vertical scrolling.\n*   **AC2:** On a standard mobile viewport (≤375px), the hero CTA button is fully visible and its touch target meets the minimum size requirement.\n*   **AC3:** Clicking/tapping the button navigates the browser to the exact, correct URL of the published contact form page within 2 seconds under normal network conditions.\n*   **AC4:** The button displays correct hover and focus states as defined in the UI design specifications.\n*   **AC5:** An analytics event with `event_type: \"cta_click\"` and `element_id: \"hero-cta-button\"` is successfully transmitted to the analytics endpoint upon a click.\n*   **AC6:** The button's text is legible and meets WCAG 2.1 AA contrast ratio requirements against its background.\n*   **AC7:** The button can be focused and activated using only the keyboard (Tab to focus, Enter/Space to activate).\n\n### F-06: Services Overview Section\n\n1. Purpose\nTo present a concise, visually engaging overview of the yoga studio's core service offerings (e.g., class types like Hatha, Vinyasa, Yin) directly on the landing page. This section aims to quickly inform visitors about the studio's specialties, encourage deeper exploration, and drive interest in booking a class.\n\n2. Actors\nPrimary: Website Visitor (unauthenticated user).\nSecondary: Content Administrator (manages service data via a separate backend CMS/admin panel, not part of this feature's runtime).\n\n3. Trigger\nThe rendering of the Services Overview Section is triggered automatically when a user navigates to the landing page (`/`) and the section enters the viewport (or on page load if above the fold).\n\n4. Preconditions\n*   The user has an active internet connection and a modern web browser.\n*   The frontend application is loaded and initialized.\n*   The backend API endpoint (`GET /api/services`) is available and returns data for active services.\n*   At least one service is marked as \"active\" in the backend data store.\n\n5. Main Flow\n1.  The user's browser loads the landing page HTML and associated JavaScript bundles.\n2.  The frontend JavaScript executes and identifies the DOM container for the Services section.\n3.  The frontend issues an asynchronous `GET` request to the configured backend API endpoint (e.g., `/api/services?limit=4&sort=order`).\n4.  The backend API receives the request, queries the data store for active service records, and returns a JSON array containing objects with the fields: `id`, `name` (string), `short_description` (string, max 120 chars), `image_url` (string, absolute URL), `slug` (string, for linking).\n5.  The frontend receives a `200 OK` response with the service data array.\n6.  The frontend iterates over the array and dynamically generates a service card component for each item.\n7.  Each card is inserted into the section's container in the specified order. The card structure is:\n    *   An `<img>` element using the `image_url` as `src` and `alt` text set to `[Service Name] - [Studio Name] Yoga`.\n    *   An `<h3>` heading displaying the `name`.\n    *   A `<p>` paragraph displaying the `short_description`.\n    *   A styled \"Learn More\" button/link pointing to `/services/[slug]` (or a modal trigger if detailed pages are not implemented).\n8.  The fully rendered section becomes visible to the user.\n9.  The frontend analytics module logs an impression event for the \"Services Overview Section\".\n\n6. Alternate Flows\n*   **A1: API Request Fails (Network/5xx Error).** The frontend `catch` block executes. The section container displays a static, server-side rendered fallback message: \"Our diverse yoga offerings are currently being updated. Please check back soon.\" No service cards are rendered. A console error is logged, and an error event is sent to the analytics service.\n*   **A2: API Returns Empty Array.** The frontend logic detects an empty array. The section container displays a fallback message: \"No services are currently listed.\" The section's visual container remains but is empty or contains the message. An analytics event for \"services_empty\" is logged.\n*   **A3: Individual Service Data Incomplete.** During card generation, if a specific service object lacks a `short_description` or `image_url`, the frontend uses predefined fallback values: a generic description text (\"A classic yoga practice.\") and a default placeholder image from the static assets (`/images/service-placeholder.jpg`). The card is still rendered to maintain layout integrity.\n\n7. Postconditions\n*   The Services Overview Section is fully rendered in the DOM with either:\n    *   A grid of service cards (1-4, as limited by API) for each active service.\n    *   A fallback message (in case of error or no data).\n*   All images in successfully rendered cards have initiated a network request for their source file.\n*   An analytics impression event has been dispatched.\n*   The user can interact with the \"Learn More\" buttons/links on each card.\n\n8. Data Impact\n*   **Read:** The feature reads from the `services` data table/collection. Required fields per record: `id` (PK), `name`, `short_description`, `image_url`, `slug`, `is_active` (boolean), `display_order` (integer).\n*   **Write:** This feature does not write or modify any data. All content management is performed via a separate administrative interface.\n*   **API Contract:** Defines a required `GET /api/services` endpoint that accepts optional query parameters (`limit`, `sort`) and returns a JSON array of service objects with the specified schema.\n\n9. UI Impact\n*   **New Components:** `ServiceCard` component.\n*   **Layout:** A responsive grid (CSS Grid or Flexbox) that displays 1 column on mobile, 2 on tablet, and 3-4 on desktop.\n*   **Styling:** Consistent card design with shadow, border-radius, and hover lift effect. Image has `object-fit: cover` and fixed aspect ratio (e.g., 4:3). Typography follows the studio's brand guidelines.\n*   **Accessibility:** All images have descriptive `alt` attributes. Buttons are focusable and have visible focus states. The section has an `aria-labelledby` pointing to its heading (`<h2>`).\n*   **States:** Loading skeleton state is shown immediately while the API request is pending (optional but recommended). Error/empty states as defined in Alternate Flows.\n\n10. Acceptance Criteria\n*   **AC1:** Upon successful load, the section displays a minimum of 1 and a maximum of 4 service cards, sorted by `display_order`.\n*   **AC2:** Each rendered card correctly displays the service's `name`, `short_description`, and associated `image` with proper `alt` text.\n*   **AC3:** The \"Learn More\" button on each card is a functional link pointing to the correct service-specific URL path (`/services/[slug]`).\n*   **AC4:** The grid layout is responsive and adapts correctly to viewport widths: 1 column (mobile <768px), 2 columns (tablet >=768px), 3 columns (desktop >=1024px), 4 columns (large desktop >=1280px) if 4+ services exist.\n*   **AC5:** If the API call fails or returns no active services, the appropriate fallback message is displayed within the section's container.\n*   **AC6:** An analytics event with name `services_section_impression` is logged exactly once when the section becomes visible in the viewport.\n*   **AC7:** If a service record lacks an image or description, the card renders using the defined fallback values without layout breakage.\n*   **AC8:** All interactive elements (buttons/links) meet WCAG 2.1 AA contrast requirements and have visible keyboard focus indicators.\n\n### F-07: Individual Service Card Component\n\n1. Purpose\nTo render a visually consistent, self-contained card component that presents a single yoga studio service (e.g., \"Hatha Yoga\", \"Prenatal Yoga\") to a website visitor. The component displays an identifying icon, the service's title, and a concise descriptive text, enabling quick scanning and understanding of the studio's offerings within the \"Leistungen\" (Services) section.\n\n2. Actors\n- Primary: End User (website visitor) who reads the service information.\n- Secondary: Content Editor (studio staff) who manages the service data in the backend CMS.\n\n3. Trigger\nThe component is triggered to render when the parent \"Services Section\" component processes the array of active service objects provided by the CMS and iterates over them, instantiating an `IndividualServiceCard` for each object in the array.\n\n4. Preconditions\n- The CMS contains at least one published service entry with valid data for the required fields: `id`, `title`, `description`, and `iconIdentifier`.\n- The parent Services Section component has successfully fetched and parsed the list of active services from the CMS API.\n\n5. Main Flow\n1.  The `IndividualServiceCard` component receives a single `service` object as a prop from its parent component.\n2.  The component validates the presence of required props (`title`, `iconIdentifier`). If validation fails, it logs a development error and renders a fallback placeholder card (see Alternate Flow A1).\n3.  The component renders a top-level `<article>` container with a specific CSS class (e.g., `.service-card`) for styling and accessibility.\n4.  Inside the container, the component renders an `<span>` or `<div>` for the icon. It uses the `iconIdentifier` prop to select and render the corresponding SVG icon from a pre-defined, locally imported icon set.\n5.  The component renders an `<h3>` heading element containing the `title` prop text.\n6.  The component renders a `<p>` paragraph element containing the `description` prop text.\n7.  The component applies responsive CSS classes to ensure proper spacing, alignment, and card dimensions across mobile, tablet, and desktop viewports as defined in the global design system.\n\n6. Alternate Flows\nA1: Missing Icon Data - If the `iconIdentifier` prop is null, undefined, or does not match any key in the icon set, the component renders a default \"service\" placeholder icon (e.g., a generic leaf or circle symbol) instead of failing.\nA2: Excessive Description Length - If the `description` text exceeds 150 characters, the component automatically truncates the text and appends an ellipsis (\"...\"). The full text remains available in the `title` attribute of the `<p>` element for hover tooltips.\nA3: Empty Description - If the `description` prop is an empty string, the component renders the icon and title but omits the `<p>` element entirely to avoid visual whitespace.\n\n7. Postconditions\n- A single, styled service card is present in the DOM, correctly positioned within the parent services grid or list.\n- The card displays an icon (either specified or default), the service title, and the description (full or truncated).\n- The card's HTML structure is semantically correct (using `<article>`, `<h3>`, `<p>`).\n- The component's CSS classes are applied, ensuring visual consistency with the design system.\n\n8. Data Impact\n- **Read Access:** The component reads a single service object from its parent's props. The data structure must include: `id` (string/number), `title` (string, required), `description` (string, required), `iconIdentifier` (string, required).\n- **Write Access:** None. The component is presentational and does not modify data.\n- **Storage:** No new data is stored. It relies entirely on the existing service dataset managed in the CMS.\n\n9. UI Impact\n- **Layout:** The card must fit within a responsive grid (e.g., CSS Grid or Flexbox) defined by the parent Services Section. It must have a fixed or flexible width, consistent padding, and border-radius as per the design system.\n- **Styling:** Must use the studio's color palette (primary, secondary, text colors) and typography scale (font family, sizes for title and description). Includes hover state styling (e.g., subtle shadow increase, border color change).\n- **Accessibility:** The `<h3>` heading must be programmatically associated with the card's content. If the icon is purely decorative, it must have `aria-hidden=\"true\"`. If the icon conveys meaning, it requires an `aria-label` or `role=\"img\"`. The color contrast ratio between text and background must meet WCAG AA standards.\n- **Responsiveness:** The card's internal layout (icon above title, etc.) must remain intact and legible on viewports from 320px width upwards. The parent grid's column count must adjust based on viewport width (e.g., 1 column mobile, 2 tablet, 3 desktop).\n\n10. Acceptance Criteria\n- **AC1:** Given a valid service object with all fields, when rendered, then the card displays the correct icon, title, and full description text.\n- **AC2:** Given a service object with a `description` of 200 characters, when rendered, then the displayed description is truncated to 150 characters plus an ellipsis, and the full text is in the `title` attribute.\n- **AC3:** Given a service object with a `description` of exactly 150 characters, when rendered, then the full description is displayed without truncation.\n- **AC4:** Given a service object with an invalid or missing `iconIdentifier`, when rendered, then the default placeholder icon is displayed.\n- **AC5:** Given a service object with an empty `description`, when rendered, then the card contains only the icon and title, with no empty paragraph element in the DOM.\n- **AC6:** The component renders without visual or layout breaking when placed in a parent grid with 1, 2, or 3 columns.\n- **AC7:** The component passes automated accessibility audits (e.g., axe-core) for color contrast, heading hierarchy, and ARIA attributes.\n\n### F-08: Course Schedule Section\n\n### 1. Purpose\nProvide website visitors with a clear, up‑to‑date weekly overview of all yoga classes offered by the studio, including date, start‑time, duration, class type, and instructor name. The section must enable quick visual scanning and support direct navigation to the booking form for each class.\n\n### 2. Actors\n| Actor | Role |\n|-------|------|\n| **Visitor** | Views the schedule, selects a class to book. |\n| **Studio Administrator** | Creates, updates, or deletes class entries via the CMS backend. |\n| **System (Web Server / API)** | Serves schedule data and logs access events. |\n\n### 3. Trigger\nThe schedule section is rendered automatically when the landing‑page URL (`/`) is requested and the page’s DOM reaches the “Course Schedule” placeholder element.\n\n### 4. Preconditions\n1. The CMS contains at least one active class entry for the current week.  \n2. The REST endpoint `GET /api/v1/schedule?week={ISO_WEEK_NUMBER}` is reachable and returns a JSON payload with a 200 status code.  \n3. The visitor’s browser supports JavaScript ES2022 and CSS Grid.  \n4. The visitor’s locale is either `de-DE` or `en-US`; the system defaults to `de-DE` if not detected.\n\n### 5. Main Flow (deterministic implementation steps)\n\n1. **Page Load** – Browser loads `index.html` and executes `main.js`.  \n2. **Determine Current Week** – `main.js` calculates the ISO week number of the current date (e.g., using `date-fns` library).  \n3. **API Request** – `main.js` sends an HTTP GET request to `/api/v1/schedule?week={ISO_WEEK_NUMBER}` with the header `Accept: application/json`.  \n4. **Receive Payload** – Server returns JSON structured as:  \n\n   ```json\n   {\n     \"week\": \"2024-W07\",\n     \"classes\": [\n       {\n         \"id\": \"c123\",\n         \"date\": \"2024-02-19\",\n         \"startTime\": \"08:00\",\n         \"durationMinutes\": 60,\n         \"type\": \"Vinyasa Flow\",\n         \"instructor\": \"Anna Müller\",\n         \"bookingUrl\": \"/booking?classId=c123\"\n       },\n       ...\n     ]\n   }\n   ```\n\n5. **Validate Payload** – `main.js` validates that:\n   - `week` matches the requested week.\n   - `classes` is an array of objects with all required fields.\n   - No duplicate `id` values exist.\n   If validation fails, jump to Alternate Flow A‑1.\n\n6. **Sort Classes** – Sort the `classes` array first by `date` (ascending) then by `startTime` (ascending).\n\n7. **Generate Grid Structure** – For each day Monday‑Sunday, create a column in a CSS Grid container (`#schedule-grid`). Within each column, create a row for every class belonging to that day.\n\n8. **Render Class Cards** – For each class object:\n   - Create a `<div class=\"class-card\" data-id=\"{id}\">`.\n   - Insert child elements:\n     - `<time datetime=\"{date}T{startTime}\">{formattedDate} – {formattedTime}</time>`\n     - `<h4 class=\"class-type\">{type}</h4>`\n     - `<p class=\"instructor\">Instructor: {instructor}</p>`\n     - `<a href=\"{bookingUrl}\" class=\"book-btn\">Jetzt buchen</a>`\n   - Apply ARIA roles: `role=\"listitem\"` for the card, `role=\"button\"` for the link.\n\n9. **Inject into DOM** – Append each completed column to `#schedule-grid`. Ensure the grid container has `role=\"table\"` and each column has `role=\"columnheader\"`.\n\n10. **Accessibility Enhancements** – Add `tabindex=\"0\"` to each class card, and provide a hidden `<span class=\"sr-only\">` describing the class details for screen readers.\n\n11. **Cache Result** – Store the received JSON in `sessionStorage` under key `schedule_{ISO_WEEK_NUMBER}` with a timestamp. Subsequent page loads within the same session read from cache instead of issuing a new API request.\n\n12. **Log Rendering** – Send a non‑blocking POST to `/api/v1/analytics` with payload `{event: \"schedule_rendered\", week: \"2024-W07\", count: <number_of_classes>}`.\n\n13. **Display Completed** – Remove the placeholder spinner (`#schedule-loading`) and reveal the populated grid.\n\n### 6. Alternate Flows\n| Flow | Condition | Steps |\n|------|-----------|-------|\n| **A‑1** | Payload validation fails | 1. Show error banner `<div class=\"schedule-error\">Fehler beim Laden des Kursplans. Bitte versuchen Sie es später erneut.</div>`.<br>2. Log error via POST to `/api/v1/analytics` with `{event:\"schedule_error\", details:<validation_error>}`.<br>3. End. |\n| **A‑2** | API returns HTTP 404 or 500 | 1. Display same error banner as A‑1.<br>2. Retry request after 30 seconds (max 2 retries).<br>3. If still failing, fall back to cached data if available; otherwise show error banner. |\n| **A‑3** | No classes for the requested week (`classes` array empty) | 1. Render a single centered message `<p class=\"no-classes\">In dieser Woche finden keine Kurse statt. Bitte prüfen Sie die nächste Woche.</p>`.<br>2. Provide navigation buttons “Vorherige Woche” and “Nächste Woche” that reload the section with the adjusted week number. |\n| **A‑4** | Visitor’s browser does not support CSS Grid | 1. Detect lack of support via `CSS.supports(\"display\", \"grid\")`.<br>2. Load fallback stylesheet `schedule-fallback.css` that uses a flex‑based vertical list.<br>3. Render classes in a single column list preserving all data fields. |\n| **A‑5** | Time‑zone mismatch (visitor’s locale differs from studio’s timezone) | 1. Detect visitor’s timezone via `Intl.DateTimeFormat().resolvedOptions().timeZone`.<br>2. Convert `date` and `startTime` from studio timezone (Europe/Berlin) to visitor’s timezone using `date-fns-tz` before rendering.<br>3. Append a small note “Zeiten in Ihrer Zeitzone” under the grid header. |\n\n### 7. Postconditions\n- The DOM contains a fully populated, accessible schedule grid (`#schedule-grid`) reflecting the current week’s classes, or an error/empty‑state message if applicable.  \n- Session storage holds the schedule JSON for the displayed week with a timestamp.  \n- Analytics endpoint has recorded either a `schedule_rendered` or `schedule_error` event.  \n- No server‑side data was modified; the operation is read‑only.\n\n### 8. Data Impact\n| Operation | Data Modified | Persistence |\n|-----------|---------------|-------------|\n| GET `/api/v1/schedule` | Reads `class` records for the requested week from the database. | No write operation. |\n| POST `/api/v1/analytics` | Inserts a new analytics record. | Persistent (audit log). |\n| SessionStorage write | Stores JSON payload locally. | Exists until browser tab is closed or overwritten. |\n\n### 9. UI Impact\n- **New Section**: `<section id=\"course-schedule\">` inserted below the “Leistungen” block.  \n- **Responsive Layout**: CSS Grid with `grid-template-columns: repeat(7, 1fr);` on screens ≥ 768 px; single‑column flex layout on smaller screens.  \n- **Styling**: New SCSS file `schedule.scss` compiled to `schedule.css`, defining `.class-card`, `.book-btn`, `.schedule-error`, and `.no-classes`.  \n- **Accessibility**: ARIA roles, keyboard navigation, and screen‑reader text as described in Main Flow step 10.  \n- **Loading Indicator**: `<div id=\"schedule-loading\" class=\"spinner\"></div>` displayed until step 13.  \n- **Navigation Controls**: “Vorherige Woche” / “Nächste Woche” buttons added to the section header for week navigation (used in Alternate Flow A‑3).  \n\n### 10. Acceptance Criteria\n1. **Correct Data Rendering** – For a given ISO week, the grid displays every class exactly once, ordered by day and start time, with accurate date, time, type, instructor, and functional “Jetzt buchen” link.  \n2. **Error Handling** – Simulated API 500 response triggers the error banner and logs an `schedule_error` event; the banner disappears after a successful retry.  \n3. **Empty Week** – When the API returns an empty `classes` array, the “no classes” message appears and navigation buttons correctly load the previous and next weeks.  \n4. **Cache Utilization** – Reloading the page within the same browser session does not issue a second API call; the schedule is loaded from `sessionStorage`.  \n5. **Responsive Design** – On viewport widths ≥ 768 px the grid shows seven columns; on < 768 px it collapses to a single column list without loss of information.  \n6. **Accessibility** – All class cards are reachable via Tab, have appropriate ARIA roles, and screen readers announce date, time, type, and instructor. Automated accessibility test (axe-core) reports zero violations.  \n7. **Timezone Conversion** – When the visitor’s timezone differs from Europe/Berlin, displayed times reflect the visitor’s local time and a note “Zeiten in Ihrer Zeitzone” is visible.  \n8. **Analytics Logging** – Each successful render sends a POST with `event:\"schedule_rendered\"` and correct `count`; each failure sends `event:\"schedule_error\"` with a non‑empty `details` field.  \n9. **Performance** – Initial render (including API call) completes within 800 ms on a 3G connection measured by Lighthouse.  \n10. **Browser Compatibility** – Feature works without degradation on the latest versions of Chrome, Firefox, Safari, and Edge; on browsers lacking CSS Grid, the fallback layout is applied and passes visual regression tests.\n\n### F-09: Course Detail Modal\n\n1. Purpose  \n   Provide visitors with a full, on‑demand view of a specific yoga class (description, instructor, duration, capacity, prerequisites, and enrollment link) without leaving the schedule section, thereby increasing conversion from schedule browsing to booking.\n\n2. Actors  \n   - **Visitor** – interacts with the schedule entry on the landing page.  \n   - **Frontend Application** – HTML/JS/CSS running in the visitor’s browser.  \n   - **Backend API** – REST endpoint that returns detailed course data in JSON format.  \n\n3. Trigger  \n   Visitor clicks (or taps) on a schedule entry card/button representing a single class in the “Kursplan” section.\n\n4. Preconditions  \n   1. The landing page has fully loaded and the schedule grid is rendered.  \n   2. Each schedule entry includes a data attribute `data-course-id` containing a valid UUID.  \n   3. The modal component (`<div id=\"course-detail-modal\">`) exists in the DOM but is hidden (`display:none`).  \n   4. The browser can reach the backend API at `/api/courses/{id}` (CORS allowed).  \n\n5. Main Flow  \n   1. Visitor clicks a schedule entry.  \n   2. Frontend captures the click event on the element with class `.schedule-entry`.  \n   3. Frontend extracts the `data-course-id` value (`COURSE_ID`).  \n   4. Frontend disables page scrolling (`document.body.style.overflow = 'hidden'`).  \n   5. Frontend adds a semi‑transparent overlay element (`<div class=\"modal-backdrop\">`) to the DOM.  \n   6. Frontend sends an asynchronous GET request to `/api/courses/COURSE_ID` with `Accept: application/json`.  \n   7. Backend validates `COURSE_ID`, retrieves the course record, and returns JSON:  \n      ```json\n      {\n        \"id\": \"UUID\",\n        \"title\": \"String\",\n        \"description\": \"String\",\n        \"instructor\": \"String\",\n        \"durationMinutes\": Number,\n        \"capacity\": Number,\n        \"prerequisites\": \"String\",\n        \"enrollmentUrl\": \"String\"\n      }\n      ```  \n   8. Frontend receives the response within 200 ms (network timeout set to 3 s).  \n   9. Frontend populates modal fields:  \n      - `#modal-title` ← `title`  \n      - `#modal-description` ← `description`  \n      - `#modal-instructor` ← `instructor`  \n      - `#modal-duration` ← `durationMinutes` + \" min\"  \n      - `#modal-capacity` ← `capacity` + \" Plätze\"  \n      - `#modal-prerequisites` ← `prerequisites`  \n      - `#modal-enroll` href ← `enrollmentUrl`  \n   10. Frontend sets ARIA attributes: `role=\"dialog\"`, `aria-modal=\"true\"`, `aria-labelledby=\"modal-title\"`.  \n   11. Frontend makes the modal visible (`display:block`) and moves focus to the close button (`#modal-close`).  \n   12. Visitor can close the modal by:  \n       a. Clicking the close button (`#modal-close`).  \n       b. Clicking the overlay backdrop.  \n       c. Pressing the `Esc` key.  \n   13. On close, frontend removes the overlay, restores page scrolling, returns focus to the originally clicked schedule entry, and hides the modal (`display:none`).  \n\n6. Alternate Flows  \n   **A1 – API returns error (404 or 500)**  \n   1. Steps 1‑6 of Main Flow execute.  \n   2. Backend responds with HTTP status ≥400.  \n   3. Frontend displays an error message inside the modal body: “Die Kursdetails konnten nicht geladen werden. Bitte versuchen Sie es später erneut.”  \n   4. All other modal fields remain hidden.  \n   5. Visitor can close the modal using the same mechanisms as in step 12.  \n\n   **A2 – Network timeout (no response within 3 s)**  \n   1. Steps 1‑6 of Main Flow execute.  \n   2. Frontend aborts the request after 3 s.  \n   3. Frontend shows a spinner for 1 s, then replaces it with the same error message as A1.  \n\n   **A3 – Missing `data-course-id` attribute**  \n   1. Visitor clicks an element lacking the attribute.  \n   2. Frontend logs a client‑side error to the console and aborts the flow; no modal is opened.  \n\n7. Postconditions  \n   - **Success path:** Modal is hidden, page scroll restored, and no residual overlay remains. System state is unchanged except that a read‑only API call was logged.  \n   - **Error path:** Modal is displayed with an error message; after closure, the system returns to the same state as the success path.  \n\n8. Data Impact  \n   - Read‑only retrieval of a single course record.  \n   - No creation, update, or deletion of data.  \n   - API call is logged for analytics (timestamp, course ID, response status).  \n\n9. UI Impact  \n   - New modal markup inserted into the landing page HTML template.  \n   - CSS classes: `.modal-backdrop`, `.course-detail-modal`, responsive layout (mobile: full‑width, desktop: centered 600 px).  \n   - JavaScript module `courseDetailModal.js` exposing `initCourseDetailModal()` to bind click listeners.  \n   - Accessibility: focus trap inside modal, `Esc` key handling, ARIA roles, sufficient color contrast.  \n\n10. Acceptance Criteria  \n   1. Clicking any schedule entry opens the modal within 200 ms after the API response.  \n   2. All fields display exactly the data returned by the API; titles, durations, and capacities match the backend values.  \n   3. Modal can be closed by close button, backdrop click, or `Esc` key; after close, focus returns to the original schedule entry.  \n   4. In case of API error or timeout, the error message is shown and the modal remains closable.  \n   5. No page scroll occurs while the modal is open; scroll is restored after close.  \n   6. The modal passes WCAG 2.1 AA accessibility tests (focus trap, ARIA attributes, keyboard operability).  \n   7. Automated unit tests cover: successful data load, API error handling, timeout handling, missing `data-course-id`.  \n   8. End‑to‑end tests verify that a visitor can open a modal, view details, and close it on desktop (Chrome 120) and mobile (iOS Safari 17).\n\n### F-10: Contact Form Component\n\n1. Purpose\nTo provide a mechanism for website visitors to submit inquiries about the yoga studio's offerings and to request booking for specific classes. The component captures essential contact and intent data, facilitates initial qualification, and triggers a notification workflow for studio staff.\n\n2. Actors\n*   **Primary Actor:** Website Visitor (prospective student).\n*   **Secondary Actor:** Studio Staff Member (recipient of form submission notifications).\n\n3. Trigger\nThe visitor scrolls to or clicks on a \"Contact\" or \"Jetzt Anfragen\" (Inquire Now) call-to-action button/link, which expands or navigates to the contact form section.\n\n4. Preconditions\n*   The landing page containing the component has fully loaded.\n*   The visitor's browser supports HTML5 form validation and JavaScript.\n*   A backend API endpoint (`/api/contact-submit`) is available and accessible to receive form data.\n*   An email service (e.g., SendGrid, SMTP) is configured for the studio's contact address.\n\n5. Main Flow\n1.  The visitor views the contact form with the following mandatory fields: Full Name (text), Email Address (email type), Phone Number (tel type), and Message (textarea).\n2.  The visitor enters their data into the form fields.\n3.  The visitor selects the primary reason for contact from a dropdown menu with options: \"Allgemeine Anfrage\" (General Inquiry), \"Kursbuchung\" (Class Booking), \"Preise & Mitgliedschaft\" (Pricing & Membership), \"Sonstiges\" (Other).\n4.  The visitor clicks the \"Absenden\" (Submit) button.\n5.  The client-side JavaScript performs synchronous validation: checks that all fields are non-empty, validates email format, and validates phone number format (e.g., German format validation: optional +49, then 10-13 digits).\n6.  If validation passes, the JavaScript prevents the default form submission, creates a JSON payload from the form data, and sends a `POST` request to the `/api/contact-submit` endpoint.\n7.  The server receives the request, validates the data schema and sanitizes inputs to prevent injection attacks.\n8.  The server creates a new record in the `contact_submissions` database table with fields: `id` (UUID), `name`, `email`, `phone`, `inquiry_type`, `message`, `submitted_at` (timestamp), `status` (default: 'new').\n9.  The server queues an email notification to the studio's designated contact address (e.g., `info@yogastudio-xyz.de`). The email subject includes the inquiry type and the visitor's name. The email body contains all submitted data and a timestamp.\n10. The server returns a `200 OK` response with a JSON object `{ \"success\": true, \"message\": \"Vielen Dank! Wir werden uns zeitnah bei Ihnen melden.\" }`.\n11. The client-side JavaScript receives the successful response, displays the success message in a designated UI feedback area, and disables the submit button to prevent duplicate submissions.\n12. The form fields are cleared or the form is reset.\n\n6. Alternate Flows\n*   **A1: Client-Side Validation Failure:** At step 5, if a field is empty or data format is invalid, the JavaScript highlights the erroneous field(s) with a red border and displays a specific, inline error message (e.g., \"Bitte geben Sie eine gültige E-Mail-Adresse ein.\"). The form is not submitted. The visitor corrects the data and retries step 4.\n*   **A2: Server-Side Validation/Processing Failure:** At step 7 or 8, if the server encounters an error (e.g., database connection failure, invalid data schema), it returns a `5xx` or `400` error response. The client-side JavaScript receives the non-200 response, displays a generic error message in the feedback area (\"Ein technischer Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.\"), and re-enables the submit button. The visitor can retry submission.\n*   **A3: Network Failure:** The `POST` request at step 6 fails to complete (e.g., user loses connection). The client-side JavaScript's fetch/catch block detects the failure, displays the same generic error message as in A2, and re-enables the submit button.\n*   **A4: User Navigation During Submission:** After clicking submit but before the server responds, the visitor navigates away from the page. The browser aborts the pending request. No data is saved, and no notification is sent. The visitor must resubmit.\n\n7. Postconditions\n*   A new, persistent contact submission record exists in the system database with a 'new' status.\n*   An email notification containing the submission details has been queued for delivery to the studio's inbox.\n*   The website visitor has received clear visual feedback (success or error message) regarding their submission attempt.\n*   The form UI is in a reset state (success) or retains entered data with error highlights (failure).\n\n8. Data Impact\n*   **Database:** A new row is inserted into the `contact_submissions` table. No existing user data is modified.\n*   **Session:** No session data is created or modified for anonymous visitors.\n*   **External Systems:** An email is generated and sent to the studio's external email service provider.\n\n9. UI Impact\n*   The form component must be responsive and function on mobile and desktop.\n*   It must include:\n    *   Text input fields with associated `<label>` tags.\n    *   A dropdown (`<select>`) for inquiry type.\n    *   A textarea for the message.\n    *   A primary action button (\"Absenden\").\n    *   A dedicated, prominent area (e.g., `<div>` with ARIA live region) for displaying success or error feedback messages.\n    *   Visual validation states (e.g., red borders, helper text) for invalid fields.\n    *   Loading state on the submit button (e.g., spinner or \"Wird gesendet...\") during the API request.\n    *   Disabled state on the submit button after successful submission.\n\n10. Acceptance Criteria\n*   **AC1:** The form renders correctly with all specified fields (Name, Email, Phone, Inquiry Type dropdown, Message) and the submit button.\n*   **AC2:** Attempting to submit an empty form triggers client-side validation errors on all required fields.\n*   **AC3:** Submitting an invalid email address (e.g., \"test@\") triggers a specific client-side validation error on the email field.\n*   **AC4:** Submitting a valid form results in a `200` response from the backend, a success message is displayed to the user, and the form is cleared/disabled.\n*   **AC5:** A new record with correct data is created in the `contact_submissions` database table upon a valid submission.\n*   **AC6:** A notification email is successfully queued for delivery to the studio's contact address within 5 seconds of a valid form submission.\n*   **AC7:** If the backend returns any non-200 response, a generic error message is displayed to the user, and the submit button is re-enabled.\n*   **AC8:** The form is fully navigable and operable via keyboard (Tab key) and is compatible with screen readers (proper labels, ARIA attributes for dynamic feedback).\n\n### F-11: Form Validation Logic\n\n1. Purpose\nTo ensure only complete and syntactically valid data is submitted via the contact form, preventing server-side processing of incomplete inquiries and improving data quality for the yoga studio.\n\n2. Actors\nEnd-user (website visitor filling the contact form).\n\n3. Trigger\nUser attempts to submit the contact form by clicking the \"Submit\" button or pressing Enter within a form field.\n\n4. Preconditions\nThe contact form is fully rendered in the user's browser with the following required fields identified: `name` (text), `email` (email), `message` (textarea). The form's submit event is bound to a validation function.\n\n5. Main Flow\n1.  User initiates form submission.\n2.  Validation function intercepts the form's native submit event, preventing default submission behavior.\n3.  Function clears all previous inline error messages and visual error indicators (e.g., red borders) from all form fields.\n4.  Function initializes a boolean flag `isValid` to `true`.\n5.  For each field in the `requiredFields` list (`name`, `email`, `message`):\n    a. Function checks if the field's trimmed value is an empty string.\n    b. If empty:\n        i. Function sets `isValid` to `false`.\n        ii. Function adds a specific error message element (e.g., `<span class=\"error-message\">This field is required</span>`) immediately after the field.\n        iii. Function adds a CSS class (e.g., `input-error`) to the field's container to apply visual styling (e.g., red border).\n6.  For the `email` field specifically:\n    a. If the field is non-empty, function tests the value against a standard email regular expression pattern (e.g., `/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/`).\n    b. If the pattern does not match:\n        i. Function sets `isValid` to `false`.\n        ii. Function adds the error message \"Please enter a valid email address\" after the email field.\n        iii. Function applies the `input-error` class to the email field's container.\n7.  After all validations, function checks the final state of `isValid`.\n8.  If `isValid` remains `true`, the function programmatically triggers the form's native submission (e.g., `form.submit()` or allows the event to proceed).\n9.  If `isValid` is `false`, the function focuses the first invalid field and terminates without submitting the form.\n\n6. Alternate Flows\n*   **A1: User corrects an error and resubmits.** After an initial failed validation with visible errors, the user amends the data in one or more fields and clicks submit again. The validation function re-executes from Step 3, clearing old errors and re-validating all fields based on the new input.\n*   **A2: Email field contains only whitespace.** The trimmed value check in Step 5a correctly identifies a whitespace-only string as empty, triggering the \"required\" error message, not the \"invalid format\" message.\n*   **A3: Form contains optional fields.** The validation logic explicitly ignores any fields not listed in the `requiredFields` array, so their content (or lack thereof) does not affect the `isValid` flag.\n\n7. Postconditions\n*   **Successful Submission:** The form data is transmitted to the server endpoint specified in the form's `action` attribute. No client-side error indicators are present.\n*   **Failed Submission:** The form remains on the page. One or more fields have a visual error indicator (CSS class applied). Corresponding textual error messages are visible in the DOM adjacent to the invalid fields. The `isValid` flag is `false`. Focus is set on the first invalid field.\n\n8. Data Impact\nNo persistent data is stored or modified on the client. Temporary validation state (`isValid` flag, error message elements) exists only in the current page session. Valid form data is prepared for transmission upon successful validation.\n\n9. UI Impact\n*   Dynamic insertion and removal of `<span class=\"error-message\">` elements into the DOM after specific form fields.\n*   Application and removal of a CSS class (e.g., `input-error`) on field container elements to change their border color to red.\n*   Programmatic focus management to the first invalid field upon validation failure.\n*   The submit button's default behavior is conditionally allowed or blocked by the JavaScript event handler.\n\n10. Acceptance Criteria\n1.  **AC1:** Attempting to submit the form with the `name` field empty displays a \"This field is required\" error message next to the name field and prevents submission.\n2.  **AC2:** Attempting to submit the form with the `email` field empty displays a \"This field is required\" error message next to the email field and prevents submission.\n3.  **AC3:** Attempting to submit the form with an `email` value of \"invalid-email\" displays a \"Please enter a valid email address\" error message and prevents submission.\n4.  **AC4:** Attempting to submit the form with a `message` field empty displays a \"This field is required\" error message next to the message field and prevents submission.\n5.  **AC5:** Submitting the form with all required fields filled and a syntactically valid email (e.g., \"test@example.com\") does not display any error messages and allows the form to submit.\n6.  **AC6:** Correcting a previously invalid field and resubmitting clears the old error message for that field and re-validates the entire form.\n7.  **AC7:** Validation logic executes on every submit attempt, clearing all previous errors before performing new checks.\n\n### F-12: Form Submission Handling (Email Notification)\n\n1. Purpose  \n   Enable the landing page to transmit the data entered in the contact form to the studio’s designated email address, providing immediate notification of visitor inquiries and persisting the inquiry data for audit purposes.\n\n2. Actors  \n   - **Visitor** – person who fills out and submits the contact form.  \n   - **Web Browser (Client)** – executes the front‑end JavaScript and sends the HTTP request.  \n   - **Web Server / API Endpoint** – receives the request, validates data, stores the record, and triggers email dispatch.  \n   - **Email Service Provider (ESP)** – external SMTP server or transactional‑email API (e.g., SendGrid, Mailgun) that actually delivers the email.  \n   - **Database** – persistent store for submitted inquiries.\n\n3. Trigger  \n   Visitor clicks the “Senden” button on the contact form after all required fields are filled.\n\n4. Preconditions  \n   1. The contact form is rendered with the fields: Name (text, required), E‑Mail (email, required, valid format), Telefon (text, optional), Nachricht (textarea, required, max 500 characters).  \n   2. Client‑side validation has passed (required fields present, email format correct, message length ≤ 500).  \n   3. reCAPTCHA v2 (or equivalent) token has been obtained and attached to the form data.  \n   4. The API endpoint `/api/contact` is reachable (HTTP 200 on health‑check).  \n   5. The ESP credentials (API key or SMTP credentials) are stored securely in the server environment.\n\n5. Main Flow  \n   1. **Submit Request** – The browser sends an HTTPS POST to `/api/contact` with a JSON payload containing the form fields and the reCAPTCHA token.  \n   2. **Rate‑limit Check** – The server middleware checks the visitor’s IP against a sliding‑window limit of 5 submissions per hour; if exceeded, respond with HTTP 429.  \n   3. **reCAPTCHA Verification** – Server calls Google reCAPTCHA verification endpoint; if verification fails, respond with HTTP 400 and error “captcha_invalid”.  \n   4. **Server‑side Validation** – Server validates each field (non‑empty, email regex, message length). On failure, respond with HTTP 422 and a field‑error map.  \n   5. **Persist Inquiry** – Insert a new record into table `contact_inquiries` with columns: `id` (UUID), `name`, `email`, `phone`, `message`, `submitted_at` (UTC timestamp), `ip_address`, `captcha_status`.  \n   6. **Compose Email** – Build an email object:  \n      - **From:** `no-reply@<studio-domain>`  \n      - **To:** `studio@example.com` (configurable)  \n      - **Subject:** “Neue Kontaktanfrage von <Name>”  \n      - **Body (HTML & plain‑text):** includes all submitted fields and the submission timestamp.  \n   7. **Send Email** – Invoke the ESP SDK or SMTP client with the composed email.  \n   8. **Email Success Check** – If ESP returns success status (e.g., 202 Accepted), continue; otherwise log error and proceed to step 10.  \n   9. **Respond to Client** – Return HTTP 200 with JSON `{ \"status\": \"success\", \"message\": \"Ihre Anfrage wurde gesendet.\" }`.  \n   10. **Failure Handling** – If email dispatch fails, update the `contact_inquiries` record with `email_sent = false` and `email_error = <error_message>`. Respond to client with HTTP 500 and JSON `{ \"status\": \"error\", \"message\": \"Technischer Fehler – bitte später erneut versuchen.\" }`.\n\n6. Alternate Flows  \n   - **A1 – Validation Error (Step 4)**  \n     1. Server detects missing or malformed fields.  \n     2. Respond with HTTP 422 and a JSON payload listing each invalid field and an error message.  \n     3. Client displays the errors inline next to the corresponding inputs.  \n\n   - **A2 – reCAPTCHA Failure (Step 3)**  \n     1. Verification endpoint returns `success: false`.  \n     2. Respond with HTTP 400 and error code `captcha_invalid`.  \n     3. Client shows a generic “Bitte bestätigen Sie, dass Sie kein Bot sind.” message and forces a new captcha challenge.  \n\n   - **A3 – Email Service Unavailable (Step 8)**  \n     1. ESP returns a non‑2xx status or times out.  \n     2. Server logs the failure, marks the inquiry as `email_sent = false`.  \n     3. Server retries email dispatch up to 2 additional times with exponential back‑off (2 s, 4 s).  \n     4. If all retries fail, proceed to step 10 of the Main Flow.  \n\n   - **A4 – Database Write Failure (Step 5)**  \n     1. INSERT operation throws an exception (e.g., deadlock, constraint violation).  \n     2. Server rolls back the transaction, logs the error, and returns HTTP 500 with message “Datenbankfehler – bitte später erneut versuchen.”  \n     3. No email is sent.\n\n7. Postconditions  \n   - A new row exists in `contact_inquiries` with `email_sent = true` (or false if email failed) and accurate timestamps.  \n   - If email dispatch succeeded, the studio’s inbox receives a correctly formatted message containing all submitted data.  \n   - The client receives a JSON response indicating success or the specific error that occurred.  \n   - All events (submission, validation outcome, email status) are logged to the application log with correlation ID.\n\n8. Data Impact  \n   - **Database:** Table `contact_inquiries` grows by one row per successful POST. Columns: `id` (UUID, primary key), `name` (VARCHAR 255), `email` (VARCHAR 255), `phone` (VARCHAR 50, nullable), `message` (TEXT), `submitted_at` (TIMESTAMP UTC), `ip_address` (INET), `captcha_status` (ENUM ['valid','invalid']), `email_sent` (BOOLEAN), `email_error` (TEXT, nullable).  \n   - **Logs:** Each submission creates an INFO log entry with correlation ID; failures create WARN/ERROR entries.  \n   - **Email Service:** One outbound email transaction per successful submission; failure attempts are recorded in ESP’s activity logs.\n\n9. UI Impact  \n   - **Success State:** After receiving HTTP 200, the front‑end replaces the form with a green success banner: “Ihre Anfrage wurde gesendet.”  \n   - **Validation Errors:** Inline error messages appear beneath each offending field; the form remains populated with previously entered values.  \n   - **Captcha Error:** A red banner appears above the form: “Bitte bestätigen Sie, dass Sie kein Bot sind.” and the captcha widget is reset.  \n   - **Server Error:** A red banner appears: “Technischer Fehler – bitte später erneut versuchen.” The form data is preserved for resubmission.  \n   - **Rate‑limit Exceeded:** Red banner: “Zu viele Anfragen – bitte versuchen Sie es in einer Stunde erneut.”  \n\n10. Acceptance Criteria  \n   1. Submitting a fully valid form results in an email delivered to `studio@example.com` within 5 seconds of the HTTP 200 response.  \n   2. The email contains all fields exactly as entered, with proper HTML escaping to prevent injection.  \n   3. Invalid client‑side data (e.g., missing name) prevents the POST request; server‑side validation also blocks malformed data and returns HTTP 422 with correct field error mapping.  \n   4. reCAPTCHA failures return HTTP 400 with error code `captcha_invalid` and display the appropriate UI message.  \n   5. When the ESP is unreachable, the system retries twice, logs each attempt, and finally returns HTTP 500 with the generic error message while persisting the inquiry with `email_sent = false`.  \n   6. Rate limiting blocks the 6th submission from the same IP within one hour, returning HTTP 429 and the UI shows the rate‑limit banner.  \n   7. All persisted records include a non‑null UUID, accurate UTC timestamp, and the visitor’s IP address.  \n   8. No sensitive data (e.g., ESP API key) is exposed to the client; it is stored only in server environment variables.  \n   9. Unit tests cover: successful flow, each alternate flow (validation error, captcha error, email failure, DB failure, rate limit).  \n   10. Load test with 100 concurrent submissions shows no loss of data and email delivery success rate ≥ 99 %.\n\n### F-13: CAPTCHA Integration for Contact Form\n\n1. Purpose\nTo integrate a challenge-response test (CAPTCHA) into the contact form to distinguish human users from automated bots, thereby preventing spam submissions, protecting form data integrity, and reducing manual processing overhead.\n\n2. Actors\n- Visitor (End User)\n- System (Backend Server & Frontend Interface)\n\n3. Trigger\nThe Visitor clicks the \"Submit\" button on the contact form.\n\n4. Preconditions\n- The contact form is fully rendered on the webpage.\n- A CAPTCHA service provider (e.g., Google reCAPTCHA v2/v3, hCaptcha) has been selected and the corresponding site key and secret key are configured in the system's environment variables or configuration management.\n- The frontend codebase includes the necessary CAPTCHA provider's JavaScript library.\n- The backend server has an outbound internet connection to verify the CAPTCHA response token with the provider's API.\n\n5. Main Flow\n1.  Visitor fills out all required fields in the contact form (Name, Email, Message).\n2.  The CAPTCHA widget (e.g., \"I'm not a robot\" checkbox, invisible score-based challenge) is rendered within the form as the last focusable element.\n3.  Visitor interacts with the CAPTCHA widget. For an interactive challenge, they complete the task (e.g., select images). For an invisible challenge, the provider's script analyzes user behavior and assigns a risk score.\n4.  Upon successful CAPTCHA completion/validation by the provider, a unique response token (`g-recaptcha-response` or equivalent) is generated and attached to the form data.\n5.  Visitor clicks the \"Submit\" button. The frontend JavaScript prevents the default form submission if the CAPTCHA token is absent or invalid.\n6.  The form data, including the CAPTCHA response token, is sent via an HTTPS POST request to the backend endpoint (e.g., `/api/contact-submit`).\n7.  The backend server receives the request and extracts the CAPTCHA response token and the user's IP address.\n8.  The backend constructs a verification request to the CAPTCHA provider's secret verification endpoint (e.g., `https://www.google.com/recaptcha/api/siteverify`), including the secret key, the response token, and the remote IP.\n9.  The backend sends the verification request to the provider's API and awaits the JSON response.\n10. The backend parses the provider's response. If the `success` field is `true` (and for score-based systems, if the `score` meets a predefined threshold, e.g., >0.5), the submission is considered human.\n11. The backend proceeds to validate the other form fields (email format, message length).\n12. If all validations pass, the backend processes the submission (e.g., sends an email to the studio, stores in database) and returns a `200 OK` response with a success message.\n13. The frontend receives the success response and displays a confirmation message to the Visitor (e.g., \"Message sent successfully!\").\n\n6. Alternate Flows\nA. CAPTCHA Verification Fails (Bot Detected):\n   1. At step 9, the provider's response has `success: false` or the score is below the threshold.\n   2. The backend immediately halts processing.\n   3. The backend returns a `403 Forbidden` or `400 Bad Request` response with a specific error code (e.g., `CAPTCHA_FAILED`).\n   4. The frontend receives the error response and displays a clear, user-friendly error message adjacent to the CAPTCHA widget (e.g., \"CAPTCHA verification failed. Please try again.\"). The form data for other fields is preserved.\n   5. The Visitor must re-attempt the CAPTCHA and resubmit.\n\nB. CAPTCHA Service Unavailable:\n   1. At step 8 or 9, the backend's request to the CAPTCHA provider's API fails (network timeout, DNS error, 5xx response).\n   2. The backend logs the critical error.\n   3. The backend is configured with a fail-safe policy (e.g., `CAPTCHA_ON_FAIL=REJECT`). It rejects the submission and returns a `503 Service Unavailable` response with a generic error message (\"Service temporarily unavailable. Please try later.\").\n   4. *Alternative Policy:* If configured with `CAPTCHA_ON_FAIL=ACCEPT` (not recommended for high-risk forms), the backend would proceed with submission after logging a warning, but this flow is not the primary spec.\n\nC. Visitor Uses Accessibility Tool (e.g., Screen Reader):\n   1. The CAPTCHA widget implementation must be fully accessible (WCAG 2.1 AA compliant).\n   2. For an audio challenge, the Visitor activates the audio option via the widget's accessible controls.\n   3. The Visitor listens to the audio challenge and enters the correct numbers/words.\n   4. The flow proceeds to Main Flow step 4. If the audio challenge fails, Alternate Flow A is triggered.\n\n7. Postconditions\n- **Success:** The contact form submission data is processed (e.g., emailed, stored), and the Visitor sees a success confirmation. The CAPTCHA token is consumed and cannot be reused.\n- **Failure (Bot/Invalid):** The submission is rejected and discarded. No data is stored or emailed. The Visitor sees an error message and must correct the CAPTCHA. The form data for other fields may be preserved in the frontend state.\n- **Failure (Service):** The submission is rejected. The system logs the service outage. The Visitor sees a generic service unavailability message.\n\n8. Data Impact\n- **New Data Stored:** None from the CAPTCHA itself (tokens are single-use and ephemeral). Only the standard contact form data (name, email, message, timestamp, IP) is stored upon successful submission.\n- **Logging:** Backend must log CAPTCHA verification attempts, including: timestamp, IP address, form endpoint, provider's `success`/`score`/`error-codes`, and final submission outcome (accepted/rejected). This is critical for monitoring spam attacks and tuning thresholds.\n- **Configuration:** New environment/configuration variables are required: `CAPTCHA_PROVIDER` (e.g., `recaptcha_v2`, `hcaptcha`), `CAPTCHA_SITE_KEY`, `CAPTCHA_SECRET_KEY`, `CAPTCHA_SCORE_THRESHOLD` (if applicable), `CAPTCHA_ON_FAIL` policy.\n\n9. UI Impact\n- The contact form HTML must be modified to include a container element for the CAPTCHA widget (e.g., `<div class=\"g-recaptcha\" data-sitekey=\"...\"></div>`).\n- The widget must be placed logically within the form, typically after the last input field and before the submit button.\n- The form's submit button must have its default event handler augmented to check for the presence of a valid CAPTCHA token before allowing submission (for invisible/score-based CAPTCHAs, this check is handled by the provider's callback).\n- Clear, accessible error messages for CAPTCHA failure must be displayed in a dedicated `div` associated with the widget (using `aria-live=\"polite\"`).\n- The overall form layout must accommodate the widget's size without breaking responsive design.\n\n10. Acceptance Criteria\n- **AC1 (Spam Block):** Automated bot submissions (simulated via scripted POST requests without a valid CAPTCHA token) are rejected by the backend with a `403`/`400` response and do not result in stored data or sent emails.\n- **AC2 (Human Success):** A human user can successfully complete the CAPTCHA challenge, submit the form, and receive a success confirmation. The studio receives the email/notification with the correct form data.\n- **AC3 (UI Element):** The CAPTCHA widget is visibly present on the contact form page for all users (desktop/mobile). It is keyboard-navigable and operable.\n- **AC4 (Error Handling):** On CAPTCHA failure (e.g., user selects wrong images), the frontend displays a clear, specific error message without clearing other form fields. The user can retry the CAPTCHA.\n- **AC5 (Performance):** The addition of the CAPTCHA does not increase the page's Time-to-Interactive (TTI) by more than 500ms on a standard 3G connection (measured via Lighthouse). The backend verification adds less than 200ms average latency to the form submission API response time.\n- **AC6 (Logging):** All CAPTCHA verification attempts (success/failure, score, error codes) are logged with sufficient detail for audit and debugging.\n- **AC7 (Accessibility):** The CAPTCHA implementation passes an automated accessibility scan (e.g., axe-core) for the contact form page with 0 violations related to the widget. Audio challenge is functional.\n\n### F-14: Footer with Address, Hours, and Copyright\n\n1. Purpose\nTo display the yoga studio's static contact information, operational hours, and mandatory legal copyright notice at the bottom of every page, ensuring compliance and providing essential details to visitors.\n\n2. Actors\nPrimary: Website Visitor (views the footer).\nSecondary: Studio Administrator (provides source data; no direct interface).\n\n3. Trigger\nThe browser completes rendering the main page content and reaches the footer section in the HTML document structure.\n\n4. Preconditions\n- The HTML document contains a dedicated `<footer>` element with a specific ID or class (e.g., `#site-footer`).\n- Source data for the studio address, opening hours, and studio name is available in a defined configuration (e.g., a JSON file, environment variables, or hardcoded in the template).\n- The viewport meta tag is set for responsive design.\n\n5. Main Flow\n1.  The browser parses the HTML and encounters the `<footer>` element.\n2.  The footer container `<div>` is rendered with a CSS class `footer-container`.\n3.  The address block is rendered as a `<div>` with class `footer-address`. It contains:\n    a.  Studio name as an `<h3>` or `<strong>` element.\n    b.  Street address, postal code, and city as separate `<p>` or `<span>` elements.\n    c.  Phone number as a `tel:` link.\n4.  The opening hours block is rendered as a `<div>` with class `footer-hours`. It contains:\n    a.  A heading \"Öffnungszeiten\" (or equivalent).\n    b.  An unordered list `<ul>` where each `<li>` contains a day (e.g., \"Mo-Fr\") and corresponding time (e.g., \"08:00 - 20:00\").\n5.  The copyright block is rendered as a `<div>` with class `footer-copyright`. It contains a `<p>` element with the text: `© [CurrentYear] [StudioName]. Alle Rechte vorbehalten.`\n6.  CSS styles are applied to arrange the three blocks (address, hours, copyright) in a responsive flexbox or grid row on desktop (min-width: 768px) and a stacked column on mobile.\n7.  The footer is visually separated from the main content by a top border and has a dark background (e.g., `#2d3748`) with light text (e.g., `#e2e8f0`).\n\n6. Alternate Flows\nA1. **Missing Address Data:** If the source address string is empty, the `footer-address` block is not rendered, and the remaining blocks reflow to fill the space.\nA2. **Mobile Layout:** On viewport width < 768px, the flex direction changes to `column`, items are centered (`align-items: center`), and padding is reduced to `1rem`.\nA3. **Dynamic Year:** If the implementation uses a static year in the data, the copyright displays that year. If a dynamic year is implemented (e.g., via JavaScript `new Date().getFullYear()`), the script executes after DOM load to replace a placeholder token.\n\n7. Postconditions\n- The footer is visibly rendered at the bottom of the viewport or page content.\n- All provided data (address, hours, studio name) is accurately displayed in the specified format.\n- The page's overall layout is not broken; the footer does not overlap main content.\n- The copyright notice is present and legible.\n\n8. Data Impact\n- **Read:** The feature reads static configuration data (`studioAddress`, `studioHours`, `studioName`, `copyrightYear`).\n- **Write:** No data is written to any database or file. The data source is read-only for this feature.\n- **Storage:** Source data resides in a configuration file (e.g., `config/footer.json`) or within the frontend template file (e.g., `footer.html` or a component).\n\n9. UI Impact\n- **Structure:** A new `<footer>` section is added to the base HTML layout template.\n- **Styling:** New CSS classes (`.footer-container`, `.footer-address`, `.footer-hours`, `.footer-copyright`) are defined in the main stylesheet. Styles include flexbox layout, responsive breakpoints, typography, color, and spacing.\n- **Responsiveness:** The footer layout changes from a 3-column row on desktop to a single-column stack on mobile devices.\n- **Accessibility:** Text contrast ratios meet WCAG AA standards. The phone number link uses the `tel:` protocol correctly.\n\n10. Acceptance Criteria\n- **AC1:** On a desktop viewport (≥768px), the address, opening hours, and copyright are displayed side-by-side in a single row with sufficient spacing.\n- **AC2:** On a mobile viewport (<768px), the three blocks are displayed in a single vertical column, centered, with appropriate vertical spacing.\n- **AC3:** The address block correctly displays the full street, city, and phone number as defined in the source data.\n- **AC4:** The opening hours list displays each day-time pair on a separate line, using the exact format from the source data.\n- **AC5:** The copyright text includes the correct studio name and either the specified static year or the current calendar year.\n- **AC6:** The footer has a distinct background color from the main page content and a top border separator.\n- **AC7:** No console errors or warnings are thrown during page load related to the footer component.\n- **AC8:** The footer remains at the bottom of the page (either sticky or static after content) without overlapping other elements.\n\n### F-15: Social Media Icon Links\n\n1. Purpose\nTo provide website visitors with direct, one-click access to the yoga studio's official social media profiles (Facebook, Instagram, YouTube) to increase follower counts, engagement, and brand awareness beyond the website.\n\n2. Actors\n- Primary: Website Visitor (any user accessing the landing page).\n- Secondary: Studio Administrator (responsible for providing and updating the target URLs).\n\n3. Trigger\nThe rendering of the landing page's footer or a dedicated \"Connect\" section is initiated by the user's browser requesting and parsing the HTML/CSS/JS of the page.\n\n4. Preconditions\n- The studio administrator has provided valid, absolute URLs for the Facebook, Instagram, and YouTube profiles in the system's configuration or CMS.\n- The frontend assets (SVG icon files or a licensed icon font like FontAwesome) for the specified social platforms are available and deployed with the website.\n- The user's browser has JavaScript enabled (if analytics tracking is implemented via JS) and supports the rendering of the icon format used (SVG/icon font).\n\n5. Main Flow\n1.  The user's browser loads the landing page HTML.\n2.  The browser parses the HTML and encounters the `<nav>` or `<div>` container designated for social links (e.g., with class `social-links`).\n3.  For each configured platform (Facebook, Instagram, YouTube):\n    a.  The system retrieves the stored absolute URL (e.g., `https://www.facebook.com/StudioName`) from the configuration.\n    b.  The system generates an anchor (`<a>`) element with:\n        - `href` attribute set to the retrieved URL.\n        - `target=\"_blank\"` and `rel=\"noopener noreferrer\"` attributes for security and UX.\n        - A unique, accessible `aria-label` (e.g., `aria-label=\"Follow us on Facebook\"`).\n    c.  Within the anchor, the system inserts the corresponding platform's icon (via `<svg>` or `<i>` tag).\n4.  The browser renders the clickable icon elements in the specified location (e.g., footer).\n5.  The user clicks on a specific platform icon.\n6.  The browser opens the `href` URL in a new tab/window, navigating to the studio's social media profile page.\n\n6. Alternate Flows\n- **A1: Missing or Invalid URL Configuration.** If a platform's URL is empty or malformed in the configuration:\n    - The system does not render the anchor element or icon for that specific platform.\n    - No clickable element is presented for the missing platform.\n- **A2: Icon Asset Fails to Load.** If the icon file (SVG/font) is corrupted or missing:\n    - The browser may display a broken image icon or an empty space.\n    - The anchor element with the correct `href` and `aria-label` is still rendered and clickable, but lacks visual branding.\n- **A3: User Disables Pop-ups/New Tabs.** If the user's browser is configured to block new tabs/windows:\n    - The social media profile may open in the current tab, replacing the studio's landing page, or the action may be blocked entirely based on browser settings.\n\n7. Postconditions\n- For the User: The user's current browser session now has an additional tab/window open pointing to the selected social media platform, or the current tab has navigated away from the studio's site.\n- For the System: An optional analytics event (e.g., `social_click`) with parameters `{platform: 'facebook'}` may have been logged to the analytics service if implemented.\n\n8. Data Impact\n- **Read:** The feature reads three data points from persistent storage/configuration: `social_url_facebook`, `social_url_instagram`, `social_url_youtube`.\n- **Write (Optional):** If click analytics are implemented, each icon click writes an event log to the analytics database/service, incrementing a counter for the specific platform.\n- **No** user-generated data is stored or processed by this feature itself.\n\n9. UI Impact\n- **Placement:** A container (e.g., `<div class=\"social-icons\">`) must be present in the landing page's HTML structure, typically in the global footer or a specific \"Connect\" section.\n- **Styling:** CSS rules must define the size, color, spacing, and hover effects (e.g., color change, slight scale) for the icons to match the site's design system.\n- **Accessibility:** Each icon link must have a clear `aria-label`. The container may have a heading like \"Follow Us\" with `aria-hidden=\"true\"` if decorative.\n- **Responsiveness:** Icons must remain properly sized and spaced on all viewport sizes (mobile, tablet, desktop).\n\n10. Acceptance Criteria\n- **AC1:** The landing page footer displays three distinct, recognizable icons for Facebook, Instagram, and YouTube.\n- **AC2:** Each icon is a functional hyperlink. Clicking the Facebook icon opens the exact URL configured for `social_url_facebook` in a new browser tab.\n- **AC3:** The `target=\"_blank\"` and `rel=\"noopener noreferrer\"` attributes are present on all generated anchor tags (verified via browser DevTools).\n- **AC4:** Each icon link has a unique, descriptive `aria-label` (e.g., \"Visit our Instagram profile\").\n- **AC5:** If a URL is removed from the configuration, the corresponding icon disappears from the page entirely.\n- **AC6:** Icons adhere to the specified design specifications for size, color, and hover state (verified via visual QA and CSS inspection).\n- **AC7 (Optional):** A click on an icon successfully logs an analytics event with the correct `platform` parameter to the designated analytics endpoint.\n\n### F-16: Google Maps Embed\n\n1. Purpose\nTo embed an interactive Google Map on the studio's website, precisely pinpointing the physical location of the yoga studio. This allows website visitors to visually identify the studio's address, get directions, and explore the surrounding area, thereby facilitating physical visits and supporting the goal of increasing studio foot traffic.\n\n2. Actors\n*   Primary: Website Visitor (any user accessing the landing page).\n*   Secondary: Studio Administrator (for initial configuration and potential address updates).\n\n3. Trigger\nThe map is rendered automatically when a visitor navigates to the webpage section containing the location information (typically within the \"Kontakt\" or a dedicated \"Anfahrt\" section).\n\n4. Preconditions\n*   The studio has a verified, precise physical address (street, postal code, city).\n*   A valid Google Maps Platform API key with the \"Maps JavaScript API\" and \"Places API\" (optional for address autocomplete in admin) enabled is generated and stored securely in the website's configuration environment.\n*   The website's domain is authorized for use with the API key in the Google Cloud Console.\n*   The backend/content management system (if any) has a field to store and manage the studio's address string.\n\n5. Main Flow\n1.  The visitor's browser loads the HTML page containing the map container element (e.g., `<div id=\"studio-map\"></div>`).\n2.  The page's JavaScript executes and initializes the Google Maps JavaScript API using the stored API key.\n3.  The script creates a new `google.maps.Map` instance, binding it to the container element.\n4.  The script geocodes the stored studio address string (e.g., \"Yogastudio Namaste, Hauptstraße 10, 12345 Berlin\") into geographic coordinates (latitude/longitude).\n5.  A `google.maps.Marker` is created with the obtained coordinates and placed on the map at the studio's location.\n6.  The map's center is set to the marker's position, and a default zoom level (e.g., 15) is applied.\n7.  The fully interactive map (supporting pan, zoom, street view toggle) is rendered within the designated container for the visitor.\n\n6. Alternate Flows\n*   **A1: Invalid or Missing API Key:** The API script fails to load or returns an error. The system detects the load failure and displays a static, non-interactive image of the map (a pre-generated screenshot of the correct location) within the container, along with a text link to open the location in a new Google Maps tab.\n*   **A2: Geocoding Failure:** The provided address string is ambiguous or invalid and cannot be converted to coordinates. The map initializes at a default fallback location (e.g., the city center) with a warning message visible to the user: \"Konnte die genaue Adresse nicht auf der Karte finden. Bitte nutzen Sie die Adressangabe unten.\" The static address text remains visible.\n*   **A3: Network/API Quota Error:** The Google Maps API request fails due to network issues or exceeded quota. The system implements a retry logic (e.g., one retry after 2 seconds). If the retry also fails, it falls back to the static image solution described in A1.\n\n7. Postconditions\n*   The map container in the DOM is populated with either the interactive map or a defined fallback (static image + message).\n*   The visitor can see a representation of the studio's location.\n*   No personal user data is stored by the map interaction. Standard Google Maps API usage logs (IP, request timestamp) are generated by Google's servers as per their privacy policy.\n\n8. Data Impact\n*   **Read:** The system reads the stored studio address string from the website's configuration/ CMS.\n*   **Write:** None. The feature is read-only.\n*   **External Calls:** Multiple calls to Google Maps Platform endpoints: Maps JavaScript API library, Geocoding API (to convert address to coordinates). These are client-side from the visitor's browser.\n*   **Caching:** Browser caching of the Google Maps API library script is expected. No application-level caching of coordinates is strictly required, but recommended for performance (cache geocoding result for the address).\n\n9. UI Impact\n*   **New Element:** A `<div>` container with a specific ID/class is added to the contact/location page.\n*   **Dimensions:** The container must have explicit width (100% of parent) and height (e.g., 400px or 60vh) defined in CSS to render correctly.\n*   **Responsive:** The map must resize fluidly within its container on different screen sizes.\n*   **Loading State:** A subtle loading spinner or skeleton placeholder should be visible in the container before the map initializes.\n*   **Fallback Styling:** The static fallback image must be styled to match the container dimensions and have an `alt` attribute describing the map.\n\n10. Acceptance Criteria\n*   **AC1:** On the live site, the map section loads within 3 seconds on a standard connection and displays an interactive map centered on the studio's correct, verified address.\n*   **AC2:** A visible marker (default Google Maps pin) is placed exactly at the studio's geocoded coordinates.\n*   **AC3:** The map is fully interactive; the user can zoom in/out, pan, and switch to satellite/street view.\n*   **AC4:** The map container is responsive and maintains correct aspect ratio/functionality on mobile viewports (<768px width).\n*   **AC5:** If the API key is manually invalidated in the config, the page gracefully shows the static fallback image and a functional external link to Google Maps for the studio address, with no JavaScript errors breaking the page layout.\n*   **AC6:** The geocoded coordinates correspond to the studio's address when manually verified via the Google Maps website.\n\n### F-17: SEO Meta Tags (Title & Description)\n\n1. Purpose\nTo improve search engine visibility and click-through rates by programmatically inserting optimized, page-specific `<title>` and `<meta name=\"description\">` tags into the HTML `<head>` of each landing page.\n\n2. Actors\n- Primary: Search Engine Crawlers (e.g., Googlebot)\n- Secondary: Content Administrator (via CMS)\n\n3. Trigger\nAn HTTP GET request for any page of the landing page (e.g., `/`, `/leistungen`, `/kursplan`, `/kontakt`).\n\n4. Preconditions\n- The requested page route is defined and resolvable.\n- Page-level SEO metadata (title, description) is either:\n  a) Pre-configured and stored in the site's data source (e.g., CMS, JSON config), OR\n  b) A site-wide default metadata set is defined as a fallback.\n\n5. Main Flow\n1.  The web server receives an HTTP GET request for a specific page route (e.g., `/kursplan`).\n2.  The server-side rendering logic (or static site generator build step) resolves the requested route to its corresponding page component/template.\n3.  The rendering logic queries the data source for the page-specific SEO metadata object using the route identifier.\n4.  If a page-specific metadata object is found, its `title` and `description` values are retrieved. If not found, the system retrieves the site-wide default `title` and `description` values.\n5.  The retrieved `title` string is sanitized to ensure it does not exceed 60 characters and is encoded for HTML.\n6.  The retrieved `description` string is sanitized to ensure it does not exceed 160 characters and is encoded for HTML.\n7.  The rendering engine injects the sanitized `title` into a `<title>` tag and the sanitized `description` into a `<meta name=\"description\" content=\"...\">` tag.\n8.  These tags are placed within the `<head>` section of the final HTML document.\n9.  The complete HTML response, including the injected meta tags, is sent to the client.\n\n6. Alternate Flows\n- **A1: Missing Page-Specific and Default Metadata:** If neither page-specific nor site-wide default metadata exists, the system generates a `title` from the page's primary heading (e.g., `<h1>` text) truncated to 60 chars. The `description` is set to an empty string, and no `<meta name=\"description\">` tag is rendered.\n- **A2: Dynamic Title Component:** For pages with dynamic content (e.g., a specific instructor's bio page), the `title` template may include a variable (e.g., `\"{InstructorName} - YogaStudio Name\"`). The system substitutes the variable with runtime data before sanitization and injection.\n\n7. Postconditions\n- The HTTP response body contains a complete HTML document.\n- The `<head>` section includes exactly one `<title>` tag with a non-empty, sanitized string.\n- The `<head>` section includes zero or one `<meta name=\"description\">` tag. If present, its `content` attribute contains a non-empty, sanitized string of 1-160 characters.\n- The rendered `title` and `description` accurately reflect the configured data for the requested page or the appropriate fallback.\n\n8. Data Impact\n- A new data structure `seoMetadata` is required for each page entity in the data source (e.g., CMS page model, frontmatter in Markdown files, entry in a `pages.json` config). Structure: `{ \"title\": \"string (max 60)\", \"description\": \"string (max 160)\" }`.\n- A site-wide default `seoMetadata` object must be stored in the central configuration.\n- No new database tables are required if using an existing CMS; otherwise, a simple key-value store for page routes is sufficient.\n\n9. UI Impact\n- The Content Administration Interface (CMS) must include input fields for \"SEO Title\" and \"Meta Description\" on the page edit/create form for all manageable pages.\n- These fields should display character counters (e.g., \"45/60\") and provide validation feedback upon save if limits are exceeded.\n- The interface should pre-fill these fields with the current values when editing a page.\n\n10. Acceptance Criteria\n- **AC1:** For the homepage (`/`), when configured with `title: \"Willkommen bei Studio Yoga\"` and `description: \"Ihr lokales Yogastudio für Hatha und Vinyasa.\"`, the rendered HTML `<head>` contains `<title>Willkommen bei Studio Yoga</title>` and `<meta name=\"description\" content=\"Ihr lokales Yogastudio für Hatha und Vinyasa.\">`.\n- **AC2:** For a page with no configured SEO data, the rendered HTML `<head>` uses the site-wide default metadata (e.g., `<title>Studio Yoga - Deine Auszeit</title>`).\n- **AC3:** A configured `title` of 75 characters is truncated to 60 characters in the rendered output without breaking HTML encoding.\n- **AC4:** The CMS edit form for any page displays the current saved SEO Title and Meta Description values in their respective input fields.\n- **AC5:** Attempting to save a Meta Description longer than 160 characters in the CMS triggers a validation error and prevents save.\n\n### F-18: Open Graph Tags for Social Sharing\n\n1. Purpose\nTo ensure that when the yoga studio's landing page URL is shared on social media platforms (e.g., Facebook, LinkedIn, Twitter) and messaging apps (e.g., WhatsApp, Slack), a rich, branded preview is displayed. This preview includes a title, description, and image, which increases click-through rates, maintains brand consistency, and drives traffic to the studio.\n\n2. Actors\n- Social Media Platform Crawlers (e.g., Facebook's `facebookexternalhit`, Twitter's `Twitterbot`).\n- Website Developers implementing the tags.\n- Studio Management providing the content assets (text, image).\n\n3. Trigger\nA user copies the landing page URL and pastes it into a social media post, comment, or private message, prompting the platform's crawler to fetch and parse the page's metadata.\n\n4. Preconditions\n- The landing page (`index.html`) is fully developed and deployed to a publicly accessible web server.\n- The studio has provided final, approved text for the title and description, and a high-quality, branded image (e.g., studio logo, class photo).\n- The image file is hosted on the same domain or a publicly accessible CDN.\n\n5. Main Flow\n1.  **Define Content:** The developer defines the static Open Graph (OG) tag values based on studio input:\n    *   `og:title`: Studio name + primary value proposition (e.g., \"YogaStudio München | Finde deine innere Balance\").\n    *   `og:description`: Concise studio description or unique selling point (max 2-3 sentences, ~200 characters).\n    *   `og:image`: Absolute URL to the selected, optimized image file (e.g., `https://yogastudio-muenchen.de/assets/og-image.jpg`).\n    *   `og:url`: The canonical absolute URL of the landing page (e.g., `https://yogastudio-muenchen.de/`).\n    *   `og:type`: Set to `website`.\n    *   `og:locale`: Set to `de_DE`.\n2.  **Implement HTML Tags:** The developer inserts the following `<meta>` tags into the `<head>` section of `index.html`:\n    ```html\n    <meta property=\"og:title\" content=\"[defined title]\" />\n    <meta property=\"og:description\" content=\"[defined description]\" />\n    <meta property=\"og:image\" content=\"[defined image URL]\" />\n    <meta property=\"og:url\" content=\"[defined URL]\" />\n    <meta property=\"og:type\" content=\"website\" />\n    <meta property=\"og:locale\" content=\"de_DE\" />\n    ```\n3.  **Optimize Image:** The developer ensures the `og:image` file meets platform specifications: minimum 1200x630 pixels, under 5MB, in JPG or PNG format, with a max aspect ratio of 3:1. The file is compressed for fast loading.\n4.  **Validate Implementation:** The developer uses official debugging tools:\n    *   Facebook Sharing Debugger (`https://developers.facebook.com/tools/debug/`) to scrape the URL, verify tag detection, and preview the link.\n    *   Twitter Card Validator (`https://cards-dev.twitter.com/validator`) to confirm the summary card display.\n    *   LinkedIn Post Inspector (`https://www.linkedin.com/post-inspector/`) for verification.\n5.  **Deploy:** The updated `index.html` and optimized image are committed and deployed to the production web server.\n\n6. Alternate Flows\n- **A1: Missing or Invalid Image:** If the specified `og:image` URL returns a 404 error, is too small, or has an incorrect format, crawlers may fall back to a generic page screenshot or no image. *Solution:* During validation (Step 4), the debugger will flag this. The developer must correct the image URL, size, or format and re-test.\n- **A2: Crawler Access Denied:** If the server's `robots.txt` or firewall blocks the crawler's user-agent, the OG tags will not be read. *Solution:* The developer verifies server logs for blocked requests and configures `robots.txt` to allow common social media crawlers (`User-agent: facebookexternalhit`, `User-agent: Twitterbot`, etc.).\n- **A3: Dynamic Page Requirement:** If the studio later requests that OG tags (e.g., `og:title` or `og:image`) change per course or blog post, the static HTML implementation is insufficient. *Solution:* This requires a backend solution (e.g., server-side rendering, CMS with dynamic meta tags), which is out of scope for this static landing page feature.\n\n7. Postconditions\n- The live `index.html` source code contains all specified, valid Open Graph `<meta>` tags within the `<head>`.\n- The `og:image` file is publicly accessible via its absolute URL and returns a `200 OK` HTTP status.\n- Social media platform debuggers show no errors for the URL and correctly render the provided title, description, and image in their link preview generators.\n- The feature is functional and visible to end-users when they share the URL.\n\n8. Data Impact\n- **New Static Data:** The approved title, description, and image filename are stored as hard-coded strings within the `index.html` file.\n- **New Asset:** An optimized image file (e.g., `og-image.jpg`) is added to the project's `/assets/` or `/images/` directory and deployed with the site.\n- No database schema changes or new API endpoints are created.\n\n9. UI Impact\n- There is **no direct change** to the visual user interface of the landing page itself.\n- The impact is indirect and occurs on **external platforms**: When a user shares the page's URL, the social network's UI (the link preview card) will now display the studio's custom title, description, and image instead of a generic page scrape.\n\n10. Acceptance Criteria\n- **AC1:** The `index.html` `<head>` contains exactly the six required OG meta tags (`og:title`, `og:description`, `og:image`, `og:url`, `og:type`, `og:locale`) with the studio's provided content.\n- **AC2:** The `og:image` URL is an absolute path (starting with `https://`), points to an existing file, and the image dimensions are at least 1200x630 pixels.\n- **AC3:** The Facebook Sharing Debugger shows a \"Preview\" section with the correct title, description, and image, and reports no warnings or errors for the provided URL.\n- **AC4:** The Twitter Card Validator shows a \"Summary Card\" with the correct title, description, and image.\n- **AC5:** Manually sharing the page URL on a personal Facebook/LinkedIn timeline results in a post preview that matches the validator output from AC3/AC4.\n\n### F-19: Google Analytics Tracking Script\n\n1. Purpose\nTo integrate Google Analytics (GA4) tracking into the landing page, enabling the collection of anonymized visitor data (page views, key interactions) for measuring traffic, user behavior, and conversion goals related to course inquiries and contact form submissions.\n\n2. Actors\n- Primary: End-user's web browser (executes the tracking script).\n- Secondary: System (injects and initializes the script).\n\n3. Trigger\nThe landing page's initial HTML document is parsed and rendered by the user's browser.\n\n4. Preconditions\n- A valid GA4 Measurement ID (e.g., `G-XXXXXXXXXX`) is stored in the project's environment configuration or a dedicated configuration file (e.g., `.env`, `config.js`).\n- The page structure includes a consistent, targetable element for the main content container (for accurate page path tracking).\n\n5. Main Flow\n1.  On page load, the system reads the configured GA4 Measurement ID from the environment/config.\n2.  If a valid Measurement ID is present, the system dynamically injects the GA4 script tag (`<script async src=\"https://www.googletagmanager.com/gtag/js?id=MEASUREMENT_ID\"></script>`) into the `<head>` section of the HTML.\n3.  The system injects an inline initialization script immediately after the GA script tag. This script:\n    a. Defines the `window.dataLayer` and `gtag` function if not already present.\n    b. Calls `gtag('js', new Date())`.\n    c. Calls `gtag('config', 'MEASUREMENT_ID', { 'anonymize_ip': true });` to initialize the tracking property with IP anonymization enabled.\n4.  The GA library automatically tracks the initial `page_view` event, capturing the page's path (`location.pathname + location.search`) and title.\n5.  The system attaches event listeners to specific user interaction elements to track custom events:\n    a. **Service/Leistung Clicks:** Listens for clicks on elements with class `.service-card` or `.leistung-button`, triggering `gtag('event', 'generate_lead', { 'event_category': 'engagement', 'event_label': 'service_view' });`.\n    b. **Course Plan Interactions:** Listens for clicks on the course schedule table or buttons with class `.kurs-plan-entry`, triggering `gtag('event', 'view_item', { 'event_category': ' kursplan', 'event_label':ClickedCourseName });` (where `ClickedCourseName` is extracted from the element's text/data attribute).\n    c. **Contact Form Submission:** Listens for the `submit` event on the `<form id=\"contact-form\">`. Upon submission (and before potential page reload), it triggers `gtag('event', 'generate_lead', { 'event_category': 'contact', 'event_label': 'form_submit' });`.\n\n6. Alternate Flows\nA1: **Missing Tracking ID:** If no Measurement ID is found in the configuration at step 1, the system skips steps 2-5 entirely. No GA script is injected, and no tracking occurs. The page loads without error.\nA2: **Script Injection Failure:** If the external GA script fails to load (e.g., network error, blocked by browser extension), the inline initialization script (step 3) will not execute. The system logs a non-blocking warning to the console. No tracking data is sent for that session, but page functionality remains unaffected.\nA3: **Consent Not Given (if Consent Management is present):** If a separate consent management system (e.g., for GDPR) is implemented and the user has not consented to analytics cookies, the system bypasses steps 2-5 regardless of the configuration. Tracking is withheld until consent is granted.\n\n7. Postconditions\n- The GA4 tracking library is loaded and initialized on the page (if ID present and consent given).\n- A `page_view` event for the current URL has been sent to Google's servers.\n- Event listeners are active on specified interactive elements.\n- The system state is otherwise unchanged; user experience and core functionality are not impacted.\n\n8. Data Impact\n- **Data Collected:** Page path, page title, timestamp, screen resolution, language, a pseudonymous client ID (stored in a first-party cookie), and the custom events defined in step 5 of the Main Flow.\n- **Data Processing:** Data is sent directly to Google Analytics servers. IP addresses are anonymized upon collection.\n- **Storage:** No analytics data is stored on the studio's servers. All data resides in the configured GA4 property.\n- **PII:** The implementation ensures no personally identifiable information (PII) like names, email addresses, or phone numbers is sent to GA. Form field values are explicitly not tracked.\n\n9. UI Impact\n- **Visible:** None. The tracking script runs asynchronously in the background and does not alter the visual layout or content of the page.\n- **Non-Visible:** The presence of the GA script and `dataLayer` in the browser's JavaScript environment. This is transparent to the user.\n\n10. Acceptance Criteria\n1.  **Configuration:** The system correctly reads the GA4 Measurement ID from the specified configuration source.\n2.  **Script Injection:** The GA script (`gtag/js`) and the initialization inline script are present in the rendered HTML `<head>` only when a valid ID is configured and consent (if applicable) is given.\n3.  **Initialization:** The `gtag('config', ...)` call executes without JavaScript errors, as verified by browser console and the GA Debugger extension.\n4.  **Page View:** A `page_view` event for the correct URL appears in the GA4 \"Realtime\" > \"Events\" report within 60 seconds of loading the page.\n5.  **Custom Events:** Clicking a `.service-card` element, a `.kurs-plan-entry` element, and successfully submitting the `#contact-form` each generate a corresponding event (`generate_lead` or `view_item`) visible in the GA4 Realtime report with correct `event_category` and `event_label` parameters.\n6.  **No Regression:** The presence of the tracking script does not cause layout shifts (CLS), increase Largest Contentful Paint (LCP) significantly, or block the main thread. Page functionality (form submission, navigation) remains fully operational.\n7.  **Fallback:** When the Measurement ID is removed from configuration, no GA-related script tags or `gtag` calls appear in the page source or runtime environment.\n\n### F-20: Smooth Scroll to Anchor Links\n\n1. Purpose\nTo provide a smooth, animated scrolling experience when a user clicks a navigation link that targets a specific section (anchor) on the same page, improving user experience and perceived professionalism compared to the browser's default instant jump.\n\n2. Actors\nPrimary Actor: Website Visitor (end-user).\nSecondary Actor: None.\n\n3. Trigger\nThe user clicks on a navigation link (`<a>` element) whose `href` attribute is a fragment identifier (e.g., `#services`, `#contact`) pointing to an existing element on the current page.\n\n4. Preconditions\n1. The landing page contains at least one navigation link with an `href` attribute starting with `#`.\n2. The target element (with an `id` matching the fragment identifier) exists in the DOM.\n3. JavaScript is enabled in the user's browser (with a graceful fallback to default behavior if disabled).\n4. A fixed or sticky header, if present, does not obscure the target section's heading after scroll completion.\n\n5. Main Flow\n1. The user clicks a navigation anchor link (`<a href=\"#target-id\">`).\n2. The browser's default jump behavior is prevented via `event.preventDefault()`.\n3. The target element is located using `document.getElementById()` with the fragment identifier from the `href`.\n4. If the target element is found:\n   a. The vertical scroll position is calculated. This is the `targetElement.offsetTop` minus the height of any fixed/sticky header (if applicable) to ensure the target is fully visible.\n   b. A smooth scrolling animation is initiated using `window.scrollTo({ top: calculatedPosition, behavior: 'smooth' })`.\n   c. The browser's URL hash is updated to the fragment identifier (`#target-id`) using `history.pushState()` to avoid triggering another jump.\n5. The animation completes when the browser reaches the calculated scroll position.\n6. Optional: Focus is programmatically moved to the target element (`targetElement.focus()`) for accessibility, provided the element is focusable.\n\n6. Alternate Flows\n1. **JavaScript Disabled or Fails to Load:**\n   a. The click event is not intercepted.\n   b. The browser performs its default instant jump to the anchor.\n   c. The feature degrades gracefully; core functionality (navigation) remains intact.\n2. **Target Element Not Found:**\n   a. After step 3 in the main flow, `document.getElementById()` returns `null`.\n   b. No smooth scroll is initiated. The click event's default is prevented, but no action occurs. Optionally, a console warning is logged for debugging.\n3. **User Initiates New Scroll Before Current Animation Completes:**\n   a. A new click on any smooth-scroll link occurs while a previous scroll animation is in progress.\n   b. The current animation is cancelled (implicitly by the browser when a new `scrollTo` is called).\n   c. The new scroll animation begins from the current viewport position to the new target's calculated position.\n\n7. Postconditions\n1. The viewport is scrolled to the vertical position where the target element's top edge is aligned with the top of the viewport (accounting for fixed header offset).\n2. The URL in the address bar displays the correct fragment identifier (e.g., `.../index.html#services`).\n3. If implemented, the target element has focus.\n4. The active state of the navigation link corresponding to the target section is updated (if such a UI component exists and is managed separately).\n\n8. Data Impact\nNo persistent data is created, modified, or stored. A transient, in-memory analytics event (e.g., `smooth_scroll_triggered`) may be logged to an analytics queue if tracking is implemented, but this is not a core data storage operation.\n\n9. UI Impact\n1. **Visual:** The page content scrolls vertically with a smooth, decelerating animation (typical duration ~300-500ms) instead of an instant jump.\n2. **URL:** The fragment identifier appears in the URL bar without a full page reload.\n3. **Focus:** A visible focus ring may appear around the target element if it receives focus.\n4. **Navigation State:** The clicked navigation link may reflect an \"active\" state, and this state should update as the user scrolls (if an intersection observer is used for this, it is a separate concern).\n\n10. Acceptance Criteria\n1. **AC1:** Clicking a valid navigation anchor link results in a smooth vertical scroll animation to the target section.\n2. **AC2:** The target section's heading is not obscured by a fixed header (if present) after scroll completion.\n3. **AC3:** The browser's URL hash updates to match the clicked link's `href` fragment during/after the scroll.\n4. **AC4:** If JavaScript is disabled, clicking an anchor link performs the browser's default instant jump to the target section.\n5. **AC5:** Clicking a link with an `href` pointing to a non-existent `id` does not cause a scroll and does not throw a visible error to the user.\n6. **AC6:** The smooth scroll animation respects the user's \"prefers-reduced-motion\" OS setting; if reduced motion is preferred, the scroll should be instant (behave like the default jump).\n7. **AC7:** The feature works correctly on all modern browsers (Chrome, Firefox, Safari, Edge) and provides a graceful fallback (instant scroll) on browsers that do not support `scrollTo` with `behavior: 'smooth'`.\n\n### F-21: Image Lazy Loading\n\n1. Purpose\nTo improve initial page load performance and reduce bandwidth consumption by deferring the loading of images that are not immediately visible within the user's viewport. This ensures critical content (e.g., hero image, above-the-fold text) renders faster, improving Core Web Vitals (LCP, CLS) and user experience on the yoga studio landing page.\n\n2. Actors\n- Primary Actor: Web Browser (Client-side JavaScript)\n- Secondary Actor: End User (via scrolling behavior)\n\n3. Trigger\n- Initial page load (DOMContentLoaded event).\n- User scroll action that changes the viewport, causing new images to enter the viewport.\n\n4. Preconditions\n- All target `<img>` elements in the HTML have a `data-src` (or `data-srcset`) attribute containing the actual high-resolution image URL(s).\n- All target `<img>` elements have a `loading=\"lazy\"` attribute (for native browser support) OR are identified by a specific CSS class (e.g., `.lazy`) for the JavaScript polyfill/observer.\n- A lightweight placeholder image (e.g., a 1x1 transparent GIF, a low-quality blurred version, or a solid background color) is set as the initial `src` attribute to prevent layout shift.\n- The browser supports the Intersection Observer API or a polyfill is included.\n\n5. Main Flow\n1.  On `DOMContentLoaded`, the JavaScript selects all `<img>` elements that either have `loading=\"lazy\"` or the `.lazy` class.\n2.  For each selected image, the script stores the actual image URL from `data-src` (or `data-srcset`) in a variable and ensures the `src` attribute contains only the placeholder.\n3.  An `IntersectionObserver` instance is created with a root margin (e.g., `\"100px 0px\"`) to trigger loading slightly before the image enters the viewport.\n4.  Each target image is observed by the `IntersectionObserver`.\n5.  When the observer callback detects an image has intersected the viewport (based on the root margin):\n    a.  The image's `src` attribute is set to the value from `data-src`.\n    b.  If `srcset` is used, `data-srcset` is moved to `srcset`.\n    c.  The image is unobsered from the `IntersectionObserver`.\n6.  The image begins loading. Upon successful load (`onload` event), a CSS class (e.g., `.loaded`) is added to the image to trigger a fade-in transition. On error (`onerror`), a fallback image or error message is displayed.\n\n6. Alternate Flows\n- **A1: JavaScript Disabled.** If client-side JavaScript is unavailable, the browser's native `loading=\"lazy\"` attribute (if present) will handle lazy loading. If no native support and no JS, all images will load immediately as the `data-src` attributes are ignored by the browser, and only the placeholder `src` is loaded (resulting in broken/incomplete images). *Mitigation: The HTML must include a `<noscript>` block containing the full, correct `<img>` tags with standard `src` attributes for critical images to ensure basic functionality without JS.*\n- **A2: Image Already in Viewport on Load.** The `IntersectionObserver` callback triggers immediately for images already within the viewport (plus root margin), loading them without delay.\n- **A3: Network Failure.** If the image URL from `data-src` fails to load (404, timeout), the `onerror` handler replaces the `src` with a predefined fallback image (e.g., a generic \"image not available\" icon) and logs the error to the console for debugging.\n- **A4: Rapid Scrolling.** The `IntersectionObserver` efficiently batches callbacks. Images that quickly enter and exit the viewport during rapid scrolling will still load once the intersection threshold is met; the load process cannot be easily canceled mid-request but will complete in the background.\n\n7. Postconditions\n- All images initially outside the viewport (plus defined root margin) have their `src`/`srcset` attributes updated from the `data-*` attributes and are loading or have loaded.\n- Images that entered the viewport during the session have either displayed successfully, displayed a fallback, or are in a loading state.\n- The initial page payload size is reduced, as only placeholder images and critical above-the-fold images are requested immediately.\n- The `IntersectionObserver` has no remaining observed targets (all have been unobserved).\n\n8. Data Impact\n- **No new persistent data storage.** All logic is client-side and ephemeral.\n- **Session State:** The browser's native image cache stores loaded images. If the user navigates away and returns (via back button), cached images may load instantly from the browser cache if the same URLs are requested.\n- **Analytics (Optional):** A custom event (e.g., `lazyImageLoaded`) could be dispatched for each successful image load to allow integration with analytics tools (e.g., Google Analytics) to track performance metrics, but this is not a core requirement.\n\n9. UI Impact\n- **Before Load:** Off-screen images display as the defined placeholder (e.g., a light gray box or a very low-resolution blurred preview).\n- **During Load:** The browser's default loading spinner/behavior may appear briefly.\n- **After Successful Load:** The image fades in smoothly via a CSS transition on the `.loaded` class (opacity from 0 to 1). This prevents layout shift (CLS) as the placeholder reserves the correct aspect ratio space.\n- **After Error:** The fallback image replaces the placeholder, clearly indicating the image could not be loaded.\n- **No visual change** for images natively supported by the browser's `loading=\"lazy\"` attribute when JavaScript is disabled.\n\n10. Acceptance Criteria\n- **AC1:** The initial page load (measured via browser DevTools Network tab) shows only placeholder image requests and requests for images within the viewport (including the defined root margin). No requests for off-screen images occur until they are scrolled near.\n- **AC2:** All images load and display correctly when their container scrolls into the viewport. The fade-in transition plays smoothly without causing layout shift (CLS score remains near 0).\n- **AC3:** The feature works in all target browsers (Chrome, Firefox, Safari, Edge). For browsers without Intersection Observer support (e.g., older Safari), the included polyfill functions correctly.\n- **AC4:** If an image URL is invalid, the fallback image is displayed, and no broken image icon is shown.\n- **AC5:** The `<noscript>` block contains functional, non-lazy-loaded versions of the hero image and any other critical images, ensuring the page remains usable and visually complete without JavaScript.\n- **AC6:** Performance metrics (Lighthouse) show an improvement in \"Largest Contentful Paint (LCP)\" compared to a version without lazy loading, assuming similar network conditions.\n\n### F-22: ARIA Labels for Accessibility\n\n1. Purpose\nTo ensure the landing page for the local yoga studio is fully navigable and understandable for users of assistive technologies, specifically screen readers. This is achieved by adding appropriate ARIA (Accessible Rich Internet Applications) attributes to all interactive and non-standard semantic elements, thereby meeting WCAG 2.1 AA success criteria.\n\n2. Actors\n- Primary: End-users utilizing screen readers (e.g., NVDA, JAWS, VoiceOver).\n- Secondary: Front-end developers implementing the attributes; QA testers validating accessibility.\n\n3. Trigger\nA user navigates to the landing page using a screen reader or other assistive technology that relies on the accessibility tree.\n\n4. Preconditions\n- The core HTML structure and visual design of the landing page (Hero, Services, Course Plan, Contact Form) are implemented.\n- All interactive elements (links, buttons, form inputs) have native HTML semantics where possible (e.g., `<button>`, `<a>`, `<input>`).\n- The page is served with a proper `lang` attribute on the `<html>` element.\n\n5. Main Flow\n1.  **Navigation Landmark:** Add `role=\"navigation\"` to the `<nav>` element containing the main site links (e.g., \"Leistungen\", \"Kursplan\", \"Kontakt\"). Add an `aria-label=\"Hauptnavigation\"` to describe its purpose.\n2.  **Main Content Landmark:** Ensure the primary content container (e.g., `<main>`) has `role=\"main\"` and `aria-label=\"Seiteninhalt\"`.\n3.  **Hero Section:** The main headline (`<h1>`) is inherently accessible. If the hero contains a non-semantic container for background imagery or layout, add `role=\"img\"` and a concise `aria-label=\"Yoga Studio [Stadname] - Willkommen\"` describing the visual theme.\n4.  **Services Section:** Each service card (e.g., \"Hatha Yoga\", \"Vinyasa Flow\") is a `<div>` or `<article>`. Add `role=\"region\"` and a unique `aria-labelledby` that references the card's title `<h2>` or `<h3>` ID.\n5.  **Course Plan Table:** The weekly schedule is presented in an HTML `<table>`.\n    a. Add `<caption>` element with text \"Wöchentlicher Kursplan für [Monat/Jahr]\".\n    b. Ensure all table headers (`<th>`) have proper `scope=\"col\"` or `scope=\"row\"` attributes.\n6.  **Contact Form:**\n    a. Each form input (`<input>`, `<textarea>`) has a visible, associated `<label>` using the `for` attribute.\n    b. For the form's purpose, add `aria-label=\"Kontaktformular für [Studio Name]\"` to the `<form>` element.\n    c. For the submit button with only an icon (e.g., SVG arrow), add `aria-label=\"Nachricht senden\"`.\n7.  **Skip Link:** Implement a visually hidden but focusable \"Skip to main content\" link as the first focusable element in the `<body>`. It must have `href=\"#main\"` (targeting the `<main id=\"main\">` element) and appropriate CSS to become visible on focus.\n8.  **Icon Buttons/Links:** For any icon-only buttons (e.g., social media icons in the footer), add `aria-label=\"Link zu [Platform Name]\"` (e.g., \"Link zu Instagram\").\n9.  **Live Regions (if applicable):** If the contact form uses AJAX for submission, the status message container (success/error) must have `aria-live=\"polite\"` and `aria-atomic=\"true\"`.\n\n6. Alternate Flows\n1.  **Dynamic Form Validation:** If form validation errors appear dynamically without a page reload, the error message container for each invalid field must have `role=\"alert\"` or be placed within an element with `aria-live=\"assertive\"` to ensure immediate announcement. The invalid input must also have `aria-invalid=\"true\"` and `aria-describedby` pointing to the error message ID.\n2.  **Modal/Dialog (if used):** If a \"Book Now\" button opens a modal dialog for class registration, the modal must have `role=\"dialog\"`, `aria-modal=\"true\"`, and an `aria-labelledby` referencing its title. Focus must be trapped within the modal upon opening and returned to the triggering button upon closing.\n3.  **Expandable/Collapsible Sections:** If the course plan has filter toggles (e.g., \"Show only advanced\"), the button controlling the section must have `aria-expanded=\"true/false\"` and `aria-controls=\"ID-of-content-section\"`.\n\n7. Postconditions\n- All major page sections are programmatically determinable via landmarks.\n- Every interactive element has an accessible name computable by assistive technologies.\n- The accessibility tree accurately reflects the page structure and state (e.g., expanded/collapsed, form errors).\n- Screen reader users can navigate sequentially and by landmark/heading to all content and functionality.\n\n8. Data Impact\n- **None.** This feature does not alter business data, database schemas, or application state. It only adds metadata attributes to the front-end HTML/DOM.\n\n9. UI Impact\n- **Visual Design:** No visual changes to the existing UI layout, colors, or typography.\n- **Code Structure:** The HTML source code will include additional `role`, `aria-label`, `aria-labelledby`, `aria-describedby`, `aria-live`, and `aria-expanded` attributes.\n- **CSS:** May require minor adjustments for the \"Skip to main content\" link to be hidden off-screen but visible on `:focus`.\n\n10. Acceptance Criteria\n1.  **Automated Test:** The page scores 0 violations for WCAG 2.1 AA rules related to ARIA (e.g., `aria-label`, `aria-labelledby`, `role` usage) in a tool like axe-core or Lighthouse.\n2.  **Manual Screen Reader Test (VoiceOver/NVDA):**\n    a. A user can navigate the page using the landmark rotor/list and jump directly to \"Main Navigation\", \"Main Content\", and \"Footer\".\n    b. The hero section is announced with its descriptive label.\n    c. Each service card is announced as a \"region\" followed by its title.\n    d. The course plan table is read logically, with headers properly associated with cells.\n    e. All form inputs are announced with their associated labels. Validation errors (if triggered) are announced immediately.\n    f. Icon-only buttons announce their purpose (e.g., \"Instagram, link\").\n3.  **Keyboard Navigation:** The \"Skip to main content\" link is the first tab stop, becomes visibly focused, and correctly moves focus to the `<main>` element when activated.\n4.  **Code Review:** All added ARIA attributes are validated against the W3C ARIA specification and are necessary (i.e., native HTML semantics are not overridden unnecessarily).\n\n### F-23: HTTPS Redirection\n\n1. Purpose\nTo enforce secure communication by automatically redirecting all unencrypted HTTP requests to their encrypted HTTPS counterparts. This protects data integrity and confidentiality, improves search engine ranking, and ensures compliance with modern security standards.\n\n2. Actors\n- End-User (via browser or HTTP client)\n- Web Server (handling the request)\n- Search Engine Crawler (indexing the site)\n\n3. Trigger\nAn HTTP request (port 80) is received by the web server for any resource on the studio's domain (e.g., `http://yogastudio-example.de/`).\n\n4. Preconditions\n- A valid SSL/TLS certificate is installed and correctly configured for the domain.\n- The web server is configured to listen on port 443 for HTTPS traffic.\n- The HTTPS virtual host/server block is fully functional and serves the site correctly.\n\n5. Main Flow\n1.  The web server receives an HTTP request on port 80.\n2.  The server inspects the `Host` header and requested URI path/query string.\n3.  The server constructs the target HTTPS URL by replacing the `http://` scheme with `https://` while preserving the exact host, port (if non-standard), path, and query string.\n4.  The server sends an HTTP 301 (Moved Permanently) response with the `Location` header set to the constructed HTTPS URL.\n5.  The client (browser/crawler) receives the 301 response and automatically issues a new request to the provided HTTPS URL.\n6.  The web server receives the new HTTPS request on port 443 and processes it normally, serving the requested resource.\n\n6. Alternate Flows\n- **A1: Request Already Uses HTTPS:** The server receives a request on port 443. The server skips the redirection logic and proceeds directly to serve the requested resource over the established secure connection.\n- **A2: Redirect to a Non-Existent HTTPS Resource:** The HTTP request is for a valid path that does not exist (e.g., `/invalid-page`). The server still issues a 301 redirect to `https://domain/invalid-page`. The subsequent HTTPS request then results in the appropriate 404 Not Found response from the HTTPS server.\n- **A3: Malformed Host Header:** The HTTP request contains an invalid or missing `Host` header. The server may return a 400 Bad Request error instead of a redirect, as it cannot reliably construct the target HTTPS URL.\n\n7. Postconditions\n- All subsequent requests for the site's resources from the client are made over HTTPS.\n- The HTTP (port 80) endpoint consistently returns a 301 redirect for any requested path.\n- The site is exclusively accessible via HTTPS for properly configured clients.\n- Search engine crawlers receive a clear signal to index the HTTPS version of the site.\n\n8. Data Impact\nNo persistent data is created, modified, or deleted. The operation is stateless and only affects request routing.\n\n9. UI Impact\nThere is no visible user interface change. Users may briefly see their browser's address bar change from `http://` to `https://` and a potential minor delay during the redirect handshake. The lock icon (or equivalent security indicator) will be displayed after the HTTPS connection is established.\n\n10. Acceptance Criteria\n- **AC1:** Any URL accessed via `http://[valid-domain]/[any-path]` returns an HTTP 301 status code.\n- **AC2:** The `Location` header in the 301 response points to the identical path and query string on the `https://` scheme.\n- **AC3:** Accessing the site directly via `https://[valid-domain]/[any-path]` returns a 200 OK status code and serves the correct content without any redirect.\n- **AC4:** The redirect chain length is exactly 1 (HTTP -> HTTPS), with no redirect loops (e.g., HTTPS redirecting back to HTTP or to another HTTP URL).\n- **AC5:** The SSL/TLS certificate for the HTTPS endpoint is valid, trusted by the client, and presented without errors during the HTTPS request.\n- **AC6:** The redirection works consistently for the primary domain (e.g., `yogastudio-example.de`) and any configured `www` subdomain (e.g., `www.yogastudio-example.de`), redirecting each to its corresponding HTTPS host.\n\n### F-24: Newsletter Signup Field\n\n1. Purpose\nTo collect email addresses from website visitors who voluntarily opt-in to receive the yoga studio's newsletter and promotional communications, building a marketing contact list.\n\n2. Actors\n*   **Primary Actor:** Website Visitor (potential customer).\n*   **Secondary Actor:** Studio Staff/Marketing Team (indirectly, as recipients of the collected data).\n\n3. Trigger\nThe visitor scrolls to or navigates to the section of the landing page containing the newsletter signup form and decides to subscribe.\n\n4. Preconditions\n*   The landing page is fully loaded and rendered in the user's browser.\n*   The newsletter signup field component is visible and interactive on the page (e.g., in the footer or a dedicated section).\n*   The backend API endpoint for handling newsletter subscriptions is available and responsive.\n\n5. Main Flow\n1.  The visitor views the landing page and locates the newsletter signup field, which includes a text input for an email address, a \"Subscribe\" button, and a link to the privacy policy.\n2.  The visitor enters a valid email address into the input field.\n3.  The visitor clicks the \"Subscribe\" button.\n4.  The frontend performs immediate client-side validation to ensure the input is a syntactically valid email address (e.g., contains '@' and a domain).\n5.  Upon passing client-side validation, the frontend sends an asynchronous HTTP POST request to the backend subscription endpoint (`/api/subscribe`) containing the email address and an implicit or explicit consent flag.\n6.  The backend receives the request, validates the email format server-side, and checks against the existing subscriber database to prevent duplicates (based on normalized email address).\n7.  If the email is valid and new, the backend creates a new subscriber record with the email, a timestamp (`subscribed_at`), a `source` field set to \"landingpage\", and a `consent_given` flag set to `true` (based on the act of submission). The record status is set to `active`.\n8.  The backend returns a successful HTTP response (e.g., `200 OK` or `201 Created`).\n9.  The frontend receives the successful response and updates the UI to display a success confirmation message (e.g., \"Thank you for subscribing!\") and disables or resets the input field and button.\n\n6. Alternate Flows\n*   **A1: Invalid Email Format (Client-Side):** In step 4, the client-side validation fails. The UI displays an inline error message (e.g., \"Please enter a valid email address\") next to the input field. The form is not submitted.\n*   **A2: Invalid Email Format (Server-Side):** In step 6, server-side validation fails (e.g., malformed email passed client-side). The backend returns an error response (e.g., `400 Bad Request`). The frontend displays a generic error message (e.g., \"Invalid email address. Please try again.\").\n*   **A3: Email Already Subscribed:** In step 6, the email is found in the database with an `active` status. The backend returns a specific response (e.g., `409 Conflict`). The frontend displays a message (e.g., \"This email is already on our list.\"). The subscriber's `subscribed_at` timestamp is not updated.\n*   **A4: Backend Unavailable:** In step 5, the network request fails (timeout, 5xx error). The frontend displays a generic failure message (e.g., \"Subscription failed. Please check your connection and try again.\") and re-enables the submit button.\n\n7. Postconditions\n*   A new subscriber record exists in the database with the provided email, timestamp, source, and active status, OR an existing active record is left unchanged.\n*   The user interface reflects the outcome (success message, error message, or field reset).\n*   The system has logged the subscription attempt (success or failure) for audit purposes.\n\n8. Data Impact\n*   **New Data Created:** A `subscribers` table record with fields: `id` (PK), `email` (unique, indexed), `subscribed_at` (datetime), `source` (varchar), `consent_given` (boolean), `status` (varchar, e.g., 'active').\n*   **Data Updated:** No existing data is updated for a new subscription. For an already-subscribed email, no update occurs.\n*   **GDPR/Privacy:** The `consent_given` flag and `subscribed_at` timestamp must be stored to prove opt-in. The privacy policy link must be present.\n\n9. UI Impact\n*   A form component is added to the landing page layout, typically in the footer or a pre-footer section.\n*   The component consists of: a label (\"Subscribe to our newsletter\"), a single-line text input (`type=\"email\"`), a primary action button (\"Subscribe\"), and a small text link to the Privacy Policy.\n*   The UI must provide clear, accessible validation feedback (ARIA live regions for errors/success).\n*   On success, the input and button are replaced by or accompanied by a persistent success message.\n*   The component is responsive and styled consistently with the studio's brand.\n\n10. Acceptance Criteria\n*   **AC1:** Entering a syntactically invalid email (e.g., \"test@\") and clicking Subscribe displays an immediate, clear client-side error message and does not send a network request.\n*   **AC2:** Entering a valid, *new* email address and clicking Subscribe results in a `200`/`201` API response, the UI shows a success confirmation, and a new record with `status='active'` and `consent_given=true` is created in the database.\n*   **AC3:** Entering a valid, *already subscribed* email address and clicking Subscribe results in a `409` API response (or similar), the UI shows an appropriate \"already subscribed\" message, and no new database record is created.\n*   **AC4:** If the API is unreachable or returns a 5xx error, the UI shows a generic failure message and the user can retry.\n*   **AC5:** The subscription form is accessible via keyboard navigation and screen readers. The privacy policy link is clearly visible and navigable.\n*   **AC6:** The input field clears or is disabled after a successful subscription, preventing duplicate immediate submissions.\n\n## Non-Functional Requirements\n\n- Zuverlaessigkeit: Ein iterativer Lauf muss ohne Verlust bereits akzeptierter Features abschliessen.\n- Determinismus: Freeze-Baseline und Feature-IDs bleiben ueber Iterationen stabil.\n- Performance: In Freeze-Mode wird Section-Patching gegenueber Vollregeneration bevorzugt.\n- Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen.\n- Barrierefreiheit: WCAG-Level AA\n- Performance:\n  - LCP (Largest Contentful Paint) < 2 s\n  - FID (First Input Delay) < 100 ms\n  - CLS (Cumulative Layout Shift) < 0,1\n\n## Error Handling & Recovery\n\n- Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n- Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n- Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n- Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert.\n\n## Deployment & Infrastructure\n\n- Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n- Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n- Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n- Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert.\n\n## Definition of Done\n\n- Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n- Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n- Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n- Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n\n---\n\n## Feature Delta (JSON)\n```json\n{\n  \"addedFeatures\": [\n    {\n      \"featureId\": \"F-01\",\n      \"name\": \"Responsive Layout\",\n      \"shortDescription\": \"Ensure the landing page renders optimally across various viewport sizes\"\n    },\n    {\n      \"featureId\": \"F-02\",\n      \"name\": \"Sticky Navigation Menu\",\n      \"shortDescription\": \"Provide a fixed-position navigation header for improved accessibility and user experience\"\n    },\n    {\n      \"featureId\": \"F-03\",\n      \"name\": \"Hamburger Menu for Mobile\",\n      \"shortDescription\": \"Offer an accessible and space-efficient navigation interface on mobile devices\"\n    },\n    {\n      \"featureId\": \"F-04\",\n      \"name\": \"Hero Section with Background Image\",\n      \"shortDescription\": \"Create an immediate visual impact with a full-width background image and prominent text overlay\"\n    },\n    {\n      \"featureId\": \"F-05\",\n      \"name\": \"Hero Call-to-Action Button\",\n      \"shortDescription\": \"Encourage visitors to navigate to the contact form with a prominent and visible button\"\n    },\n    {\n      \"featureId\": \"F-06\",\n      \"name\": \"Services Overview Section\",\n      \"shortDescription\": \"Present a concise and visually engaging overview of the yoga studio's core service offerings\"\n    },\n    {\n      \"featureId\": \"F-07\",\n      \"name\": \"Individual Service Card Component\",\n      \"shortDescription\": \"Render a visually consistent and self-contained card component for each service\"\n    },\n    {\n      \"featureId\": \"F-08\",\n      \"name\": \"Course Schedule Section\",\n      \"shortDescription\": \"Provide a clear and up-to-date weekly overview of all yoga classes offered by the studio\"\n    },\n    {\n      \"featureId\": \"F-09\",\n      \"name\": \"Course Detail Modal\",\n      \"shortDescription\": \"Offer a full and on-demand view of a specific yoga class without leaving the schedule section\"\n    },\n    {\n      \"featureId\": \"F-10\",\n      \"name\": \"Contact Form Component\",\n      \"shortDescription\": \"Enable visitors to submit inquiries and requests for booking with a functional contact form\"\n    },\n    {\n      \"featureId\": \"F-11\",\n      \"name\": \"Form Validation Logic\",\n      \"shortDescription\": \"Ensure only complete and syntactically valid data is submitted via the contact form\"\n    },\n    {\n      \"featureId\": \"F-12\",\n      \"name\": \"Form Submission Handling (Email Notification)\",\n      \"shortDescription\": \"Transmit the data entered in the contact form to the studio's designated email address\"\n    },\n    {\n      \"featureId\": \"F-13\",\n      \"name\": \"CAPTCHA Integration for Contact Form\",\n      \"shortDescription\": \"Distinguish human users from automated bots with a challenge-response test\"\n    },\n    {\n      \"featureId\": \"F-14\",\n      \"name\": \"Footer with Address, Hours, and Copyright\",\n      \"shortDescription\": \"Display the yoga studio's static contact information and mandatory legal copyright notice\"\n    },\n    {\n      \"featureId\": \"F-15\",\n      \"name\": \"Social Media Icon Links\",\n      \"shortDescription\": \"Provide direct access to the yoga studio's official social media profiles\"\n    },\n    {\n      \"featureId\": \"F-16\",\n      \"name\": \"Google Maps Embed\",\n      \"shortDescription\": \"Embed an interactive Google Map to pinpoint the physical location of the yoga studio\"\n    },\n    {\n      \"featureId\": \"F-17\",\n      \"name\": \"SEO Meta Tags (Title & Description)\",\n      \"shortDescription\": \"Improve search engine visibility and click-through rates with optimized meta tags\"\n    },\n    {\n      \"featureId\": \"F-18\",\n      \"name\": \"Open Graph Tags for Social Sharing\",\n      \"shortDescription\": \"Ensure a rich and branded preview when the landing page URL is shared on social media\"\n    },\n    {\n      \"featureId\": \"F-19\",\n      \"name\": \"Google Analytics Tracking Script\",\n      \"shortDescription\": \"Collect anonymized visitor data for measuring traffic and user behavior\"\n    },\n    {\n      \"featureId\": \"F-20\",\n      \"name\": \"Smooth Scroll to Anchor Links\",\n      \"shortDescription\": \"Provide a smooth and animated scrolling experience for anchor links\"\n    },\n    {\n      \"featureId\": \"F-21\",\n      \"name\": \"Image Lazy Loading\",\n      \"shortDescription\": \"Improve initial page load performance by deferring the loading of non-visible images\"\n    },\n    {\n      \"featureId\": \"F-22\",\n      \"name\": \"ARIA Labels for Accessibility\",\n      \"shortDescription\": \"Ensure the landing page is fully navigable and understandable for users of assistive technologies\"\n    },\n    {\n      \"featureId\": \"F-23\",\n      \"name\": \"HTTPS Redirection\",\n      \"shortDescription\": \"Enforce secure communication by redirecting HTTP requests to HTTPS\"\n    },\n    {\n      \"featureId\": \"F-24\",\n      \"name\": \"Newsletter Signup Field\",\n      \"shortDescription\": \"Collect email addresses from visitors who opt-in to receive the yoga studio's newsletter\"\n    }\n  ],\n  \"updatedFeatures\": [\n    {\n      \"featureId\": \"F-01\",\n      \"notes\": \"Updated to include responsive design for better mobile experience\"\n    },\n    {\n      \"featureId\": \"F-02\",\n      \"notes\": \"Improved sticky navigation menu for better accessibility\"\n    }\n  ]\n}\n```",
      "answererOutput": "**Question 1: Identify the top unresolved product scope risk.**\n\nAnswer:\nThe top unresolved product scope risk is the lack of a clear definition of the iterative development process and the potential for feature creep. The PRD mentions an iterative approach but does not provide detailed information on how the process will be managed, including how requirements will be prioritized, and how changes will be handled. This lack of clarity could lead to scope creep, delays, and cost overruns.\n\nReasoning:\nA well-defined iterative development process is essential for managing product scope and ensuring that the development team is working on the most valuable features. Without a clear process, the project may experience delays, and the final product may not meet the stakeholders' expectations.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the iterative development process, including:\n\n* A clear definition of the iteration cycle and the milestones that will be used to measure progress\n* A description of how requirements will be prioritized and how changes will be handled\n* A definition of the roles and responsibilities of the stakeholders and the development team\n* A description of the communication plan and how stakeholders will be informed of progress and changes\n\nSection: **System Vision** and **System Boundaries** should be updated to include a detailed description of the iterative development process.\n\n**Question 2: Identify the top unresolved UX risk.**\n\nAnswer:\nThe top unresolved UX risk is the lack of accessibility features in the PRD. While the PRD mentions that the website should be responsive and work on different devices, it does not provide any information on how the website will be made accessible to users with disabilities.\n\nReasoning:\nAccessibility is a critical aspect of UX, and neglecting it can lead to a poor user experience for users with disabilities. Moreover, accessibility is a legal requirement in many countries, and neglecting it can lead to legal issues.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the accessibility features that will be implemented, including:\n\n* A description of how the website will be made accessible to users with visual, auditory, motor, or cognitive disabilities\n* A definition of the accessibility standards that will be followed (e.g., WCAG 2.1)\n* A description of how accessibility will be tested and validated\n\nSection: **Domain Model** and **Global Business Rules** should be updated to include a detailed description of the accessibility features.\n\n**Question 3: Identify the top unresolved data/operational risk.**\n\nAnswer:\nThe top unresolved data/operational risk is the lack of a clear data management plan. The PRD mentions that the website will collect user data, but it does not provide any information on how the data will be stored, processed, and protected.\n\nReasoning:\nData management is a critical aspect of operational risk, and neglecting it can lead to data breaches, fines, and reputational damage. Moreover, data protection is a legal requirement in many countries, and neglecting it can lead to legal issues.\n\nConcrete Implementation:\nTo mitigate this risk, the PRD should include a detailed description of the data management plan, including:\n\n* A description of the types of data that will be collected and how they will be used\n* A definition of the data storage and processing procedures\n* A description of the data protection measures that will be implemented (e.g., encryption, access controls)\n* A description of how data breaches will be handled and notified\n\nSection: **Data Impact** and **Security** should be updated to include a detailed description of the data management plan.\n\nOpen Points, Gaps, or unresolved areas in the PRD:\n\n* The PRD does not provide a clear definition of the iterative development process.\n* The PRD does not provide any information on accessibility features.\n* The PRD does not provide a clear data management plan.\n* The PRD does not provide any information on how the website will be tested and validated.\n* The PRD does not provide any information on how the website will be maintained and updated after launch.\n\nThese open points, gaps, or unresolved areas should be addressed in the next PRD revision to ensure that the project is well-planned and executed. [TRUNCATED]",
      "questions": [
        {
          "id": "q_product_scope_risk",
          "status": "resolved",
          "title": "Top unresolved product scope risk",
          "text": "What is the top unresolved product scope risk?"
        },
        {
          "id": "q_ux_risk",
          "status": "resolved",
          "title": "Top unresolved UX risk",
          "text": "What is the top unresolved UX risk?"
        },
        {
          "id": "q_data_ops_risk",
          "status": "resolved",
          "title": "Top unresolved data/operational risk",
          "text": "What is the top unresolved data/operational risk?"
        }
      ],
      "mergedPRD": "## System Vision\n\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries\n\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand\n\n## Domain Model\n\n- Kern-Entitaeten: Nutzer/Besucher, Feature, Anforderung und Iteration.\n- Beziehungen: Eine Anforderung aggregiert Features; jede Iteration verfeinert bestehende Features und kann neue ueber ein strukturiertes Delta hinzufuegen.\n- Datenkonsistenz: Feature-IDs bleiben ueber Iterationen stabil und gelten als unveraenderliche Kennungen.\n- Quellkontext (Iteration 1): Erstelle eine kompakte Landingpage fuer ein lokales Yogastudio mit Hero, Leistungen, Kursplan und Kontaktformular.\n\n## Global Business Rules\n\n- Bestehende Features duerfen waehrend der iterativen Verfeinerung nicht entfernt werden.\n- Neue Features werden nur ueber validiertes Feature-Delta-JSON akzeptiert.\n- Doppelte Features (gleiche Intention/Bezeichnung) werden deterministisch verworfen.\n- Akzeptanzkriterien aller Features muessen testbar und beobachtbar bleiben.\n\n## Functional Feature Catalogue\n\n- Zuverlaessigkeit: Ein iterativer Lauf muss ohne Verlust bereits akzeptierter Features abschliessen.\n- Determinismus: Freeze-Baseline und Feature-IDs bleiben ueber Iterationen stabil.\n- Performance: In Freeze-Mode wird Section-Patching gegenueber Vollregeneration bevorzugt.\n- Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen.\n\n### F-01: Responsive Layout\n\n**1. Purpose**\n\nResponsive Layout liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n**2. Actors**\n\nPrimär: Endnutzer. Sekundär: Systemkomponenten zur Verarbeitung.\n\n**3. Trigger**\n\nWird ausgelöst, wenn der Nutzer die zugehörige Aktion in der Oberfläche startet.\n\n**4. Preconditions**\n\nAnwendung ist verfügbar, notwendige Datenquellen sind erreichbar, Nutzerkontext ist geladen.\n\n**5. Main Flow**\n\n1. 1. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n2. 2. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n3. 3. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n4. 4. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n\n**6. Alternate Flows**\n\n1. Fehlerfall: Bei ungültiger Eingabe zeigt das System eine klare Validierungsmeldung und behält den Eingabekontext.\n\n**7. Postconditions**\n\nNach Abschluss ist der Feature-Zustand konsistent gespeichert und für Folgeprozesse verfügbar.\n\n**8. Data Impact**\n\nRelevante Entitäten werden gelesen/geschrieben; Änderungen sind nachvollziehbar und konsistent.\n\n**9. UI Impact**\n\nUI stellt den Status transparent dar und bietet klare Rückmeldungen für Erfolg und Fehler.\n\n**10. Acceptance Criteria**\n\n1. 1. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n2. 2. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n3. 3. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n\n### F-02: Sticky Navigation Menu\n\nSticky Navigation Menu liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-03: Hamburger Menu for Mobile\n\nHamburger Menu for Mobile liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-04: Hero Section with Background Image\n\nHero Section with Background Image liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-05: Hero Call‑to‑Action Button\n\nHero Call‑to‑Action Button liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-06: Services Overview Section\n\nServices Overview Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-07: Individual Service Card Component\n\nIndividual Service Card Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-08: Course Schedule Section\n\nCourse Schedule Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-09: Course Detail Modal\n\nCourse Detail Modal liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-10: Contact Form Component\n\nContact Form Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-11: Form Validation Logic\n\nForm Validation Logic liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-12: Form Submission Handling (Email Notification)\n\nForm Submission Handling (Email Notification) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-13: CAPTCHA Integration for Contact Form\n\nCAPTCHA Integration for Contact Form liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-14: Footer with Address, Hours, and Copyright\n\nFooter with Address, Hours, and Copyright liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-15: Social Media Icon Links\n\nSocial Media Icon Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-16: Google Maps Embed\n\nGoogle Maps Embed liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-17: SEO Meta Tags (Title & Description)\n\nSEO Meta Tags (Title & Description) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-18: Open Graph Tags for Social Sharing\n\nOpen Graph Tags for Social Sharing liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-19: Google Analytics Tracking Script\n\nGoogle Analytics Tracking Script liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-20: Smooth Scroll to Anchor Links\n\nSmooth Scroll to Anchor Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-21: Image Lazy Loading\n\nImage Lazy Loading liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-22: ARIA Labels for Accessibility\n\nARIA Labels for Accessibility liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-23: HTTPS Redirection\n\nHTTPS Redirection liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-24: Newsletter Signup Field\n\nTo collect email addresses from website visitors who voluntarily opt-in to receive the yoga studio's newsletter and promotional communications, building a marketing contact list.\n\n*   **Primary Actor:** Website Visitor (potential customer).\n*   **Secondary Actor:** Studio Staff/Marketing Team (indirectly, as recipients of the collected data).\n\nThe visitor scrolls to or navigates to the section of the landing page containing the newsletter signup form and decides to subscribe.\n\n*   The landing page is fully loaded and rendered in the user's browser.\n*   The newsletter signup field component is visible and interactive on the page (e.g., in the footer or a dedicated section).\n*   The backend API endpoint for handling newsletter subscriptions is available and responsive.\n\n1. The visitor views the landing page and locates the newsletter signup field, which includes a text input for an email address, a \"Subscribe\" button, and a link to the privacy policy.\n2. The visitor enters a valid email address into the input field.\n3. The visitor clicks the \"Subscribe\" button.\n4. The frontend performs immediate client-side validation to ensure the input is a syntactically valid email address (e.g., contains '@' and a domain).\n5. Upon passing client-side validation, the frontend sends an asynchronous HTTP POST request to the backend subscription endpoint (`/api/subscribe`) containing the email address and an implicit or explicit consent flag.\n6. The backend receives the request, validates the email format server-side, and checks against the existing subscriber database to prevent duplicates (based on normalized email address).\n7. If the email is valid and new, the backend creates a new subscriber record with the email, a timestamp (`subscribed_at`), a `source` field set to \"landingpage\", and a `consent_given` flag set to `true` (based on the act of submission). The record status is set to `active`.\n8. The backend returns a successful HTTP response (e.g., `200 OK` or `201 Created`).\n9. The frontend receives the successful response and updates the UI to display a success confirmation message (e.g., \"Thank you for subscribing!\") and disables or resets the input field and button.\n\n1. **A1: Invalid Email Format (Client-Side):** In step 4, the client-side validation fails. The UI displays an inline error message (e.g., \"Please enter a valid email address\") next to the input field. The form is not submitted.\n2. **A2: Invalid Email Format (Server-Side):** In step 6, server-side validation fails (e.g., malformed email passed client-side). The backend returns an error response (e.g., `400 Bad Request`). The frontend displays a generic error message (e.g., \"Invalid email address. Please try again.\").\n3. **A3: Email Already Subscribed:** In step 6, the email is found in the database with an `active` status. The backend returns a specific response (e.g., `409 Conflict`). The frontend displays a message (e.g., \"This email is already on our list.\"). The subscriber's `subscribed_at` timestamp is not updated.\n4. **A4: Backend Unavailable:** In step 5, the network request fails (timeout, 5xx error). The frontend displays a generic failure message (e.g., \"Subscription failed. Please check your connection and try again.\") and re-enables the submit button.\n\n*   A new subscriber record exists in the database with the provided email, timestamp, source, and active status, OR an existing active record is left unchanged.\n*   The user interface reflects the outcome (success message, error message, or field reset).\n*   The system has logged the subscription attempt (success or failure) for audit purposes.\n\n*   **New Data Created:** A `subscribers` table record with fields: `id` (PK), `email` (unique, indexed), `subscribed_at` (datetime), `source` (varchar), `consent_given` (boolean), `status` (varchar, e.g., 'active').\n*   **Data Updated:** No existing data is updated for a new subscription. For an already-subscribed email, no update occurs.\n*   **GDPR/Privacy:** The `consent_given` flag and `subscribed_at` timestamp must be stored to prove opt-in. The privacy policy link must be present.\n\n*   A form component is added to the landing page layout, typically in the footer or a pre-footer section.\n*   The component consists of: a label (\"Subscribe to our newsletter\"), a single-line text input (`type=\"email\"`), a primary action button (\"Subscribe\"), and a small text link to the Privacy Policy.\n*   The UI must provide clear, accessible validation feedback (ARIA live regions for errors/success).\n*   On success, the input and button are replaced by or accompanied by a persistent success message.\n*   The component is responsive and styled consistently with the studio's brand.\n\n1. **AC1:** Entering a syntactically invalid email (e.g., \"test@\") and clicking Subscribe displays an immediate, clear client-side error message and does not send a network request.\n2. **AC2:** Entering a valid, *new* email address and clicking Subscribe results in a `200`/`201` API response, the UI shows a success confirmation, and a new record with `status='active'` and `consent_given=true` is created in the database.\n3. **AC3:** Entering a valid, *already subscribed* email address and clicking Subscribe results in a `409` API response (or similar), the UI shows an appropriate \"already subscribed\" message, and no new database record is created.\n4. **AC4:** If the API is unreachable or returns a 5xx error, the UI shows a generic failure message and the user can retry.\n5. **AC5:** The subscription form is accessible via keyboard navigation and screen readers. The privacy policy link is clearly visible and navigable.\n6. **AC6:** The input field clears or is disabled after a successful subscription, preventing duplicate immediate submissions. ## Non-Functional Requirements\n10. Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen. ## Error Handling & Recovery\n11. Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n12. Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n13. Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n14. Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert. ## Deployment & Infrastructure\n15. Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n16. Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n17. Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n18. Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert. ## Definition of Done\n19. Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n20. Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n21. Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n22. Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n\n## Non-Functional Requirements\n\n## Error Handling & Recovery\n\n- Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n- Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n- Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n- Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert.\n\n## Deployment & Infrastructure\n\n- Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n- Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n- Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n- Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert.\n\n## Definition of Done\n\n- Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n- Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n- Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n- Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n",
      "tokensUsed": 37961,
      "answererOutputTruncated": true,
      "answererOutputTruncationReason": "Detected incomplete tail; likely token limit or interrupted generation."
    }
  ],
  "totalTokens": 46760,
  "modelsUsed": [
    "openai/gpt-oss-120b:free",
    "meta-llama/llama-3.3-70b-instruct:free"
  ],
  "diagnostics": {
    "structuredFeatureCount": 24,
    "totalFeatureCount": 24,
    "jsonSectionUpdates": 1,
    "markdownSectionRegens": 0,
    "fullRegenerations": 1,
    "featurePreservations": 0,
    "featureIntegrityRestores": 0,
    "featureQualityRegressions": 0,
    "autoRecoveredFeatures": 0,
    "avgFeatureCompleteness": 10,
    "driftEvents": 0,
    "featureFreezeActive": true,
    "blockedRegenerationAttempts": 0,
    "freezeSeedSource": "compiledExpansion"
  },
  "mergedPRD": "## System Vision\n\nDie Landingpage präsentiert das lokale Yogastudio professionell im Web, informiert Besucher über das Leistungsangebot, den Kursplan und ermöglicht eine direkte Kontaktaufnahme. Ziel ist es, die Besucherzahl, Kursbuchungen und die Markenbekanntheit des Studios innerhalb von 3 Monaten um mindestens 30 % zu steigern.\n\n## System Boundaries\n\n- **Deployment**: Statischer Web‑Site‑Generator (z. B. Hugo, Next.js) oder klassisches HTML/CSS/JS, gehostet auf einem CDN (z. B. Netlify, Vercel).  \n- **Runtime**: Client‑seitig im Browser; keine serverseitige Logik außer optionaler Formular‑Submission‑Endpoint.  \n- **Online/Offline**: Vollständig online; Offline‑Caching über Service‑Worker optional.  \n- **Single‑User / Multi‑User**: Single‑User‑Frontend; Administrator‑Zugang für Content‑Updates (CMS‑Integration optional).  \n- **Persistenz**: Keine persistente Datenbank; Kontaktformular sendet Daten per E‑Mail oder an ein externes Form‑Handling‑Service (z. B. Formspree).  \n- **Integrationen**: \n  - Google Maps für Standortanzeige  \n  - Social‑Media‑Links (Instagram, Facebook)  \n  - Kalender‑Export (iCal) für Kursplan (optional)  \n  - E‑Mail‑Service für Formular‑Versand\n\n## Domain Model\n\n- Kern-Entitaeten: Nutzer/Besucher, Feature, Anforderung und Iteration.\n- Beziehungen: Eine Anforderung aggregiert Features; jede Iteration verfeinert bestehende Features und kann neue ueber ein strukturiertes Delta hinzufuegen.\n- Datenkonsistenz: Feature-IDs bleiben ueber Iterationen stabil und gelten als unveraenderliche Kennungen.\n- Quellkontext (Iteration 1): Erstelle eine kompakte Landingpage fuer ein lokales Yogastudio mit Hero, Leistungen, Kursplan und Kontaktformular.\n\n## Global Business Rules\n\n- Bestehende Features duerfen waehrend der iterativen Verfeinerung nicht entfernt werden.\n- Neue Features werden nur ueber validiertes Feature-Delta-JSON akzeptiert.\n- Doppelte Features (gleiche Intention/Bezeichnung) werden deterministisch verworfen.\n- Akzeptanzkriterien aller Features muessen testbar und beobachtbar bleiben.\n\n## Functional Feature Catalogue\n\n- Zuverlaessigkeit: Ein iterativer Lauf muss ohne Verlust bereits akzeptierter Features abschliessen.\n- Determinismus: Freeze-Baseline und Feature-IDs bleiben ueber Iterationen stabil.\n- Performance: In Freeze-Mode wird Section-Patching gegenueber Vollregeneration bevorzugt.\n- Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen.\n\n### F-01: Responsive Layout\n\n**1. Purpose**\n\nResponsive Layout liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n**2. Actors**\n\nPrimär: Endnutzer. Sekundär: Systemkomponenten zur Verarbeitung.\n\n**3. Trigger**\n\nWird ausgelöst, wenn der Nutzer die zugehörige Aktion in der Oberfläche startet.\n\n**4. Preconditions**\n\nAnwendung ist verfügbar, notwendige Datenquellen sind erreichbar, Nutzerkontext ist geladen.\n\n**5. Main Flow**\n\n1. 1. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n2. 2. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n3. 3. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n4. 4. System verarbeitet den Schritt deterministisch und aktualisiert den Zustand konsistent.\n\n**6. Alternate Flows**\n\n1. Fehlerfall: Bei ungültiger Eingabe zeigt das System eine klare Validierungsmeldung und behält den Eingabekontext.\n\n**7. Postconditions**\n\nNach Abschluss ist der Feature-Zustand konsistent gespeichert und für Folgeprozesse verfügbar.\n\n**8. Data Impact**\n\nRelevante Entitäten werden gelesen/geschrieben; Änderungen sind nachvollziehbar und konsistent.\n\n**9. UI Impact**\n\nUI stellt den Status transparent dar und bietet klare Rückmeldungen für Erfolg und Fehler.\n\n**10. Acceptance Criteria**\n\n1. 1. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n2. 2. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n3. 3. Funktion ist für Endnutzer reproduzierbar testbar und liefert deterministisches Ergebnis.\n\n### F-02: Sticky Navigation Menu\n\nSticky Navigation Menu liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-03: Hamburger Menu for Mobile\n\nHamburger Menu for Mobile liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-04: Hero Section with Background Image\n\nHero Section with Background Image liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-05: Hero Call‑to‑Action Button\n\nHero Call‑to‑Action Button liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-06: Services Overview Section\n\nServices Overview Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-07: Individual Service Card Component\n\nIndividual Service Card Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-08: Course Schedule Section\n\nCourse Schedule Section liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-09: Course Detail Modal\n\nCourse Detail Modal liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-10: Contact Form Component\n\nContact Form Component liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-11: Form Validation Logic\n\nForm Validation Logic liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-12: Form Submission Handling (Email Notification)\n\nForm Submission Handling (Email Notification) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-13: CAPTCHA Integration for Contact Form\n\nCAPTCHA Integration for Contact Form liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-14: Footer with Address, Hours, and Copyright\n\nFooter with Address, Hours, and Copyright liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-15: Social Media Icon Links\n\nSocial Media Icon Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-16: Google Maps Embed\n\nGoogle Maps Embed liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-17: SEO Meta Tags (Title & Description)\n\nSEO Meta Tags (Title & Description) liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-18: Open Graph Tags for Social Sharing\n\nOpen Graph Tags for Social Sharing liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-19: Google Analytics Tracking Script\n\nGoogle Analytics Tracking Script liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-20: Smooth Scroll to Anchor Links\n\nSmooth Scroll to Anchor Links liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-21: Image Lazy Loading\n\nImage Lazy Loading liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-22: ARIA Labels for Accessibility\n\nARIA Labels for Accessibility liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-23: HTTPS Redirection\n\nHTTPS Redirection liefert den zentralen Nutzerwert in einem klar abgrenzbaren Feature.\n\n### F-24: Newsletter Signup Field\n\nTo collect email addresses from website visitors who voluntarily opt-in to receive the yoga studio's newsletter and promotional communications, building a marketing contact list.\n\n*   **Primary Actor:** Website Visitor (potential customer).\n*   **Secondary Actor:** Studio Staff/Marketing Team (indirectly, as recipients of the collected data).\n\nThe visitor scrolls to or navigates to the section of the landing page containing the newsletter signup form and decides to subscribe.\n\n*   The landing page is fully loaded and rendered in the user's browser.\n*   The newsletter signup field component is visible and interactive on the page (e.g., in the footer or a dedicated section).\n*   The backend API endpoint for handling newsletter subscriptions is available and responsive.\n\n1. The visitor views the landing page and locates the newsletter signup field, which includes a text input for an email address, a \"Subscribe\" button, and a link to the privacy policy.\n2. The visitor enters a valid email address into the input field.\n3. The visitor clicks the \"Subscribe\" button.\n4. The frontend performs immediate client-side validation to ensure the input is a syntactically valid email address (e.g., contains '@' and a domain).\n5. Upon passing client-side validation, the frontend sends an asynchronous HTTP POST request to the backend subscription endpoint (`/api/subscribe`) containing the email address and an implicit or explicit consent flag.\n6. The backend receives the request, validates the email format server-side, and checks against the existing subscriber database to prevent duplicates (based on normalized email address).\n7. If the email is valid and new, the backend creates a new subscriber record with the email, a timestamp (`subscribed_at`), a `source` field set to \"landingpage\", and a `consent_given` flag set to `true` (based on the act of submission). The record status is set to `active`.\n8. The backend returns a successful HTTP response (e.g., `200 OK` or `201 Created`).\n9. The frontend receives the successful response and updates the UI to display a success confirmation message (e.g., \"Thank you for subscribing!\") and disables or resets the input field and button.\n\n1. **A1: Invalid Email Format (Client-Side):** In step 4, the client-side validation fails. The UI displays an inline error message (e.g., \"Please enter a valid email address\") next to the input field. The form is not submitted.\n2. **A2: Invalid Email Format (Server-Side):** In step 6, server-side validation fails (e.g., malformed email passed client-side). The backend returns an error response (e.g., `400 Bad Request`). The frontend displays a generic error message (e.g., \"Invalid email address. Please try again.\").\n3. **A3: Email Already Subscribed:** In step 6, the email is found in the database with an `active` status. The backend returns a specific response (e.g., `409 Conflict`). The frontend displays a message (e.g., \"This email is already on our list.\"). The subscriber's `subscribed_at` timestamp is not updated.\n4. **A4: Backend Unavailable:** In step 5, the network request fails (timeout, 5xx error). The frontend displays a generic failure message (e.g., \"Subscription failed. Please check your connection and try again.\") and re-enables the submit button.\n\n*   A new subscriber record exists in the database with the provided email, timestamp, source, and active status, OR an existing active record is left unchanged.\n*   The user interface reflects the outcome (success message, error message, or field reset).\n*   The system has logged the subscription attempt (success or failure) for audit purposes.\n\n*   **New Data Created:** A `subscribers` table record with fields: `id` (PK), `email` (unique, indexed), `subscribed_at` (datetime), `source` (varchar), `consent_given` (boolean), `status` (varchar, e.g., 'active').\n*   **Data Updated:** No existing data is updated for a new subscription. For an already-subscribed email, no update occurs.\n*   **GDPR/Privacy:** The `consent_given` flag and `subscribed_at` timestamp must be stored to prove opt-in. The privacy policy link must be present.\n\n*   A form component is added to the landing page layout, typically in the footer or a pre-footer section.\n*   The component consists of: a label (\"Subscribe to our newsletter\"), a single-line text input (`type=\"email\"`), a primary action button (\"Subscribe\"), and a small text link to the Privacy Policy.\n*   The UI must provide clear, accessible validation feedback (ARIA live regions for errors/success).\n*   On success, the input and button are replaced by or accompanied by a persistent success message.\n*   The component is responsive and styled consistently with the studio's brand.\n\n1. **AC1:** Entering a syntactically invalid email (e.g., \"test@\") and clicking Subscribe displays an immediate, clear client-side error message and does not send a network request.\n2. **AC2:** Entering a valid, *new* email address and clicking Subscribe results in a `200`/`201` API response, the UI shows a success confirmation, and a new record with `status='active'` and `consent_given=true` is created in the database.\n3. **AC3:** Entering a valid, *already subscribed* email address and clicking Subscribe results in a `409` API response (or similar), the UI shows an appropriate \"already subscribed\" message, and no new database record is created.\n4. **AC4:** If the API is unreachable or returns a 5xx error, the UI shows a generic failure message and the user can retry.\n5. **AC5:** The subscription form is accessible via keyboard navigation and screen readers. The privacy policy link is clearly visible and navigable.\n6. **AC6:** The input field clears or is disabled after a successful subscription, preventing duplicate immediate submissions. ## Non-Functional Requirements\n10. Beobachtbarkeit: Diagnostics muessen Feature-Anzahl, blockierte Versuche und Integritaetsereignisse ausweisen. ## Error Handling & Recovery\n11. Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n12. Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n13. Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n14. Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert. ## Deployment & Infrastructure\n15. Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n16. Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n17. Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n18. Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert. ## Definition of Done\n19. Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n20. Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n21. Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n22. Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n\n## Non-Functional Requirements\n\n## Error Handling & Recovery\n\n- Ungueltiges oder fehlendes strukturiertes Delta erzwingt einen strikten Fallback auf den vorherigen stabilen PRD-Zustand.\n- Fehler bei Section-Regeneration im Freeze-Mode fallen sicher zurueck, ohne Feature-Verlust.\n- Parse-Fehler gelten nur dann als non-blocking, wenn Integritaet weiterhin garantiert ist.\n- Alle Fallback-Pfade werden mit explizitem Grund und Iterationsnummer protokolliert.\n\n## Deployment & Infrastructure\n\n- Runtime: Node.js-Service mit Endpunkten fuer den iterativen Compiler.\n- Umgebung: Dockerisierte Local/Dev-Ausfuehrung mit reproduzierbarem Build und Health-Endpoint.\n- Abhaengigkeiten: LLM-Provider-Integration mit Model-Fallback-Strategie.\n- Auslieferung: Aenderungen werden mit TypeScript-Check und End-to-End-API-Smoke-Run validiert.\n\n## Definition of Done\n\n- Erforderliche PRD-Sektionen sind vorhanden und nicht leer.\n- Die Feature-Anzahl faellt nicht unter die gefrorene Baseline.\n- Es bleiben keine doppelten Feature-IDs oder doppelten Feature-Namen bestehen.\n- Der iterative Lauf schliesst mit gueltigem finalen PRD und Diagnostics ab.\n"
}
